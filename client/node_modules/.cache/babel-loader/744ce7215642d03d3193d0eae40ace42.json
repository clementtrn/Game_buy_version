{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import CaseDonnee from'./panels/CaseDonnee';import\"../../styles/TactBandeauTop.css\";import BookmarkRoundedIcon from'@material-ui/icons/BookmarkRounded';import Typography from'@material-ui/core/Typography';import Grid from'@material-ui/core/Grid';import PlayAPI from\"../../API/PlayAPI\";import ContentsAPI from\"../../API/ContentsAPI\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TactBandeauTop=function TactBandeauTop(_ref){var numeroPompier=_ref.numeroPompier,sequence=_ref.sequence,numEquipe=_ref.numEquipe,numSession=_ref.numSession,cycle=_ref.cycle,tour=_ref.tour,pomp=_ref.pomp,stocks=_ref.stocks,resultats=_ref.resultats,configuration=_ref.configuration,budget=_ref.budget,equipe=_ref.equipe,handleClicValidated=_ref.handleClicValidated,play=_ref.play,chronoInit=_ref.chronoInit,budgetDepense=_ref.budgetDepense;// console.log(chronoInit,)\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),textes=_useState2[0],setTextes=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),chrono=_useState4[0],setChrono=_useState4[1];useEffect(function(){if(pomp==numeroPompier&&chrono!==null&&play){if(chrono>0){var chronoTimer=setInterval(function(){if(chrono%30==0&&chrono>10)PlayAPI.updateCurrentChrono(chrono,numSession,numEquipe);setChrono(function(chrono){return chrono-1;});},1000);}else{// clearInterval(chronoTimer)\n// console.log(\"handle\")\nhandleClicValidated(true);setChrono(null);}}else{if(configuration!==null){if(chronoInit==null){setChrono(configuration.chronoTour.valeur);}else{setChrono(chronoInit);}}}return function(){clearInterval(chronoTimer);};},[chrono]);useEffect(function(){if(chronoInit!==null&&chrono>=chronoInit&&configuration!==null){setChrono(chronoInit);}});// useEffect(() => {\n//     // console.log(configuration.chronoTour.valeur)\n//     if (chrono === null && configuration !== null) {\n//         // setChrono(chronoInit)\n//     }\n// })\nuseEffect(function(){// console.log(\"use effect\")\nvar getTextes=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var textes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:textes=ContentsAPI.getTexts(\"jeuTactBandeauTop\").then(function(res){setTextes(res);});case 1:case\"end\":return _context.stop();}}},_callee);}));return function getTextes(){return _ref2.apply(this,arguments);};}();if(textes==null){getTextes();}},[textes]);var getText=function getText(name){if(textes==null){return name;}else{try{return textes[\"label\"+name.charAt(0).toUpperCase()+name.slice(1)].contenu;}catch(error){console.log(\"label\"+name.charAt(0).toUpperCase()+name.slice(1));return name;}}};var renderStocks=function renderStocks(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel donnees-container\",style:{flex:3},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"stockEquipements\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"sous-donnees-container\",children:[/*#__PURE__*/_jsx(CaseDonnee,{name:\"nbExtFeu\",value:stocks.Feu,primary:false,flexFactor:1,textes:textes},0),/*#__PURE__*/_jsx(CaseDonnee,{name:\"nbExtFum\",value:stocks.Fum,primary:false,flexFactor:1,textes:textes},1)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sous-donnees-container\",children:[/*#__PURE__*/_jsx(CaseDonnee,{name:\"nbExtFeuFum\",value:stocks.FeuFum,primary:false,flexFactor:2,textes:textes},2),/*#__PURE__*/_jsx(CaseDonnee,{name:\"nbMarqueurs\",value:stocks.Marqueur,primary:false,flexFactor:2,textes:textes},3)]})]});};var renderResults=function renderResults(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel donnees-container\",style:{flex:2},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"resultats\")+\" \"+equipe}),/*#__PURE__*/_jsx(CaseDonnee,{name:getText(\"nbDecedes\"),value:resultats.Decedes,primary:false,flexFactor:0},4),/*#__PURE__*/_jsx(CaseDonnee,{name:getText(\"nbSauves\"),value:resultats.Sauves,primary:false,flexFactor:0},5)]});};var renderNumPompier=function renderNumPompier(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"numPompier\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"donnees-container\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title label-num-pompier\",children:numeroPompier}),/*#__PURE__*/_jsx(BookmarkRoundedIcon,{className:\"icone-num-pompier\",fontSize:\"large\",stroke:\"white\",strokeWidth:1})]})]});};var renderCircleTours=function renderCircleTours(){var type=1,//circle type - 1 whole, 0.5 half, 0.25 quarter\nradius=20,//distance from center\nstart=-90,//shift start from 0\n// $elements = $('li:not(:first-child)'),\nnumberOfElements=configuration.nbPompEquipe.valeur,slice=360*type/numberOfElements;var renderCircleItems=function renderCircleItems(){var items=[];var decalage=1.2;// items.push(\n//     <li\n//         key={\"c\"}\n//         style={{\n//             'transform': 'translate(' + (-radius*decalage*2) + 'px,'+ (-radius*decalage) +'px)',\n//             \"backgroundColor\": tour==-1 ? \"#BF0000\" : null\n//         }}\n//     >\n//         {\"C\"}\n//     </li>\n// )\nitems.push(/*#__PURE__*/_jsx(\"li\",{style:{'transform':'translate('+radius*decalage+'px,'+-radius*decalage+'px)',\"backgroundColor\":pomp==0?\"#BF0000\":null},children:\"S\"},\"s\"));for(var i=0;i<numberOfElements;i++){var rotate=slice*i+start;var rotateReverse=rotate*-1;var decalageCircle=10;items.push(/*#__PURE__*/_jsx(\"li\",{style:{'transform':'rotate('+rotate+'deg) translate('+radius+'px) rotate('+rotateReverse+'deg) translate('+-radius/2+'px) translateY('+decalageCircle+'px)',\"backgroundColor\":i+1==pomp?\"#BF0000\":null},children:i+1},i));}return items;};return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"tourParTour\")}),/*#__PURE__*/_jsx(\"ul\",{children:renderCircleItems()})]});};var renderFeu=function renderFeu(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"play\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"donnees-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"feu\",children:[/*#__PURE__*/_jsx(\"div\",{className:chrono<30?\"clignotant animation-reverted\":\"\",style:{backgroundColor:numeroPompier!=pomp||chrono<30?chrono<30?\"#E26F00\":\"#ff0000\":\"#9F9F9F\"}}),/*#__PURE__*/_jsx(\"div\",{className:chrono<30?\"clignotant\":\"\",style:{backgroundColor:numeroPompier==pomp?chrono<30?\"#E26F00\":\"#4dff4d\":\"#9F9F9F\"}})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"case-value\",style:{marginTop:\"10%\",width:\"100%\",maxWidth:\"100%\"},children:[Math.floor(chrono/60).toString().padStart(2,\"0\")+\" : \",/*#__PURE__*/_jsxs(\"span\",{style:{color:chrono<=30?\"red\":\"inherit\",marginLeft:5},children:[\" \",\" \"+(chrono%60).toString().padStart(2,\"0\"),\" \"]})]})]})]});};return configuration!=null?/*#__PURE__*/_jsx(\"div\",{className:\"bandeau-top\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cases-container\",children:[/*#__PURE__*/_jsx(CaseDonnee,{name:\"sequence\",value:sequence,primary:true,flexFactor:1,textes:textes,data:configuration.nbSequences.valeur}),/*#__PURE__*/_jsx(CaseDonnee,{name:\"cycle\",value:cycle,primary:true,flexFactor:1,textes:textes,data:configuration.nbCyclesParSequence.valeur}),/*#__PURE__*/_jsx(CaseDonnee,{name:\"tour\",value:tour,primary:true,flexFactor:1,textes:textes,data:configuration.nbToursParCycle.valeur}),/*#__PURE__*/_jsx(CaseDonnee,{name:\"budgetRestant\",value:budget+\" €\",primary:true,flexFactor:1,textes:textes,data:budgetDepense>=configuration.budgetTourMax.valeur}),renderStocks(),renderResults(),renderCircleTours(),renderNumPompier(),renderFeu()]})}):null;};export default TactBandeauTop;","map":{"version":3,"sources":["C:/Users/hugod/decitude/client/src/components/interfaceJoueur/TactBandeauTop.js"],"names":["React","useState","useEffect","CaseDonnee","BookmarkRoundedIcon","Typography","Grid","PlayAPI","ContentsAPI","TactBandeauTop","numeroPompier","sequence","numEquipe","numSession","cycle","tour","pomp","stocks","resultats","configuration","budget","equipe","handleClicValidated","play","chronoInit","budgetDepense","textes","setTextes","chrono","setChrono","chronoTimer","setInterval","updateCurrentChrono","chronoTour","valeur","clearInterval","getTextes","getTexts","then","res","getText","name","charAt","toUpperCase","slice","contenu","error","console","log","renderStocks","flex","Feu","Fum","FeuFum","Marqueur","renderResults","Decedes","Sauves","renderNumPompier","renderCircleTours","type","radius","start","numberOfElements","nbPompEquipe","renderCircleItems","items","decalage","push","i","rotate","rotateReverse","decalageCircle","renderFeu","backgroundColor","marginTop","width","maxWidth","Math","floor","toString","padStart","color","marginLeft","nbSequences","nbCyclesParSequence","nbToursParCycle","budgetTourMax"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport CaseDonnee from './panels/CaseDonnee'\r\nimport \"../../styles/TactBandeauTop.css\"\r\nimport BookmarkRoundedIcon from '@material-ui/icons/BookmarkRounded';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport PlayAPI from \"../../API/PlayAPI\"\r\nimport ContentsAPI from \"../../API/ContentsAPI\"\r\n\r\nconst TactBandeauTop = ({\r\n    numeroPompier,\r\n    sequence,\r\n    numEquipe,\r\n    numSession,\r\n    cycle,\r\n    tour,\r\n    pomp,\r\n    stocks,\r\n    resultats,\r\n    configuration,\r\n    budget,\r\n    equipe,\r\n    handleClicValidated,\r\n    play,\r\n    chronoInit,\r\n    budgetDepense\r\n\r\n}) => {\r\n    \r\n    // console.log(chronoInit,)\r\n    const [textes, setTextes] = useState(null)\r\n    const [chrono, setChrono] = useState(null)\r\n    useEffect(() => {\r\n        \r\n        if (pomp == numeroPompier && chrono !== null && play) {\r\n            if (chrono > 0) {\r\n                var chronoTimer = setInterval(() => {\r\n                    if (chrono % 30 == 0 && chrono>10) PlayAPI.updateCurrentChrono(chrono, numSession, numEquipe)\r\n                    setChrono(chrono => chrono - 1)\r\n                    \r\n\r\n                }, 1000)\r\n\r\n            } else {\r\n                // clearInterval(chronoTimer)\r\n                // console.log(\"handle\")\r\n                handleClicValidated(true)\r\n                setChrono(null)\r\n            }\r\n           \r\n        } else {\r\n            if (configuration !== null ) {\r\n                if(chronoInit==null){\r\n                    setChrono(configuration.chronoTour.valeur)\r\n                }else{\r\n                    setChrono(chronoInit)\r\n                }\r\n                 \r\n            }\r\n        }\r\n\r\n        return () => {\r\n            clearInterval(chronoTimer)\r\n        }\r\n    }, [chrono])\r\n\r\n    useEffect(()=>{\r\n        if(chronoInit!==null && chrono>=chronoInit && configuration!==null){\r\n          setChrono(chronoInit)\r\n        }\r\n      })\r\n\r\n\r\n\r\n    // useEffect(() => {\r\n    //     // console.log(configuration.chronoTour.valeur)\r\n    //     if (chrono === null && configuration !== null) {\r\n    //         // setChrono(chronoInit)\r\n    //     }\r\n    // })\r\n\r\n\r\n    useEffect(() => {\r\n        // console.log(\"use effect\")\r\n        const getTextes = async () => {\r\n            const textes = ContentsAPI.getTexts(\"jeuTactBandeauTop\").then(\r\n                (res) => { setTextes(res) }\r\n            )\r\n        }\r\n        if (textes == null) {\r\n            getTextes()\r\n        }\r\n    }, [textes])\r\n\r\n\r\n\r\n    const getText = (name) => {\r\n        if (textes == null) {\r\n            return name\r\n        } else {\r\n            try {\r\n                return textes[\"label\" + name.charAt(0).toUpperCase() + name.slice(1)].contenu\r\n            } catch (error) {\r\n                console.log(\"label\" + name.charAt(0).toUpperCase() + name.slice(1))\r\n                return name\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    const renderStocks = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel donnees-container\"\r\n                style={{\r\n                    flex: 3\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"stockEquipements\")}\r\n                </label>\r\n                <div className=\"sous-donnees-container\">\r\n                    <CaseDonnee\r\n                        key={0}\r\n                        name={\"nbExtFeu\"}\r\n                        value={stocks.Feu}\r\n                        primary={false}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n\r\n                    />\r\n                    <CaseDonnee\r\n                        key={1}\r\n                        name={\"nbExtFum\"}\r\n                        value={stocks.Fum}\r\n                        primary={false}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n\r\n                    />\r\n                </div>\r\n                <div className=\"sous-donnees-container\">\r\n                    <CaseDonnee\r\n                        key={2}\r\n                        name={\"nbExtFeuFum\"}\r\n                        value={stocks.FeuFum}\r\n                        primary={false}\r\n                        flexFactor={2}\r\n                        textes={textes}\r\n\r\n                    />\r\n                    <CaseDonnee\r\n                        key={3}\r\n                        name={\"nbMarqueurs\"}\r\n                        value={stocks.Marqueur}\r\n                        primary={false}\r\n                        flexFactor={2}\r\n                        textes={textes}\r\n\r\n                    />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderResults = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel donnees-container\"\r\n                style={{\r\n                    flex: 2\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"resultats\") + \" \" + equipe}\r\n                </label>\r\n                <CaseDonnee\r\n                    key={4}\r\n                    name={getText(\"nbDecedes\")}\r\n                    value={resultats.Decedes}\r\n                    primary={false}\r\n                    flexFactor={0}\r\n                />\r\n                <CaseDonnee\r\n                    key={5}\r\n                    name={getText(\"nbSauves\")}\r\n                    value={resultats.Sauves}\r\n                    primary={false}\r\n                    flexFactor={0}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderNumPompier = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel\"\r\n                style={{\r\n                    flex: 1\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"numPompier\")}\r\n                </label>\r\n                <div className=\"donnees-container\">\r\n                    <label\r\n                        className=\"label-title label-num-pompier\"\r\n                    >\r\n                        {numeroPompier}\r\n                    </label>\r\n                    <BookmarkRoundedIcon\r\n                        className=\"icone-num-pompier\"\r\n                        fontSize=\"large\"\r\n                        stroke={\"white\"}\r\n                        strokeWidth={1}\r\n                    />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderCircleTours = () => {\r\n        var type = 1, //circle type - 1 whole, 0.5 half, 0.25 quarter\r\n            radius = 20, //distance from center\r\n            start = -90, //shift start from 0\r\n            // $elements = $('li:not(:first-child)'),\r\n            numberOfElements = configuration.nbPompEquipe.valeur,\r\n            slice = 360 * type / numberOfElements;\r\n\r\n        const renderCircleItems = () => {\r\n            var items = []\r\n            const decalage = 1.2\r\n            // items.push(\r\n            //     <li\r\n            //         key={\"c\"}\r\n            //         style={{\r\n            //             'transform': 'translate(' + (-radius*decalage*2) + 'px,'+ (-radius*decalage) +'px)',\r\n            //             \"backgroundColor\": tour==-1 ? \"#BF0000\" : null\r\n            //         }}\r\n\r\n            //     >\r\n            //         {\"C\"}\r\n            //     </li>\r\n            // )\r\n            items.push(\r\n                <li\r\n                    key={\"s\"}\r\n                    style={{\r\n                        'transform': 'translate(' + (radius * decalage) + 'px,' + (-radius * decalage) + 'px)',\r\n                        \"backgroundColor\": pomp == 0 ? \"#BF0000\" : null\r\n                    }}\r\n\r\n                >\r\n                    {\"S\"}\r\n                </li>\r\n            )\r\n\r\n            for (let i = 0; i < numberOfElements; i++) {\r\n                const rotate = slice * i + start\r\n                const rotateReverse = rotate * -1\r\n                const decalageCircle = 10\r\n\r\n                items.push(\r\n                    <li\r\n                        key={i}\r\n                        style={{\r\n                            'transform': 'rotate(' + rotate + 'deg) translate(' + radius + 'px) rotate(' + rotateReverse + 'deg) translate(' + -radius / 2 + 'px) translateY(' + decalageCircle + 'px)',\r\n                            \"backgroundColor\": i + 1 == pomp ? \"#BF0000\" : null\r\n                        }}\r\n\r\n                    >\r\n                        {i + 1}\r\n                    </li>\r\n\r\n                )\r\n            }\r\n            return items\r\n        }\r\n\r\n        return (\r\n            <div\r\n                className=\"case-panel\"\r\n                style={{\r\n                    flex: 1\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"tourParTour\")}\r\n                </label>\r\n                <ul >\r\n                    {renderCircleItems()}\r\n                </ul>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderFeu = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel\"\r\n                style={{\r\n                    flex: 1\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"play\")}\r\n                </label>\r\n\r\n                <div className=\"donnees-container\">\r\n                    <div className='feu'>\r\n                        <div\r\n                            className={chrono < 30 ? \"clignotant animation-reverted\" : \"\"}\r\n                            style={{ backgroundColor: numeroPompier != pomp || chrono < 30 ? chrono < 30 ? \"#E26F00\" : \"#ff0000\" : \"#9F9F9F\" }}></div>\r\n                        <div\r\n                            className={chrono < 30 ? \"clignotant\" : \"\"}\r\n                            style={{ backgroundColor: numeroPompier == pomp ? chrono < 30 ? \"#E26F00\" : \"#4dff4d\" : \"#9F9F9F\" }}\r\n                        ></div>\r\n                    </div>\r\n                    <span className=\"case-value\" style={{\r\n                        marginTop: \"10%\",\r\n                        width: \"100%\",\r\n                        maxWidth: \"100%\"\r\n                    }} >\r\n                        {(Math.floor(chrono / 60)).toString().padStart(2, \"0\") + \" : \"}\r\n                        <span style={{ color: chrono <= 30 ? \"red\" : \"inherit\", marginLeft: 5 }}> {\" \" + (chrono % 60).toString().padStart(2, \"0\")} </span>\r\n                    </span>\r\n                </div>\r\n\r\n\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n    return (\r\n        configuration != null ?\r\n            <div className=\"bandeau-top\">\r\n                <div className=\"cases-container\">\r\n                    <CaseDonnee\r\n                        name={\"sequence\"}\r\n                        value={sequence}\r\n                        primary={true}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n                        data={configuration.nbSequences.valeur}\r\n                    />\r\n                    <CaseDonnee\r\n                        name={\"cycle\"}\r\n                        value={cycle}\r\n                        primary={true}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n                        data={configuration.nbCyclesParSequence.valeur}\r\n                    />\r\n                    <CaseDonnee\r\n                        name={\"tour\"}\r\n                        value={tour}\r\n                        primary={true}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n                        data={configuration.nbToursParCycle.valeur}\r\n                    />\r\n                    <CaseDonnee\r\n                        name={\"budgetRestant\"}\r\n                        value={budget + \" €\"}\r\n                        primary={true}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n                        data={budgetDepense >= configuration.budgetTourMax.valeur}\r\n\r\n                    />\r\n                    {renderStocks()}\r\n                    {renderResults()}\r\n                    {renderCircleTours()}\r\n                    {renderNumPompier()}\r\n                    {renderFeu()}\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n\r\n            :\r\n            null\r\n\r\n\r\n    );\r\n}\r\n\r\nexport default TactBandeauTop;"]},"metadata":{},"sourceType":"module"}