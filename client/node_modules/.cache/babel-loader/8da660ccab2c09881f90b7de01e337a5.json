{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hugod\\\\d\\xE9citude\\\\client\\\\src\\\\routes\\\\InterfaceTact.js\",\n    _s = $RefreshSig$();\n\nimport \"../styles/App.css\";\nimport React, { useState, useEffect } from 'react';\nimport PlayAPI from \"../API/PlayAPI\";\nimport BandeauTop from \"../components/interfaceJoueur/BandeauTop\";\nimport BandeauBottom from \"../components/interfaceJoueur/BandeauBottom\";\nimport Grille from \"../components/interfaceJoueur/Grille\";\nimport { useHistory } from 'react-router-dom';\nimport cookie from 'react-cookies';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst InterfaceTact = () => {\n  _s();\n\n  const history = useHistory();\n  const user = cookie.load(\"user\"); // console.log(user)\n\n  if (user == null || user == undefined) history.push(\"/login\");\n  const [numPompier, setNumPompier] = useState(user.role.replace(\"TACT\", \"\"));\n  const [currentTour, setCurrentTour] = useState(null);\n  const [currentCycle, setCurrentCycle] = useState(null);\n  const [session, setSession] = useState(user.session);\n  const [equipe, setEquipe] = useState(user.equipe);\n\n  const getPlayState = async (session, equipe) => {\n    const currentPlayState = await PlayAPI.getPlayState(session, equipe);\n\n    if (Object.keys(currentPlayState).length > 0) {\n      console.log(\"Get play state 2\");\n      setCurrentTour(parseInt(currentPlayState.currentTour.valeur));\n      setCurrentCycle(parseInt(currentPlayState.currentCycle.valeur));\n      setMursH(JSON.parse(currentPlayState.mursH.valeur));\n      setMursV(JSON.parse(currentPlayState.mursV.valeur)); // setCarte(JSON.parse(currentPlayState.carte.valeur))\n\n      setResultats({\n        Decedes: parseInt(currentPlayState.resultatsDecedes.valeur),\n        Sauves: parseInt(currentPlayState.resultatsSauves.valeur)\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (session != null && equipe != null && currentTour == null) {\n      getPlayState(session, equipe);\n    }\n  }, [session, equipe, currentTour]);\n  const [configuration, setConfiguration] = useState(null);\n  const [stocks, setStocks] = useState({\n    Interventions: 10,\n    Feu: 1,\n    FeuFum: 10,\n    Fum: 10,\n    Marqueur: 10\n  });\n  const [resultats, setResultats] = useState({\n    Decedes: 0,\n    Sauves: 0\n  });\n  const [interventions, setInterventions] = useState({\n    Deplacement: 0,\n    Feu: 0,\n    FeuFum: 0,\n    Fum: 0,\n    Marqueur: 0,\n    Porte: 0,\n    Habitant: 0\n  });\n  const [budget, setBudget] = useState(800);\n\n  const getPlayParameters = async () => {\n    const param = await PlayAPI.getConfiguration(session);\n    setConfiguration(param);\n  };\n\n  const getPositionFromCarte = () => {\n    carte.forEach(ligne => {\n      ligne.forEach(valeur => {\n        if (Math.floor(valeur / 100) == 1 && type % 100 / 10 == numPompier) console.log(valeur);\n      });\n    });\n  };\n\n  useEffect(() => {\n    getPlayParameters();\n    getPositionFromCarte();\n  }, [numPompier]);\n  const [position, setPosition] = useState([0, 3]); // INITIALISATION DE LA CARTE\n\n  const [carte, setCarte] = useState([[0, 0, 110, 120, 130, 140, 150, 160, 170, 0, 0, 0, 0, 0, 0, 0], [0, 111, 112, 123, 134, 145, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 20, 21, 22, 23, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]);\n  const nbLignesGrille = carte.length;\n  const nbColonnesGrille = carte[0].length;\n  const [mursH, setMursH] = useState([[1, 1, 1, 1, 1, 1, 2, 6, 1, 1, 1, 1, 2, 5, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 2, 6, 1, 6, 2, 1, 1, 1, 5, 2, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 6, 2, 1, 1, 1, 1, 1, 1, 1, 1]]);\n  const [mursV, setMursV] = useState([[1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [2, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [5, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 2], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 5]]);\n\n  const onTextChange = e => {\n    setNumPompier(e.target.value);\n    console.log(typeof e.target.value);\n  };\n\n  const onXChange = e => {\n    e.preventDefault();\n\n    if (e.target.value.length > 0) {\n      updateCarte(position, 0);\n      setPosition(position => [position[0], parseInt(e.target.value)]);\n    } else {\n      updateCarte(position, 0);\n      setPosition(position => [position[0], 0]);\n    }\n  };\n\n  const onYChange = e => {\n    e.preventDefault();\n\n    if (e.target.value.length > 0) {\n      updateCarte(position, 0);\n      setPosition(position => [parseInt(e.target.value), position[1]]);\n    } else {\n      updateCarte(position, 0);\n      setPosition(position => [0, position[1]]);\n    }\n  }; // UPDATES\n\n\n  const updateCarte = (coords, value) => {\n    if (coords[0] < nbLignesGrille && coords[1] < nbColonnesGrille) {\n      try {\n        var c = [...carte];\n        c[coords[0]][coords[1]] = value;\n        setCarte(c);\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  };\n\n  const updateMurH = (coords, value) => {\n    if (coords[0] < mursH.length && coords[1] < mursH[0].length) {\n      try {\n        var m = [...mursH];\n        m[coords[0]][coords[1]] = value;\n        setMursH(m);\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  };\n\n  const updateMurV = (coords, value) => {\n    if (coords[0] < mursV.length && coords[1] < mursV[0].length) {\n      try {\n        var m = [...mursV];\n        m[coords[0]][coords[1]] = value;\n        setMursV(m);\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  }; // ACTIONS\n\n\n  const updateBudget = action => {\n    var depenses = 0;\n    if (configuration[\"coutEq\" + action] != null) depenses += configuration[\"coutEq\" + action].valeur;\n    if (configuration[\"coutInter\" + action] != null) depenses += configuration[\"coutInter\" + action].valeur;\n    setBudget(budget => budget - depenses);\n  };\n\n  const doAction = action => {\n    try {\n      var s = stocks;\n      s[action] = s[action] - 1;\n      setStocks(s);\n    } catch (error) {}\n\n    try {\n      var i = interventions;\n      i[action] = i[action] - 1;\n      setInterventions(i);\n    } catch (error) {}\n\n    updateBudget(action);\n  };\n\n  const updateResultats = sauve => {\n    var res = resultats;\n\n    if (sauve) {\n      res.nbSauves += 1;\n    } else {\n      res.nbDecedes += 1;\n    }\n\n    setResultats(res);\n  };\n\n  useEffect(() => {\n    setBtnClickedBottom(null);\n  }, [position]);\n  useEffect(() => {\n    relacherHabitant();\n  }, [position, mursH, mursV]);\n  useEffect(() => {\n    if (configuration != null) {\n      // console.log(configuration)\n      let inter = interventions;\n      const interKeys = Object.keys(inter);\n      interKeys.forEach(action => {\n        try {\n          if (configuration[\"coutInter\" + action].valeur > 0) {\n            inter[action] = Math.min(configuration[\"coutEq\" + action] != null ? Math.floor(budget / (configuration[\"coutInter\" + action].valeur + configuration[\"coutEq\" + action].valeur)) : Math.floor(budget / configuration[\"coutInter\" + action].valeur), stocks[action] != null ? stocks[action] : 1000);\n          }\n        } catch (error) {// console.log(error,action)\n        }\n      });\n      setInterventions(inter);\n    } else {\n      getPlayParameters();\n    }\n  }, [budget, configuration, numPompier]); // useEffect(() => {\n  //   console.log(\"Stocks\")\n  //   console.log(stocks)\n  // }, [stocks])\n  // useEffect(()=>{\n  //   console.log(\"Interventions\")\n  //   console.log(interventions)\n  // },[interventions])\n  // SOCKETS\n\n  const socket = PlayAPI.getSocket(); // SOCKETS \n\n  const onTourChange = async e => {\n    e.preventDefault();\n    console.log(\"nouveau tour todo\");\n  };\n\n  useEffect(() => {\n    socket.on('changementTour', data => {\n      console.log(\"socket nouveau tour\"); // setCurrentTour(data.numPompier + 1)\n\n      getPlayState(session, equipe);\n    });\n  }); // TESTS\n\n  const test = async () => {\n    console.log(\"test function\");\n  };\n\n  const renderTests = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        top: 200\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        style: {\n          flex: 1,\n          flexDirection: \"column\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: e => onTourChange(e),\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"Manual settings\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"name-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"numPompier\",\n              children: \"Num\\xE9ro pompier\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              name: \"numPompier\",\n              onChange: e => onTextChange(e),\n              value: numPompier,\n              label: \"Num\\xE9ro pompier\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 13\n          }, this), currentTour == numPompier ? /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"Fin du tour\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: true,\n            children: \"Fin du tour\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          flexDirection: \"column\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"numPompier\",\n          children: \"Position x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"xPompier\",\n          onChange: e => onXChange(e),\n          value: position[1]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"numPompier\",\n          children: \"Position y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"yPompier\",\n          onChange: e => onYChange(e),\n          value: position[0]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => test(),\n        children: \"test function\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 7\n    }, this);\n  }; // AUTORISATIONS \n\n\n  const deplacementAutorise = deplacement => {\n    // return true\n    var dpl = [...deplacement];\n    if (dpl[0] == 0 && dpl[1] == 0) return false;\n    if (position[0] + dpl[0] > carte.length - 1 || position[1] + dpl[1] > carte[0].length - 1 || position[0] + dpl[0] < 0 || position[1] + dpl[1] < 0) return false;\n    const dplInterditsCases = [100, 20, 3, 4];\n\n    try {\n      const valeurCaseDeplacement = carte[position[0] + dpl[0]][position[1] + dpl[1]];\n      if (Math.floor(valeurCaseDeplacement / 100) == 1) return false;\n      if (Math.floor(valeurCaseDeplacement / 10) == 2) return false;\n      if (dplInterditsCases.includes(valeurCaseDeplacement)) return false;\n    } catch (error) {}\n\n    const dplInterditsMurs = [1, 2, 3, 5];\n\n    try {\n      if (dpl[0] != 0) {\n        // haut bas\n        if (dpl[0] < 0) {\n          dpl[0] = 0;\n        }\n\n        if (typeof mursH[position[0] + dpl[0]][position[1]] === 'undefined') return false;\n        if (dplInterditsMurs.includes(mursH[position[0] + dpl[0]][position[1]])) return false;\n      } else {\n        // gauche droite\n        if (dpl[1] < 0) {\n          dpl[1] = 0;\n        }\n\n        if (typeof mursV[position[0]][position[1] + dpl[1]] === 'undefined') return false;\n        if (dplInterditsMurs.includes(mursV[position[0]][position[1] + dpl[1]])) return false;\n      }\n    } catch (error) {}\n\n    return true;\n  };\n\n  const testRelacherHabitant = () => {\n    if (carte[position[0]][position[1]] % 10 == 0) return false; // pas de transport d'habitant\n\n    const mursBloquants = [1, 2, 3, 5];\n    if (position[0] == 0 && !mursBloquants.includes(mursH[position[0]][position[1]])) return true; // haut\n\n    if (position[0] == nbLignesGrille - 1 && !mursBloquants.includes(mursH[position[0] + 1][position[1]])) return true; // bas\n\n    if (position[1] == 0 && !mursBloquants.includes(mursV[position[0]][position[1]])) return true; // gauche\n\n    if (position[1] == nbColonnesGrille - 1 && !mursBloquants.includes(mursV[position[0]][position[1] + 1])) return true; // droite\n\n    return false;\n  };\n\n  const relacherHabitant = () => {\n    if (testRelacherHabitant()) {\n      setTimeout(() => {\n        updateResultats(true);\n        updateCarte(position, 100 + numPompier * 10);\n      }, 1000);\n    }\n  };\n\n  const getCasesAutour = () => {\n    var cases = [];\n\n    try {\n      cases.push(carte[position[0] - 1][position[1]]); // dessus\n    } catch (error) {}\n\n    try {\n      cases.push(carte[position[0]][position[1] + 1]); // droite\n    } catch (error) {}\n\n    try {\n      cases.push(carte[position[0] + 1][position[1]]); // dessous\n    } catch (error) {}\n\n    try {\n      cases.push(carte[position[0]][position[1] - 1]); // gauche\n    } catch (error) {}\n\n    return cases;\n  };\n\n  const getMursAutour = () => {\n    var murs = [];\n\n    try {\n      if (mursH[position[0]][position[1]] != 2 || mursH[position[0]][position[1] - 1] < 5 && mursH[position[0]][position[1] + 1] < 5) {\n        murs.push(mursH[position[0]][position[1]]); // dessus\n      } else {\n        murs.push(0);\n      }\n    } catch (error) {}\n\n    try {\n      if (mursV[position[0]][position[1] + 1] != 2 || mursV[position[0] - 1][position[1] + 1] < 5 && mursV[position[0] + 1][position[1] + 1] < 5) {\n        murs.push(mursV[position[0]][position[1] + 1]); // droite\n        // console.log(mursV[position[0]][position[1]+1])\n      } else {\n        murs.push(0);\n      }\n    } catch (error) {}\n\n    try {\n      if (mursH[position[0] + 1][position[1]] != 2 || mursH[position[0] + 1][position[1] - 1] < 5 && mursH[position[0] + 1][position[1] + 1] < 5) {\n        murs.push(mursH[position[0] + 1][position[1]]); // dessous\n      } else {\n        murs.push(0);\n      }\n    } catch (error) {}\n\n    try {\n      if (mursV[position[0]][position[1]] != 2 || mursV[position[0] - 1][position[1]] < 5 && mursV[position[0] + 1][position[1]] < 5) {\n        murs.push(mursV[position[0]][position[1]]); // gauche\n        // console.log(mursV[position[0]][position[1]])\n      } else {\n        murs.push(0);\n      }\n    } catch (error) {} // console.log(murs)\n\n\n    return murs;\n  };\n\n  const [btnClickedBottom, setBtnClickedBottom] = useState(null);\n  const [propositionsCase, setPropositionsCase] = useState([]); // Extincteurs\n\n  const [propositionMursDetruire, setPropositionMursDetruire] = useState([[], []]); // Horizontaux  , Verticaux\n\n  useEffect(() => {\n    if (btnClickedBottom != 3 || btnClickedBottom == null) {\n      setPropositionMursDetruire([[], []]);\n    }\n\n    if (btnClickedBottom > 2 && btnClickedBottom < 6 || btnClickedBottom == null) {\n      setPropositionsCase([]);\n    }\n  }, [btnClickedBottom]); // HANDLERS CLIC GRILLE\n\n  const handleClicCase = (valeurAvant, valeurApres, coordX, coordY) => {\n    console.log(valeurAvant, valeurApres, coordX, coordY);\n\n    try {\n      updateCarte([coordY, coordX], valeurApres);\n      setPropositionsCase([]);\n      setBtnClickedBottom(null);\n\n      if (valeurAvant == 4 && valeurApres == 0) {\n        // Extincteur flamme\n        doAction(\"Feu\");\n      }\n\n      if (valeurAvant == 4 && valeurApres == 3) {\n        // Feu Fumée\n        doAction(\"FeuFum\");\n      }\n\n      if (valeurAvant == 3 && valeurApres == 0) {\n        // Fumée\n        doAction(\"Fum\");\n      }\n\n      if (Math.floor(valeurAvant / 10) == 2 && valeurApres == 0) {\n        // Habitant\n        doAction(\"Habitant\");\n        updateCarte(position, 100 + numPompier * 10 + valeurAvant % 10);\n      }\n    } catch (error) {}\n  };\n\n  const handleClicMur = (num, valeurAvant, coordX, coordY) => {\n    // marqueur dégat\n    if (propositionMursDetruire[0].length > 0 || propositionMursDetruire[1].length > 0) {\n      const checkInCoords = index => {\n        // console.log(\"coordx\",coordX,\"coordy\",coordY,\"position\",position)\n        let numClic = null;\n\n        if (coordX == position[1] && (coordY < position[0] || coordY == position[0] && num == 0)) {\n          // top\n          numClic = 0; // case en question\n          // console.log(\"top\",numClic)\n        }\n\n        if (coordX == position[1] && (coordY > position[0] || coordY == position[0] && num == 2)) {\n          // bottom\n          numClic = 2; // case en question\n          // console.log(\"bottom\",numClic)\n        }\n\n        if (coordY == position[0] && (coordX < position[1] || coordX == position[1] && num == 3)) {\n          // left\n          numClic = 3; // case en question\n          // console.log(\"left\",numClic)\n        }\n\n        if (coordY == position[0] && (coordX > position[1] || coordX == position[1] && num == 1)) {\n          // right\n          numClic = 1; // case en question\n          // console.log(\"right\",numClic)\n        }\n\n        return numClic;\n      };\n\n      var cote = checkInCoords(num % 2);\n      let valeurApres = 4;\n      if (valeurAvant == 1) valeurApres = 3;\n\n      if (cote != null) {\n        try {\n          switch (cote) {\n            case 0:\n              updateMurH([position[0], position[1]], valeurApres); // if(valeurAvant==5 ||)\n\n              break;\n\n            case 1:\n              updateMurV([position[0], position[1] + 1], valeurApres);\n              break;\n\n            case 2:\n              updateMurH([position[0] + 1, position[1]], valeurApres);\n              break;\n\n            case 3:\n              updateMurV([position[0], position[1]], valeurApres);\n              break;\n          }\n\n          doAction(\"Marqueur\");\n        } catch (error) {}\n\n        setPropositionMursDetruire([[], []]);\n        setBtnClickedBottom(null);\n      }\n    }\n  }; // HANDLER CLICS BOUTONS\n\n\n  const handleClicFleche = num => {\n    // Position y x\n    let deplacement;\n\n    switch (num) {\n      case 0:\n        // haut\n        console.log(\"haut\");\n        deplacement = [-1, 0];\n        break;\n\n      case 1:\n        // droite\n        console.log(\"droite\");\n        deplacement = [0, 1];\n        break;\n\n      case 2:\n        // bas\n        console.log(\"bas\");\n        deplacement = [1, 0];\n        break;\n\n      case 3:\n        // gauche\n        console.log(\"gauche\");\n        deplacement = [0, -1];\n        break;\n    }\n\n    if (deplacementAutorise(deplacement)) {\n      updateCarte([position[0] + deplacement[0], position[1] + deplacement[1]], carte[position[0]][position[1]]);\n      setPosition(position => [position[0] + deplacement[0], position[1] + deplacement[1]]);\n      setBudget(budget => budget - configuration.coutInterDeplacement.valeur);\n      updateCarte(position, 0);\n    }\n  };\n\n  const handleClicDoor = ouvrir => {\n    // position, ouvert/fermé\n    setBtnClickedBottom(ouvrir ? 4 : 5);\n    let valueAvant;\n    let valueApres;\n\n    if (ouvrir) {\n      valueAvant = 5;\n      valueApres = 6;\n    } else {\n      valueAvant = 6;\n      valueApres = 5;\n    }\n\n    doAction(\"Porte\");\n\n    try {\n      if (mursH[position[0]][position[1]] == valueAvant) updateMurH([position[0], position[1]], valueApres);\n      if (mursH[position[0] + 1][position[1]] == valueAvant) updateMurH([position[0] + 1, position[1]], valueApres);\n      if (mursV[position[0]][position[1]] == valueAvant) updateMurV([position[0], position[1]], valueApres);\n      if (mursV[position[0]][position[1] + 1] == valueAvant) updateMurV([position[0], position[1] + 1], valueApres);\n    } catch (error) {}\n  };\n\n  const handleClicExtincteur = num => {\n    // 0 FEU, 1 FEUFUM, 2 FUM\n    if (btnClickedBottom != num) {\n      var listeCasesAction = [];\n      let valeurAvant = 5;\n      let valeurApres = 0;\n      setBtnClickedBottom(num);\n\n      switch (num) {\n        case 0:\n          // ETEINDRE FEU\n          break;\n\n        case 1:\n          // FEU FUM\n          valeurApres = 4;\n          break;\n\n        case 2:\n          // ETEINDRE FUMEE\n          valeurAvant = 4;\n          break;\n      }\n\n      try {\n        if (carte[position[0] - 1][position[1]] == valeurAvant) listeCasesAction.push([position[0] - 1, position[1], valeurAvant, valeurApres]); // TOP\n      } catch (error) {}\n\n      try {\n        if (carte[position[0]][position[1] + 1] == valeurAvant) listeCasesAction.push([position[0], position[1] + 1, valeurAvant, valeurApres]); // RIGHT\n      } catch (error) {}\n\n      try {\n        if (carte[position[0] + 1][position[1]] == valeurAvant) listeCasesAction.push([position[0] + 1, position[1], valeurAvant, valeurApres]); // BOTTOM\n      } catch (error) {}\n\n      try {\n        if (carte[position[0]][position[1] - 1] == valeurAvant) listeCasesAction.push([position[0], position[1] - 1, valeurAvant, valeurApres]); // LEFT\n      } catch (error) {}\n\n      setPropositionsCase(listeCasesAction);\n    } else {\n      setBtnClickedBottom(null);\n    }\n  };\n\n  const handleClicMarqueur = () => {\n    if (btnClickedBottom != 3) {\n      setBtnClickedBottom(3);\n\n      if (propositionMursDetruire[0].length > 0 || propositionMursDetruire[1].length > 0) {\n        setPropositionMursDetruire([[], []]);\n      } else {\n        const mursADetruire = [1, 3, 5, 6];\n        var propositions = [[], []];\n        const mursAutour = getMursAutour();\n\n        try {\n          if (mursADetruire.includes(mursAutour[0])) propositions[0].push([position[1], position[0]]); // top\n\n          if (mursADetruire.includes(mursAutour[1])) propositions[1].push([position[1] + 1, position[0]]); // right\n\n          if (mursADetruire.includes(mursAutour[2])) propositions[0].push([position[1], position[0] + 1]); // bottom\n\n          if (mursADetruire.includes(mursAutour[3])) propositions[1].push([position[1], position[0]]); // left\n        } catch (error) {}\n\n        setPropositionMursDetruire(propositions);\n      }\n    } else {\n      setBtnClickedBottom(null);\n    }\n  };\n\n  const handleClicValidated = async bool => {\n    if (bool) {\n      const response = await PlayAPI.nouveauTour(numPompier, carte, mursH, mursV, currentCycle, currentTour + 1, resultats.Decedes, resultats.Sauves, session, equipe);\n    }\n  };\n\n  const handleNoClicked = () => {\n    setPropositionMursDetruire([[], []]);\n    setPropositionsCase([]);\n  };\n\n  const handleClicHabitant = () => {\n    if (btnClickedBottom != 6) {\n      setBtnClickedBottom(6);\n      const valeurApres = 0;\n      var listeCasesAction = [];\n\n      try {\n        const valeurDessus = carte[position[0] - 1][position[1]];\n        if (Math.floor(valeurDessus / 10) == 2) listeCasesAction.push([position[0] - 1, position[1], valeurDessus, valeurApres]); // TOP\n      } catch (error) {}\n\n      try {\n        const valeurDroite = carte[position[0]][position[1] + 1];\n        if (Math.floor(valeurDroite / 10) == 2) listeCasesAction.push([position[0], position[1] + 1, valeurDroite, valeurApres]); // RIGHT\n      } catch (error) {}\n\n      try {\n        const valeurDessous = carte[position[0] + 1][position[1]];\n        if (Math.floor(valeurDessous / 10) == 2) listeCasesAction.push([position[0] + 1, position[1], valeurDessous, valeurApres]); // BOTTOM\n      } catch (error) {}\n\n      try {\n        const valeurGauche = carte[position[0]][position[1] - 1];\n        if (Math.floor(valeurGauche / 10) == 2) listeCasesAction.push([position[0], position[1] - 1, valeurGauche, valeurApres]); // LEFT\n      } catch (error) {}\n\n      setPropositionsCase(listeCasesAction);\n      console.log(\"handle clic habitant\");\n    } else {\n      setBtnClickedBottom(null);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Grille, {\n      nbColonnesGrille: nbColonnesGrille,\n      nbLignesGrille: nbLignesGrille,\n      carte: carte,\n      position: position,\n      mursH: mursH,\n      mursV: mursV,\n      propositionMursDetruire: propositionMursDetruire,\n      propositionsCase: propositionsCase,\n      handleClicMur: handleClicMur,\n      handleClicCase: handleClicCase\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 791,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(BandeauTop, {\n      stocks: stocks,\n      resultats: resultats,\n      numeroPompier: numPompier,\n      cycle: currentCycle,\n      tour: currentTour,\n      configuration: configuration,\n      budget: budget\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 806,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(BandeauBottom, {\n      interventions: interventions,\n      stocks: stocks,\n      numeroPompier: numPompier,\n      tour: currentTour,\n      handleClicFleche: handleClicFleche,\n      handleClicValidated: handleClicValidated,\n      handleClicDoor: handleClicDoor,\n      handleClicMarqueur: handleClicMarqueur,\n      handleClicExt: handleClicExtincteur,\n      handleNoClicked: handleNoClicked,\n      handleClicHabitant: handleClicHabitant,\n      btnClickedBottom: btnClickedBottom,\n      mursAutour: getMursAutour(),\n      casesAutour: getCasesAutour(),\n      currentCase: carte[position[0]][position[1]]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 816,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 790,\n    columnNumber: 5\n  }, this);\n};\n\n_s(InterfaceTact, \"9qIv8CDQiif2ywWD6Uh7RwBTWZQ=\", false, function () {\n  return [useHistory];\n});\n\n_c = InterfaceTact;\nexport default InterfaceTact;\n\nvar _c;\n\n$RefreshReg$(_c, \"InterfaceTact\");","map":{"version":3,"sources":["C:/Users/hugod/décitude/client/src/routes/InterfaceTact.js"],"names":["React","useState","useEffect","PlayAPI","BandeauTop","BandeauBottom","Grille","useHistory","cookie","InterfaceTact","history","user","load","undefined","push","numPompier","setNumPompier","role","replace","currentTour","setCurrentTour","currentCycle","setCurrentCycle","session","setSession","equipe","setEquipe","getPlayState","currentPlayState","Object","keys","length","console","log","parseInt","valeur","setMursH","JSON","parse","mursH","setMursV","mursV","setResultats","Decedes","resultatsDecedes","Sauves","resultatsSauves","configuration","setConfiguration","stocks","setStocks","Interventions","Feu","FeuFum","Fum","Marqueur","resultats","interventions","setInterventions","Deplacement","Porte","Habitant","budget","setBudget","getPlayParameters","param","getConfiguration","getPositionFromCarte","carte","forEach","ligne","Math","floor","type","position","setPosition","setCarte","nbLignesGrille","nbColonnesGrille","onTextChange","e","target","value","onXChange","preventDefault","updateCarte","onYChange","coords","c","error","updateMurH","m","updateMurV","updateBudget","action","depenses","doAction","s","i","updateResultats","sauve","res","nbSauves","nbDecedes","setBtnClickedBottom","relacherHabitant","inter","interKeys","min","socket","getSocket","onTourChange","on","data","test","renderTests","top","flex","flexDirection","deplacementAutorise","deplacement","dpl","dplInterditsCases","valeurCaseDeplacement","includes","dplInterditsMurs","testRelacherHabitant","mursBloquants","setTimeout","getCasesAutour","cases","getMursAutour","murs","btnClickedBottom","propositionsCase","setPropositionsCase","propositionMursDetruire","setPropositionMursDetruire","handleClicCase","valeurAvant","valeurApres","coordX","coordY","handleClicMur","num","checkInCoords","index","numClic","cote","handleClicFleche","coutInterDeplacement","handleClicDoor","ouvrir","valueAvant","valueApres","handleClicExtincteur","listeCasesAction","handleClicMarqueur","mursADetruire","propositions","mursAutour","handleClicValidated","bool","response","nouveauTour","handleNoClicked","handleClicHabitant","valeurDessus","valeurDroite","valeurDessous","valeurGauche"],"mappings":"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","sourcesContent":["import \"../styles/App.css\"\nimport React, { useState, useEffect } from 'react'\nimport PlayAPI from \"../API/PlayAPI\"\nimport BandeauTop from \"../components/interfaceJoueur/BandeauTop\"\nimport BandeauBottom from \"../components/interfaceJoueur/BandeauBottom\"\nimport Grille from \"../components/interfaceJoueur/Grille\"\nimport { useHistory } from 'react-router-dom';\n\n\nimport cookie from 'react-cookies'\n\n\nconst InterfaceTact = () => {\n\n  const history = useHistory()\n\n  const user = cookie.load(\"user\")\n  // console.log(user)\n  if(user==null || user==undefined) history.push(\"/login\");\n\n\n\n  const [numPompier, setNumPompier] = useState(user.role.replace(\"TACT\", \"\"))\n  const [currentTour, setCurrentTour] = useState(null)\n  const [currentCycle, setCurrentCycle] = useState(null)\n  const [session,setSession]=useState(user.session)\n  const [equipe,setEquipe]=useState(user.equipe)\n\n\n\n  const getPlayState=async(session,equipe)=>{\n    const currentPlayState = await PlayAPI.getPlayState(session,equipe)\n   \n      if(Object.keys(currentPlayState).length>0){\n        console.log(\"Get play state 2\")\n\n        setCurrentTour(parseInt(currentPlayState.currentTour.valeur))\n        setCurrentCycle(parseInt(currentPlayState.currentCycle.valeur))\n        setMursH(JSON.parse(currentPlayState.mursH.valeur))\n        setMursV(JSON.parse(currentPlayState.mursV.valeur))\n        // setCarte(JSON.parse(currentPlayState.carte.valeur))\n        setResultats({\n          Decedes:parseInt(currentPlayState.resultatsDecedes.valeur),\n          Sauves:parseInt(currentPlayState.resultatsSauves.valeur),\n        })\n      }\n  }\n\n  useEffect(()=>{\n    if(session!=null && equipe!=null && currentTour==null ){\n      getPlayState(session,equipe)\n    }\n  },[session,equipe,currentTour])\n\n  const [configuration, setConfiguration] = useState(null)\n\n  const [stocks, setStocks] = useState({\n    Interventions: 10,\n    Feu: 1,\n    FeuFum: 10,\n    Fum: 10,\n    Marqueur: 10,\n  })\n  const [resultats, setResultats] = useState({\n    Decedes: 0,\n    Sauves: 0\n  })\n\n  const [interventions, setInterventions] = useState({\n    Deplacement: 0,\n    Feu: 0,\n    FeuFum: 0,\n    Fum: 0,\n    Marqueur: 0,\n    Porte: 0,\n    Habitant: 0\n  })\n\n  const [budget, setBudget] = useState(800)\n\n\n  const getPlayParameters = async () => {\n    const param = await PlayAPI.getConfiguration(session)\n    setConfiguration(param)\n  }\n\n  const getPositionFromCarte=()=>{\n    carte.forEach(ligne => {\n      ligne.forEach(valeur => {\n\n        if( Math.floor(valeur / 100) == 1 && type%100/10==numPompier) console.log(valeur)\n        \n      })\n    });\n  }\n\n\n  useEffect(() => {\n    getPlayParameters()\n    getPositionFromCarte()\n  }, [numPompier])\n\n  const [position, setPosition] = useState([0, 3])\n\n\n  // INITIALISATION DE LA CARTE\n\n  const [carte, setCarte] = useState([\n    [  0,   0, 110, 120, 130, 140, 150, 160, 170,   0,   0,   0,   0,   0,   0,   0],\n    [  0, 111, 112, 123, 134, 145,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n    [  0,  20,  21,  22,  23,  24,  25,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n    [  0,   3,   4,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n    [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n    [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n    [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n    [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n  ])\n\n  const nbLignesGrille = carte.length\n  const nbColonnesGrille = carte[0].length\n\n  const [mursH, setMursH] = useState([\n    [1, 1, 1, 1, 1, 1, 2, 6, 1, 1, 1, 1, 2, 5, 1, 1],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [1, 1, 1, 1, 2, 6, 1, 6, 2, 1, 1, 1, 5, 2, 1, 1],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [1, 1, 1, 1, 1, 1, 6, 2, 1, 1, 1, 1, 1, 1, 1, 1]\n  ])\n\n  const [mursV, setMursV] = useState([\n    [1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\n    [2, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\n    [5, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1],\n    [1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 0, 0, 1],\n    [1, 0, 0, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 2],\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 5]\n  ])\n\n\n  const onTextChange = (e) => {\n    setNumPompier(e.target.value)\n    console.log(typeof (e.target.value))\n  }\n\n  const onXChange = (e) => {\n    e.preventDefault()\n    if (e.target.value.length > 0) {\n      updateCarte(position, 0)\n      setPosition(position => [position[0], parseInt(e.target.value)])\n    } else {\n      updateCarte(position, 0)\n      setPosition(position => [position[0], 0])\n    }\n\n  }\n  const onYChange = (e) => {\n    e.preventDefault()\n    if (e.target.value.length > 0) {\n      updateCarte(position, 0)\n      setPosition(position => [parseInt(e.target.value), position[1]])\n    } else {\n      updateCarte(position, 0)\n      setPosition(position => [0, position[1]])\n    }\n  }\n\n\n  // UPDATES\n  const updateCarte = (coords, value) => {\n    if (coords[0] < nbLignesGrille && coords[1] < nbColonnesGrille) {\n      try {\n        var c = [...carte]\n        c[coords[0]][coords[1]] = value\n        setCarte(c)\n      } catch (error) {\n        console.log(error)\n      }\n    }\n\n\n  }\n  const updateMurH = (coords, value) => {\n    if (coords[0] < mursH.length && coords[1] < mursH[0].length) {\n      try {\n        var m = [...mursH]\n        m[coords[0]][coords[1]] = value\n        setMursH(m)\n\n      } catch (error) {\n        console.log(error)\n      }\n    }\n  }\n  const updateMurV = (coords, value) => {\n    if (coords[0] < mursV.length && coords[1] < mursV[0].length) {\n      try {\n        var m = [...mursV]\n        m[coords[0]][coords[1]] = value\n        setMursV(m)\n      } catch (error) {\n        console.log(error)\n      }\n    }\n  }\n\n  // ACTIONS\n\n  const updateBudget = (action) => {\n    var depenses = 0\n    if (configuration[\"coutEq\" + action] != null) depenses += configuration[\"coutEq\" + action].valeur\n    if (configuration[\"coutInter\" + action] != null) depenses += configuration[\"coutInter\" + action].valeur\n\n    setBudget(budget => budget - depenses)\n\n  }\n\n\n  const doAction = (action) => {\n    try {\n      var s = stocks\n      s[action] = s[action] - 1\n      setStocks(s)\n    } catch (error) { }\n\n    try {\n      var i = interventions\n      i[action] = i[action] - 1\n      setInterventions(i)\n    } catch (error) { }\n    updateBudget(action)\n  }\n\n  const updateResultats = (sauve) => {\n    var res = resultats\n    if (sauve) {\n      res.nbSauves += 1\n    } else {\n      res.nbDecedes += 1\n    }\n    setResultats(res)\n  }\n\n\n\n\n\n  useEffect(() => {\n    setBtnClickedBottom(null)\n  }, [position])\n\n\n  useEffect(() => {\n    relacherHabitant()\n  }, [position, mursH, mursV])\n\n  useEffect(() => {\n    if (configuration != null) {\n      // console.log(configuration)\n      let inter = interventions\n      const interKeys = Object.keys(inter)\n\n      interKeys.forEach(action => {\n        try {\n          if (configuration[\"coutInter\" + action].valeur > 0) {\n\n            inter[action] = Math.min(\n              configuration[\"coutEq\" + action] != null ? Math.floor(budget / (configuration[\"coutInter\" + action].valeur + configuration[\"coutEq\" + action].valeur)) : Math.floor(budget / configuration[\"coutInter\" + action].valeur),\n              stocks[action] != null ? stocks[action] : 1000\n            )\n          }\n        } catch (error) {\n          // console.log(error,action)\n        }\n\n      })\n      setInterventions(inter)\n    } else {\n      getPlayParameters()\n    }\n\n\n  }, [budget, configuration, numPompier])\n\n\n  // useEffect(() => {\n  //   console.log(\"Stocks\")\n  //   console.log(stocks)\n  // }, [stocks])\n\n  // useEffect(()=>{\n  //   console.log(\"Interventions\")\n  //   console.log(interventions)\n  // },[interventions])\n  \n\n  // SOCKETS\n  const socket = PlayAPI.getSocket()\n\n  // SOCKETS \n  const onTourChange = async (e) => {\n    e.preventDefault()\n    console.log(\"nouveau tour todo\")\n  }\n\n\n  useEffect(() => {\n    socket.on('changementTour', (data) => {\n      console.log(\"socket nouveau tour\")\n      // setCurrentTour(data.numPompier + 1)\n      getPlayState(session,equipe)\n    })\n  });\n\n\n\n  // TESTS\n\n  const test = async () => {\n\n    console.log(\"test function\")\n  }\n\n  const renderTests = () => {\n    return (\n      <div style={{ position: \"absolute\", top: 200 }}>\n        <div className=\"card\" style={{ flex: 1, flexDirection: \"column\" }}>\n          <form onSubmit={e => onTourChange(e)}>\n            <h1>Manual settings</h1>\n            <div className=\"name-field\">\n              <label htmlFor=\"numPompier\">Numéro pompier</label>\n              <input\n                type=\"number\"\n                name=\"numPompier\"\n                onChange={e => onTextChange(e)}\n                value={numPompier}\n                label=\"Numéro pompier\"\n              />\n            </div>\n            {currentTour == numPompier ?\n              <button>Fin du tour</button>\n              :\n              <button disabled>Fin du tour</button>\n\n            }\n\n          </form>\n\n        </div>\n        <div style={{ flex: 1, flexDirection: \"column\" }}>\n          <label htmlFor=\"numPompier\">Position x</label>\n          <input\n            type=\"number\"\n            name=\"xPompier\"\n            onChange={e => onXChange(e)}\n            value={position[1]}\n          />\n          <label htmlFor=\"numPompier\">Position y</label>\n          <input\n            type=\"number\"\n            name=\"yPompier\"\n            onChange={e => onYChange(e)}\n            value={position[0]}\n          />\n        </div>\n        <button onClick={() => test()} >test function</button>\n      </div>\n    )\n  }\n\n\n\n\n  // AUTORISATIONS \n  const deplacementAutorise = (deplacement) => {\n    // return true\n    var dpl = [...deplacement]\n    if (dpl[0] == 0 && dpl[1] == 0) return false\n    if (position[0] + dpl[0] > carte.length - 1 || position[1] + dpl[1] > carte[0].length - 1 || position[0] + dpl[0] < 0 || position[1] + dpl[1] < 0) return false\n\n\n    const dplInterditsCases = [100, 20, 3, 4]\n    \n    try {\n      const valeurCaseDeplacement = carte[position[0] + dpl[0]][position[1] + dpl[1]]\n      if (Math.floor(valeurCaseDeplacement/100)==1) return false\n      if (Math.floor(valeurCaseDeplacement/10)==2) return false\n      if (dplInterditsCases.includes(valeurCaseDeplacement)) return false\n    } catch (error) { }\n\n    const dplInterditsMurs = [1, 2, 3, 5]\n    try {\n      if (dpl[0] != 0) { // haut bas\n        if (dpl[0] < 0) {\n          dpl[0] = 0\n        }\n        if (typeof (mursH[position[0] + dpl[0]][position[1]]) === 'undefined') return false\n        if (dplInterditsMurs.includes(mursH[position[0] + dpl[0]][position[1]])) return false\n      } else { // gauche droite\n        if (dpl[1] < 0) {\n          dpl[1] = 0\n        }\n        if (typeof (mursV[position[0]][position[1] + dpl[1]]) === 'undefined') return false\n        if (dplInterditsMurs.includes(mursV[position[0]][position[1] + dpl[1]])) return false\n      }\n    } catch (error) { }\n\n\n\n\n    return true\n  }\n  const testRelacherHabitant = () => {\n    if (carte[position[0]][position[1]]%10==0) return false // pas de transport d'habitant\n\n    const mursBloquants = [1, 2, 3, 5]\n\n    if (position[0] == 0 && !mursBloquants.includes(mursH[position[0]][position[1]])) return true // haut\n    if (position[0] == nbLignesGrille - 1 && !mursBloquants.includes(mursH[position[0] + 1][position[1]])) return true // bas\n\n    if (position[1] == 0 && !mursBloquants.includes(mursV[position[0]][position[1]])) return true // gauche\n    if (position[1] == nbColonnesGrille - 1 && !mursBloquants.includes(mursV[position[0]][position[1] + 1])) return true // droite\n\n    return false\n  }\n  const relacherHabitant = () => {\n    if (testRelacherHabitant()) {\n      setTimeout(() => {\n        updateResultats(true)\n        updateCarte(position, 100+numPompier*10)\n      }, 1000);\n    }\n  }\n\n  const getCasesAutour = () => {\n    var cases = []\n\n    try {\n      cases.push(carte[position[0] - 1][position[1]]) // dessus\n    } catch (error) { }\n    try {\n      cases.push(carte[position[0]][position[1] + 1]) // droite\n    } catch (error) { }\n    try {\n      cases.push(carte[position[0] + 1][position[1]]) // dessous\n    } catch (error) { }\n    try {\n      cases.push(carte[position[0]][position[1] - 1]) // gauche\n    } catch (error) { }\n    return cases\n  }\n  const getMursAutour = () => {\n    var murs = []\n\n    try {\n      if (mursH[position[0]][position[1]] != 2 || (mursH[position[0]][position[1] - 1] < 5 && mursH[position[0]][position[1] + 1] < 5)) {\n        murs.push(mursH[position[0]][position[1]]) // dessus\n      } else {\n        murs.push(0)\n      }\n    } catch (error) { }\n\n    try {\n      if (mursV[position[0]][position[1] + 1] != 2 || (mursV[position[0] - 1][position[1] + 1] < 5 && mursV[position[0] + 1][position[1] + 1] < 5)) {\n        murs.push(mursV[position[0]][position[1] + 1])  // droite\n        // console.log(mursV[position[0]][position[1]+1])\n\n      } else {\n        murs.push(0)\n      }\n    } catch (error) { }\n\n    try {\n      if (mursH[position[0] + 1][position[1]] != 2 || (mursH[position[0] + 1][position[1] - 1] < 5 && mursH[position[0] + 1][position[1] + 1] < 5)) {\n        murs.push(mursH[position[0] + 1][position[1]]) // dessous\n      } else {\n        murs.push(0)\n      }\n\n    } catch (error) { }\n    try {\n      if (mursV[position[0]][position[1]] != 2 || (mursV[position[0] - 1][position[1]] < 5 && mursV[position[0] + 1][position[1]] < 5)) {\n        murs.push(mursV[position[0]][position[1]])  // gauche\n        // console.log(mursV[position[0]][position[1]])\n      } else {\n        murs.push(0)\n      }\n    } catch (error) { }\n    // console.log(murs)\n    return murs\n  }\n\n\n\n\n  const [btnClickedBottom, setBtnClickedBottom] = useState(null)\n  const [propositionsCase, setPropositionsCase] = useState([]) // Extincteurs\n  const [propositionMursDetruire, setPropositionMursDetruire] = useState([[], []]) // Horizontaux  , Verticaux\n  useEffect(() => {\n    if (btnClickedBottom != 3 || btnClickedBottom == null) {\n      setPropositionMursDetruire([[], []])\n    }\n    if ((btnClickedBottom > 2 && btnClickedBottom < 6) || btnClickedBottom == null) {\n      setPropositionsCase([])\n    }\n  }, [btnClickedBottom])\n\n\n\n\n  // HANDLERS CLIC GRILLE\n\n  const handleClicCase = (valeurAvant, valeurApres, coordX, coordY) => {\n\n    console.log(valeurAvant, valeurApres, coordX, coordY)\n    try {\n      updateCarte([coordY, coordX], valeurApres)\n      setPropositionsCase([])\n      setBtnClickedBottom(null)\n\n      if (valeurAvant == 4 && valeurApres == 0) { // Extincteur flamme\n        doAction(\"Feu\")\n      }\n      if (valeurAvant == 4 && valeurApres == 3) { // Feu Fumée\n        doAction(\"FeuFum\")\n      }\n      if (valeurAvant == 3 && valeurApres == 0) { // Fumée\n        doAction(\"Fum\")\n      }\n      if (Math.floor(valeurAvant/10)==2 && valeurApres == 0) { // Habitant\n        doAction(\"Habitant\")\n        updateCarte(position, 100+numPompier*10+valeurAvant%10)\n      }\n    } catch (error) { }\n  }\n\n  const handleClicMur = (num, valeurAvant, coordX, coordY) => { // marqueur dégat\n    if (propositionMursDetruire[0].length > 0 || propositionMursDetruire[1].length > 0) {\n\n      const checkInCoords = (index) => {\n        // console.log(\"coordx\",coordX,\"coordy\",coordY,\"position\",position)\n\n        let numClic = null\n\n        if (coordX == position[1] && (coordY < position[0] || (coordY == position[0] && num == 0))) { // top\n          numClic = 0  // case en question\n          // console.log(\"top\",numClic)\n        }\n        if (coordX == position[1] && (coordY > position[0] || (coordY == position[0] && num == 2))) { // bottom\n          numClic = 2  // case en question\n          // console.log(\"bottom\",numClic)\n        }\n        if (coordY == position[0] && (coordX < position[1] || (coordX == position[1] && num == 3))) { // left\n          numClic = 3  // case en question\n          // console.log(\"left\",numClic)\n        }\n        if (coordY == position[0] && (coordX > position[1] || (coordX == position[1] && num == 1))) { // right\n          numClic = 1  // case en question\n          // console.log(\"right\",numClic)\n        }\n\n        return numClic\n      }\n\n      var cote = checkInCoords(num % 2)\n      let valeurApres = 4\n      if (valeurAvant == 1) valeurApres = 3\n\n      if (cote != null) {\n        try {\n          switch (cote) {\n            case 0:\n              updateMurH([position[0], position[1]], valeurApres)\n              // if(valeurAvant==5 ||)\n              break;\n            case 1:\n              updateMurV([position[0], position[1] + 1], valeurApres)\n              break;\n            case 2:\n              updateMurH([position[0] + 1, position[1]], valeurApres)\n              break;\n            case 3:\n              updateMurV([position[0], position[1]], valeurApres)\n              break;\n          }\n\n          doAction(\"Marqueur\")\n\n\n        } catch (error) {\n        }\n\n\n\n        setPropositionMursDetruire([[], []])\n        setBtnClickedBottom(null)\n      }\n\n    }\n\n  }\n\n\n\n  // HANDLER CLICS BOUTONS\n\n\n  const handleClicFleche = (num) => {\n    // Position y x\n    let deplacement\n    switch (num) {\n      case 0: // haut\n        console.log(\"haut\")\n        deplacement = [-1, 0]\n        break;\n\n      case 1: // droite\n        console.log(\"droite\")\n        deplacement = [0, 1]\n        break;\n\n      case 2: // bas\n        console.log(\"bas\")\n        deplacement = [1, 0]\n        break;\n\n      case 3: // gauche\n        console.log(\"gauche\")\n        deplacement = [0, -1]\n\n        break;\n    }\n    if (deplacementAutorise(deplacement)) {\n      updateCarte([position[0] + deplacement[0], position[1] + deplacement[1]], carte[position[0]][position[1]])\n      setPosition(position => [position[0] + deplacement[0], position[1] + deplacement[1]])\n      setBudget(budget=>budget-configuration.coutInterDeplacement.valeur)\n      updateCarte(position, 0)\n    }\n  }\n\n\n  const handleClicDoor = (ouvrir) => { // position, ouvert/fermé\n    setBtnClickedBottom(ouvrir ? 4 : 5)\n    let valueAvant\n    let valueApres\n\n    if (ouvrir) {\n      valueAvant = 5\n      valueApres = 6\n\n    } else {\n      valueAvant = 6\n      valueApres = 5\n    }\n    doAction(\"Porte\")\n    try {\n      if (mursH[position[0]][position[1]] == valueAvant) updateMurH([position[0], position[1]], valueApres)\n      if (mursH[position[0] + 1][position[1]] == valueAvant) updateMurH([position[0] + 1, position[1]], valueApres)\n      if (mursV[position[0]][position[1]] == valueAvant) updateMurV([position[0], position[1]], valueApres)\n      if (mursV[position[0]][position[1] + 1] == valueAvant) updateMurV([position[0], position[1] + 1], valueApres)\n    } catch (error) {\n\n    }\n  }\n\n  const handleClicExtincteur = (num) => {\n    // 0 FEU, 1 FEUFUM, 2 FUM\n    if (btnClickedBottom != num) {\n      var listeCasesAction = []\n      let valeurAvant = 5\n      let valeurApres = 0\n      setBtnClickedBottom(num)\n      switch (num) {\n        case 0: // ETEINDRE FEU\n          break;\n\n        case 1: // FEU FUM\n          valeurApres = 4\n          break;\n        case 2: // ETEINDRE FUMEE\n          valeurAvant = 4\n          break;\n      }\n\n      try {\n        if (carte[position[0] - 1][position[1]] == valeurAvant) listeCasesAction.push([position[0] - 1, position[1], valeurAvant, valeurApres]) // TOP\n      } catch (error) { }\n      try {\n        if (carte[position[0]][position[1] + 1] == valeurAvant) listeCasesAction.push([position[0], position[1] + 1, valeurAvant, valeurApres]) // RIGHT\n      } catch (error) { }\n      try {\n        if (carte[position[0] + 1][position[1]] == valeurAvant) listeCasesAction.push([position[0] + 1, position[1], valeurAvant, valeurApres]) // BOTTOM\n      } catch (error) { }\n      try {\n        if (carte[position[0]][position[1] - 1] == valeurAvant) listeCasesAction.push([position[0], position[1] - 1, valeurAvant, valeurApres]) // LEFT\n      } catch (error) { }\n\n      setPropositionsCase(listeCasesAction)\n    } else {\n      setBtnClickedBottom(null)\n    }\n\n  }\n\n  const handleClicMarqueur = () => {\n    if (btnClickedBottom != 3) {\n      setBtnClickedBottom(3)\n      if (propositionMursDetruire[0].length > 0 || propositionMursDetruire[1].length > 0) {\n        setPropositionMursDetruire([[], []])\n      } else {\n        const mursADetruire = [1, 3, 5, 6]\n        var propositions = [\n          [],\n          []\n        ]\n        const mursAutour = getMursAutour()\n\n        try {\n          if (mursADetruire.includes(mursAutour[0])) propositions[0].push([position[1], position[0]]) // top\n          if (mursADetruire.includes(mursAutour[1])) propositions[1].push([position[1] + 1, position[0]]) // right\n          if (mursADetruire.includes(mursAutour[2])) propositions[0].push([position[1], position[0] + 1]) // bottom\n          if (mursADetruire.includes(mursAutour[3])) propositions[1].push([position[1], position[0]]) // left\n\n        } catch (error) {\n\n        }\n        setPropositionMursDetruire(propositions)\n\n      }\n    } else {\n      setBtnClickedBottom(null)\n    }\n\n\n  }\n\n  const handleClicValidated =async (bool) => {\n    if(bool){\n      const response =  await PlayAPI.nouveauTour(numPompier,carte,mursH,mursV,currentCycle,currentTour+1,resultats.Decedes,resultats.Sauves,session,equipe)      \n    }\n  }\n\n  const handleNoClicked = () => {\n    setPropositionMursDetruire([[], []])\n    setPropositionsCase([])\n  }\n\n  const handleClicHabitant = () => {\n    if (btnClickedBottom != 6) {\n      setBtnClickedBottom(6)\n      const valeurApres = 0\n      var listeCasesAction = []\n      try {\n        const valeurDessus =  carte[position[0] - 1][position[1]]\n        if (Math.floor(valeurDessus/10)==2) listeCasesAction.push([position[0] - 1, position[1], valeurDessus, valeurApres]) // TOP\n      } catch (error) { }\n      try {\n        const valeurDroite =  carte[position[0]][position[1] + 1]\n        if (Math.floor(valeurDroite/10)==2) listeCasesAction.push([position[0], position[1] + 1, valeurDroite, valeurApres]) // RIGHT\n      } catch (error) { }\n      try {\n        const valeurDessous =  carte[position[0] + 1][position[1]] \n        if (Math.floor(valeurDessous/10)==2)  listeCasesAction.push([position[0] + 1, position[1], valeurDessous, valeurApres]) // BOTTOM\n      } catch (error) { }\n      try {\n        const valeurGauche = carte[position[0]][position[1] - 1]\n        if (Math.floor(valeurGauche/10)==2) listeCasesAction.push([position[0], position[1] - 1, valeurGauche, valeurApres]) // LEFT\n      } catch (error) { }\n\n      setPropositionsCase(listeCasesAction)\n\n\n      console.log(\"handle clic habitant\")\n    } else {\n      setBtnClickedBottom(null)\n    }\n\n  }\n\n\n\n\n\n  return (\n    <div>\n      <Grille\n        nbColonnesGrille={nbColonnesGrille}\n        nbLignesGrille={nbLignesGrille}\n        carte={carte}\n        position={position}\n        mursH={mursH}\n        mursV={mursV}\n        propositionMursDetruire={propositionMursDetruire}\n        propositionsCase={propositionsCase}\n        handleClicMur={handleClicMur}\n        handleClicCase={handleClicCase}\n\n      />\n      {/* {renderTests()} */}\n\n      <BandeauTop\n        stocks={stocks}\n        resultats={resultats}\n        numeroPompier={numPompier}\n        cycle={currentCycle}\n        tour={currentTour}\n        configuration={configuration}\n        budget={budget}\n      />\n\n      <BandeauBottom\n        interventions={interventions}\n        stocks={stocks}\n        numeroPompier={numPompier}\n        tour={currentTour}\n        handleClicFleche={handleClicFleche}\n        handleClicValidated={handleClicValidated}\n        handleClicDoor={handleClicDoor}\n        handleClicMarqueur={handleClicMarqueur}\n        handleClicExt={handleClicExtincteur}\n        handleNoClicked={handleNoClicked}\n        handleClicHabitant={handleClicHabitant}\n        btnClickedBottom={btnClickedBottom}\n        mursAutour={getMursAutour()}\n        casesAutour={getCasesAutour()}\n        currentCase={carte[position[0]][position[1]]}\n      />\n      {/* <div>\n    <Transition\n      transitionName=\"example\"\n      transitionAppear={true}\n      transitionAppearTimeout={500}\n      transitionEnter={false}\n      transitionLeave={false}>\n      <h1>Fading at Initial Mount</h1>\n    </Transition>\n    </div> */}\n    </div>\n  );\n\n}\n\nexport default InterfaceTact;\n\n"]},"metadata":{},"sourceType":"module"}