{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hugod\\\\decitude\\\\client\\\\src\\\\routes\\\\InterInterface.js\",\n    _s = $RefreshSig$();\n\nimport \"../styles/App.css\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport PlayAPI from \"../API/PlayAPI\";\nimport InterBandeauTop from \"../components/interfaceJoueur/InterBandeauTop\";\nimport InterBandeauBottom from \"../components/interfaceJoueur/InterBandeauBottom\";\nimport Grille from \"../components/interfaceJoueur/Grille\";\nimport InterInterventions from \"../components/interfaceJoueur/InterInterventions\";\nimport { useHistory } from 'react-router-dom';\nimport io from 'socket.io-client';\nimport { Typography } from \"@material-ui/core\";\nimport ContentsAPI from \"../API/ContentsAPI\";\nimport cookie from 'react-cookies';\nimport InterBandeauDroite from \"../components/interfaceJoueur/InterBandeauDroite\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst InterInterface = () => {\n  _s();\n\n  const history = useHistory();\n  const user = cookie.load(\"user\");\n\n  const handleDisconnect = () => {\n    cookie.save('user', \"disconnected\", {\n      path: '/',\n      maxAge: 60 * 60 * 1.5 //sec\n\n    });\n    history.push('/login');\n  };\n\n  if (user === null || user === undefined || user == \"disconnected\") history.push(\"/login\");\n  if (user !== null && user !== undefined && user.role !== undefined && !user.role.includes(\"INTER\")) handleDisconnect();\n  const [play, setPlay] = useState(false);\n  const [numPompier, setNumPompier] = useState(0);\n  const [currentPomp, setCurrentPomp] = useState(null);\n  const [currentTour, setCurrentTour] = useState(null);\n  const [currentCycle, setCurrentCycle] = useState(null);\n  const [currentSequence, setCurrentSequence] = useState(null);\n  const [session, setSession] = useState(user !== null && user !== undefined ? user.session : null);\n  const [equipe, setEquipe] = useState(user !== null && user !== undefined ? user.equipe : null);\n  const [chrono, setChrono] = useState(null);\n  const [vue, setVue] = useState(\"operations\");\n  const [configuration, setConfiguration] = useState(null);\n  const [couts, setCouts] = useState(null);\n  const [resultats, setResultats] = useState({\n    Decedes: 0,\n    Sauves: 0,\n    Marqueur: 0\n  });\n  const [budget, setBudget] = useState({\n    sequence: 0,\n    depense: 0\n  });\n  const [cycles, setCycles] = useState(null);\n  useEffect(() => {\n    if (configuration != null) {\n      setCouts({\n        interventions: {\n          coutInterDeplacement: configuration.coutInterDeplacement.valeur,\n          coutInterDeplacementHab: configuration.coutInterDeplacementHab.valeur,\n          coutInterFeu: configuration.coutInterFeu.valeur,\n          coutInterFeuFum: configuration.coutInterFeuFum.valeur,\n          coutInterFum: configuration.coutInterFum.valeur,\n          coutInterMarqueur: configuration.coutInterMarqueur.valeur,\n          coutInterPorte: configuration.coutInterPorte.valeur,\n          coutInterHab: configuration.coutInterHabitant.valeur\n        },\n        equipements: {\n          coutEqFeu: configuration.coutEqFeu.valeur,\n          coutEqFeuFum: configuration.coutEqFeuFum.valeur,\n          coutEqFum: configuration.coutEqFum.valeur,\n          coutEqMarqueur: configuration.coutEqMarqueur.valeur\n        }\n      });\n      setBudget({\n        interventions: {\n          sequence: configuration.budgetDefaultInter.valeur,\n          depense: 0\n        },\n        equipements: {\n          sequence: configuration.budgetDefaultInter.valeur,\n          depense: 0\n        }\n      });\n\n      if (cycles != null) {\n        initInfos(cycles);\n      }\n    }\n  }, [configuration]);\n  const [budgetSim, setBudgetSim] = useState(null);\n  useEffect(() => {\n    if (cycles != null) {\n      // console.log(\"save bdg init\")\n      PlayAPI.saveBudgetsPompInit(cycles, session, equipe).then(() => {\n        if (configuration != null) {\n          initInfos(cycles);\n        }\n\n        if (budgetSim == null || budgetSim.interventions == undefined || budgetSim.interventions.numCycle !== cycles.interventions.length % 2 + 1 || budgetSim.equipements.numCycle !== cycles.equipements.length % 2 + 1) {\n          setBudgetSim({\n            interventions: {\n              numSeq: cycles.interventions.length > 1 ? cycles.interventions.length % 2 == 0 ? cycles.interventions[cycles.interventions.length - 1].numSeq + 1 : cycles.interventions[cycles.interventions.length - 1].numSeq : 1,\n              numCycle: cycles.interventions.length % 2 + 1,\n              pomp1: 0,\n              pomp2: 0,\n              pomp3: 0,\n              pomp4: 0,\n              pomp5: 0,\n              pomp6: 0\n            },\n            equipements: {\n              numSeq: cycles.equipements.length > 1 ? cycles.equipements.length % 2 == 0 ? cycles.equipements[cycles.equipements.length - 1].numSeq + 1 : cycles.equipements[cycles.equipements.length - 1].numSeq : 1,\n              numCycle: cycles.equipements.length % 2 + 1,\n              Feu: {\n                pomp1: 0,\n                pomp2: 0,\n                pomp3: 0,\n                pomp4: 0,\n                pomp5: 0,\n                pomp6: 0\n              },\n              FeuFum: {\n                pomp1: 0,\n                pomp2: 0,\n                pomp3: 0,\n                pomp4: 0,\n                pomp5: 0,\n                pomp6: 0\n              },\n              Fum: {\n                pomp1: 0,\n                pomp2: 0,\n                pomp3: 0,\n                pomp4: 0,\n                pomp5: 0,\n                pomp6: 0\n              },\n              Marqueur: {\n                pomp1: 0,\n                pomp2: 0,\n                pomp3: 0,\n                pomp4: 0,\n                pomp5: 0,\n                pomp6: 0\n              }\n            }\n          });\n        }\n      });\n    } // console.log(cycles.equipements)\n\n  }, [cycles]);\n  const [validated, setValidated] = useState({\n    interventions: false,\n    equipements: false\n  }); // const [page, setPage] = useState({\n  //   interventions: 0,\n  //   equipements: 0\n  // })\n\n  const isLoading = useRef(false); // INITIALISATION DE LA CARTE\n\n  const [carte, setCarte] = useState([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]); // const [carte, setCarte] = useState([])\n\n  const [nbLignesGrille, setNbLignesGrille] = useState(0);\n  const [nbColonnesGrille, setNbColonnesGrille] = useState(0);\n  const [position, setPosition] = useState(null);\n  const [mursH, setMursH] = useState([[1, 1, 1, 1, 1, 1, 2, 6, 1, 1, 1, 1, 2, 5, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 2, 6, 1, 6, 2, 1, 1, 1, 5, 2, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 6, 2, 1, 1, 1, 1, 1, 1, 1, 1]]);\n  const [mursV, setMursV] = useState([[1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [2, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [5, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 2], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 5]]);\n\n  const getNombreMarqueur = (mursH, mursV) => {\n    let nbMarqueur = 0;\n    mursH.forEach(ligne => {\n      ligne.forEach(valeur => {\n        if (valeur == 3) nbMarqueur = nbMarqueur + 1;\n        if (valeur == 4) nbMarqueur = nbMarqueur + 2;\n      });\n    });\n    mursV.forEach(ligne => {\n      ligne.forEach(valeur => {\n        if (valeur == 3) nbMarqueur = nbMarqueur + 1;\n        if (valeur == 4) nbMarqueur = nbMarqueur + 2;\n      });\n    });\n    return nbMarqueur;\n  }; // GET PLAY PARAMETERS \n\n\n  const initInfos = cycles => {\n    if (cycles !== null && configuration !== null) {\n      console.log(\"init infos\");\n      const lastCycleEq = [...cycles.equipements].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.equipements].length - 1];\n      const lastCycleInter = [...cycles.interventions].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.interventions].length - 1];\n      var val = {\n        interventions: false,\n        equipements: false\n      };\n      if (lastCycleInter !== null && lastCycleInter !== undefined && lastCycleInter.numSeq == currentSequence && lastCycleInter.numCycle == currentCycle) val.interventions = true;\n      if (lastCycleEq !== null && lastCycleEq !== undefined && lastCycleEq.numSeq == currentSequence && lastCycleEq.numCycle == currentCycle) val.equipements = true;\n      setValidated(val);\n      var b = {\n        interventions: {\n          sequence: configuration.budgetDefaultInter.valeur,\n          depense: getBudgetTot(budgetSim, \"interventions\")\n        },\n        equipements: {\n          sequence: configuration.budgetDefaultInter.valeur,\n          depense: getBudgetTot(budgetSim, \"equipements\")\n        }\n      };\n      setBudget(b);\n    }\n  };\n\n  useEffect(() => {\n    initInfos(cycles);\n  }, [couts]); // useEffect(()=>{\n  //   console.log(chrono)\n  // },[chrono])\n\n  const getPlayState = async (session, equipe) => {\n    if (!isLoading.current && configuration != null) {\n      isLoading.current = true;\n      console.log(\"getplaystate\");\n      const currentPlayState = await PlayAPI.getPlayState(session, equipe);\n      console.log(currentPlayState);\n\n      if (Object.keys(currentPlayState).length > 0) {\n        // console.log(currentPlayState)\n        setCurrentPomp(parseInt(JSON.parse(currentPlayState.currentPomp.valeur)));\n        setCurrentTour(parseInt(JSON.parse(currentPlayState.currentTour.valeur)));\n        setCurrentCycle(parseInt(JSON.parse(currentPlayState.currentCycle.valeur)));\n        setCurrentSequence(parseInt(JSON.parse(currentPlayState.currentSequence.valeur)));\n        const mursH = JSON.parse(currentPlayState.mursH.valeur);\n        const mursV = JSON.parse(currentPlayState.mursV.valeur);\n        setPlay(JSON.parse(currentPlayState.play.valeur));\n        setMursH(mursH);\n        setMursV(mursV);\n        setCarte(JSON.parse(currentPlayState.carte.valeur));\n        setResultats({\n          Decedes: parseInt(JSON.parse(currentPlayState.resultatsDecedes.valeur)),\n          Sauves: parseInt(JSON.parse(currentPlayState.resultatsSauves.valeur)),\n          Marqueur: getNombreMarqueur(mursH, mursV)\n        });\n        setCycles(JSON.parse(currentPlayState.budgetsPompInit.valeur));\n        const c = parseInt(JSON.parse(currentPlayState.currrentChrono.valeur));\n\n        if (configuration !== null && c <= configuration.chronoTourInter.valeur && parseInt(JSON.parse(currentPlayState.currentPomp.valeur)) == numPompier) {\n          setChrono(c);\n        } else {\n          setChrono(null); // console.log(\"chrono\")\n        }\n\n        setPlay(JSON.parse(currentPlayState.play.valeur));\n      } else {\n        console.log(\"error\");\n      } // getPositionFromCarte(JSON.parse(currentPlayState.carte.valeur))\n\n\n      isLoading.current = false;\n    } else {\n      console.log(configuration);\n    }\n  }; // useEffect(()=>{\n  //   console.log(currentPomp)\n  // },[currentPomp])\n\n\n  useEffect(() => {\n    // console.log(carte)\n    if (carte.length > 0) {\n      setNbLignesGrille(carte.length);\n      setNbColonnesGrille(carte[0].length);\n      setPosition([carte.length + 1, carte[0].length + 1]);\n    }\n  }, [carte]);\n  useEffect(() => {\n    console.log(configuration);\n  }, [configuration]);\n  useEffect(() => {\n    if (configuration === null) getPlayParameters();\n\n    if (session != null && equipe != null && currentTour == null) {\n      if (!isLoading.current && configuration !== null) getPlayState(session, equipe); // getPositionFromCarte()\n    }\n  }, [session, equipe, numPompier, configuration]);\n\n  const getPlayParameters = async () => {\n    console.log(\"getPlay Parameters\");\n    const param = await PlayAPI.getConfiguration(session);\n    setConfiguration(param);\n    console.log(param);\n  };\n\n  const getBudgetTot = (budgetSim, type) => {\n    let sum = 0;\n\n    if (couts !== null) {\n      if (type == \"interventions\") {\n        // if (budgetSim !== null && budgetSim !== undefined) {\n        //   const lastCycleInter = [...cycles.interventions].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.interventions].length - 1]\n        //   if (budgetSim.interventions.numSeq == currentSequence && budgetSim.interventions.numCycle > currentCycle || lastCycleInter === undefined) {\n        //     Object.keys(budgetSim.interventions).forEach((key) => {\n        //       if (key != \"numCycle\" && key != \"numSeq\") {\n        //         console.log(\"test\")\n        //         sum += budgetSim.interventions[key]\n        //       }\n        //     })\n        //   }\n        // }\n        cycles.interventions.forEach(c => {\n          if (c.numSeq == currentSequence) {\n            Object.keys(c).forEach(key => {\n              if (key != \"numCycle\" && key != \"numSeq\") {\n                // console.log(c[key])\n                sum += c[key];\n              }\n            });\n          }\n        });\n      } else {\n        const lastCycleEq = [...cycles.equipements].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.equipements].length - 1]; // if (budgetSim.equipements.numSeq == currentSequence && budgetSim.equipements.numCycle > currentCycle || lastCycleEq === undefined) {\n        //   Object.keys(budgetSim.equipements).forEach((key) => {\n        //     if (key != \"numCycle\" && key != \"numSeq\") {\n        //       Object.values(budgetSim.equipements[key]).forEach(value => {\n        //         sum += value * couts.equipements[\"coutEq\" + key]\n        //       })\n        //     }\n        //   })\n        // }\n\n        cycles.equipements.forEach(c => {\n          if (c.numSeq == currentSequence) {\n            Object.keys(c).forEach(key => {\n              if (key != \"numCycle\" && key != \"numSeq\") {\n                Object.values(c[key]).forEach(v => {\n                  sum += couts.equipements[\"coutEq\" + key] * v;\n                });\n              }\n            });\n          }\n        });\n      }\n    }\n\n    return sum;\n  }; // useEffect(()=>{\n  //   if(budgetSim!==null){\n  //     console.log(budgetSim.interventions)\n  //   }\n  // },[budgetSim])\n\n\n  const handleBudgetChange = (type, newBudget) => {\n    var bSim = { ...budgetSim\n    };\n    bSim[type] = newBudget;\n    setBudgetSim(bSim);\n  };\n\n  useEffect(() => {\n    if (validated.interventions && validated.equipements && numPompier == currentPomp) checkNouveauTour();\n  }, [validated, vue]);\n\n  const handleClicValidated = (type, bool) => {\n    if (bool) {\n      var v = { ...validated\n      };\n      v[type] = true;\n      setValidated(v); // var p = { ...page }\n      // if (type == \"interventions\") p[type] += 1\n      // if (type == \"equipements\") p[type] += 1\n      // setPage(p)\n\n      var c = { ...cycles\n      };\n      c[type].push(budgetSim[type]);\n      setCycles(c);\n      setChrono(null);\n    } else {\n      // RETOUR\n      console.log(\"clic retour vue \", type);\n      var c = { ...cycles\n      };\n\n      if (c[type] !== undefined) {\n        var bSim = { ...budgetSim\n        };\n        bSim[type] = c[type][c[type].length - 1];\n        console.log(bSim);\n        setBudgetSim(bSim);\n        c[type].pop();\n        setCycles(c);\n        var v = { ...validated\n        };\n        v[type] = false;\n        setValidated(v);\n      }\n    }\n  };\n\n  const nouveauTour = () => {\n    isLoading.current = true;\n\n    if (configuration != null) {\n      // if(bool){\n      console.log(\"save bdg fin\");\n      PlayAPI.saveBudgetsPompFin(cycles, session, equipe).then(res => {\n        let prochainPomp = 1;\n        let prochainTour = currentTour;\n        let prochainCycle = currentCycle;\n        let prochaineSequence = currentSequence;\n        let prochainChrono = configuration.chronoTourTact.valeur; // if(numPompier==configuration.nbPompEquipe.valeur){ // DERNIER POMP DU TOUR\n        //   if(currentTour==configu  ration.nbToursParCycle.valeur){ // SEND TO INTER\n        //     prochainTour = 1\n        //     prochainPomp=0 // A CHANGER AVEC STRATEGIQUE\n        //     if(prochainCycle==configuration.nbCyclesParSequence.valeur){\n        //       prochainCycle=1\n        //       prochaineSequence=prochaineSequence+1\n        //     }else{\n        //       prochainCycle=prochainCycle+1\n        //     }\n        //   }else{ // PAS DERNIER TOUR DU CYCLE\n        //     console.log(\"pas dernier tour\")\n        //     prochainPomp=1\n        //     prochainTour=prochainTour+1\n        //   }\n        // }\n\n        PlayAPI.nouveauTour(socket, prochainPomp, carte, mursH, mursV, prochaineSequence, prochainCycle, prochainTour, resultats.Decedes, resultats.Sauves, session, equipe, prochainChrono).then(() => {\n          console.log(\"nouveau tour\");\n          isLoading.current = false;\n        }); // }else{\n        //   // retourAction()\n        // }\n      });\n    }\n  };\n\n  const checkNouveauTour = () => {\n    console.log(\"check nv tour\");\n\n    if (validated.interventions && validated.equipements && numPompier == currentPomp) {\n      if (!isLoading.current) {\n        nouveauTour();\n      }\n    }\n  }; // SOCKETS\n\n\n  const [socket, setSocket] = useState(null);\n  useEffect(() => {\n    if (socket == null && configuration !== null) {\n      const s = io.connect(\"https://www.back.leaders-extreme.fr\");\n      setSocket(s);\n      s.on('changementTour', data => {\n        // console.log(currentPomp != data.currentPomp)\n        if (currentPomp != data.currentPomp || currentCycle !== data.currentCycle || currentTour !== data.currentTour || currentSequence !== data.currentSequence) {\n          getPlayState(session, equipe);\n        }\n      });\n      s.on('startStopPartie', data => {\n        //setPlay(data.start)\n        getPlayState(session, equipe);\n      }); // socket.on('revealHabitant',(data)=>{\n      //   if(carte!==null && carte.length>0){\n      //     // console.log(carte[data.y][data.x])\n      //     // console.log(carte[data.y])\n      //     if(carte[data.y][data.x]==20){\n      //       // console.log([data.y,data.x])\n      //       updateCarte([data.y,data.x],data.type)\n      //       // console.log(\"socket hab\")\n      //       // console.log(data)\n      //     }\n      //   }\n      // })\n    }\n  }, [socket, configuration]);\n\n  const handleViewChange = (event, newValue) => {\n    if (newValue != null) {\n      setVue(newValue);\n    }\n  };\n\n  const [textes, setTextes] = useState(null);\n  useEffect(() => {\n    const getTextes = async () => {\n      const textes = ContentsAPI.getTexts(\"jeuInterInterface\").then(res => {\n        setTextes(res);\n      });\n    };\n\n    if (textes == null) {\n      getTextes();\n    } // console.log(textes)\n\n  }, [textes]);\n\n  const getText = name => {\n    if (textes == null) {\n      return name;\n    } else {\n      try {\n        return textes[name].contenu;\n      } catch (error) {\n        // console.log(textes)\n        return name;\n      }\n    }\n  };\n\n  const renderAttenteLancement = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: \"gray\",\n        textAlign: \"center\",\n        fontSize: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        children: getText('attenteLancement')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 668,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        children: getText('infoLancement')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 669,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 667,\n      columnNumber: 7\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: \"absolute\",\n      display: \"flex\",\n      alignItems: \"center\",\n      flexDirection: \"column\",\n      justifyContent: \"center\",\n      flex: 1,\n      width: \"100%\",\n      height: \"100%\"\n    },\n    children: carte.length > 0 && position != null && configuration !== null && configuration !== undefined && budget != null && budget != undefined && couts !== null && couts != undefined && play ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        flex: 1,\n        width: \"100%\",\n        height: \"100%\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(InterBandeauTop // stocks={stocks}\n      , {\n        numeroPompier: numPompier,\n        numEquipe: equipe,\n        numSession: session,\n        sequence: currentSequence,\n        cycle: currentCycle,\n        tour: currentTour,\n        pomp: currentPomp,\n        configuration: configuration,\n        handleViewChange: handleViewChange,\n        vue: vue,\n        interventionsValidated: validated.interventions,\n        equipementsValidated: validated.equipements,\n        play: play,\n        handleClicValidated: handleClicValidated,\n        chronoInit: chrono,\n        validated: validated\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 682,\n        columnNumber: 9\n      }, this), vue == \"operations\" ? /*#__PURE__*/_jsxDEV(Grille, {\n        nbColonnesGrille: nbColonnesGrille,\n        nbLignesGrille: nbLignesGrille,\n        carte: carte,\n        position: position,\n        mursH: mursH,\n        mursV: mursV\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 703,\n        columnNumber: 13\n      }, this) : null, vue == \"interventions\" && cycles != null ? /*#__PURE__*/_jsxDEV(InterInterventions, {\n        budget: { ...budget.interventions\n        },\n        cycles: [...cycles.interventions],\n        handleBudgetChange: handleBudgetChange,\n        type: \"interventions\",\n        currentCycle: currentCycle,\n        currentSequence: currentSequence,\n        budgetSim: { ...budgetSim.interventions\n        },\n        couts: couts,\n        nbCycleParSeq: configuration !== null ? configuration.nbCyclesParSequence.valeur : 0,\n        configuration: configuration // page={page.interventions}\n\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 718,\n        columnNumber: 13\n      }, this) : null, vue == \"equipements\" && cycles != null ? /*#__PURE__*/_jsxDEV(InterInterventions, {\n        budget: { ...budget.equipements\n        },\n        cycles: [...cycles.equipements],\n        handleBudgetChange: handleBudgetChange,\n        type: \"equipements\",\n        currentCycle: currentCycle,\n        currentSequence: currentSequence,\n        budgetSim: { ...budgetSim.equipements\n        },\n        couts: couts,\n        nbCycleParSeq: configuration !== null ? configuration.nbCyclesParSequence.valeur : 0,\n        configuration: configuration // page={page.equipements}\n\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 737,\n        columnNumber: 13\n      }, this) : null, /*#__PURE__*/_jsxDEV(InterBandeauBottom, {\n        numeroPompier: numPompier,\n        tour: currentTour,\n        pomp: currentPomp,\n        resultats: resultats,\n        vue: vue,\n        couts: couts,\n        budget: vue === \"interventions\" ? budget.interventions : budget.equipements,\n        validated: validated,\n        handleClicValidated: handleClicValidated,\n        equipe: equipe\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 756,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(InterBandeauDroite, {\n        handleDisconnect: handleDisconnect,\n        configuration: configuration\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 768,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 681,\n      columnNumber: 7\n    }, this) : renderAttenteLancement()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 676,\n    columnNumber: 5\n  }, this);\n};\n\n_s(InterInterface, \"5RmgLLDh+jKIzkOWt433ucG8D1M=\", false, function () {\n  return [useHistory];\n});\n\n_c = InterInterface;\nexport default InterInterface;\n\nvar _c;\n\n$RefreshReg$(_c, \"InterInterface\");","map":{"version":3,"sources":["C:/Users/hugod/decitude/client/src/routes/InterInterface.js"],"names":["React","useState","useEffect","useRef","PlayAPI","InterBandeauTop","InterBandeauBottom","Grille","InterInterventions","useHistory","io","Typography","ContentsAPI","cookie","InterBandeauDroite","InterInterface","history","user","load","handleDisconnect","save","path","maxAge","push","undefined","role","includes","play","setPlay","numPompier","setNumPompier","currentPomp","setCurrentPomp","currentTour","setCurrentTour","currentCycle","setCurrentCycle","currentSequence","setCurrentSequence","session","setSession","equipe","setEquipe","chrono","setChrono","vue","setVue","configuration","setConfiguration","couts","setCouts","resultats","setResultats","Decedes","Sauves","Marqueur","budget","setBudget","sequence","depense","cycles","setCycles","interventions","coutInterDeplacement","valeur","coutInterDeplacementHab","coutInterFeu","coutInterFeuFum","coutInterFum","coutInterMarqueur","coutInterPorte","coutInterHab","coutInterHabitant","equipements","coutEqFeu","coutEqFeuFum","coutEqFum","coutEqMarqueur","budgetDefaultInter","initInfos","budgetSim","setBudgetSim","saveBudgetsPompInit","then","numCycle","length","numSeq","pomp1","pomp2","pomp3","pomp4","pomp5","pomp6","Feu","FeuFum","Fum","validated","setValidated","isLoading","carte","setCarte","nbLignesGrille","setNbLignesGrille","nbColonnesGrille","setNbColonnesGrille","position","setPosition","mursH","setMursH","mursV","setMursV","getNombreMarqueur","nbMarqueur","forEach","ligne","console","log","lastCycleEq","sort","a","b","lastCycleInter","val","getBudgetTot","getPlayState","current","currentPlayState","Object","keys","parseInt","JSON","parse","resultatsDecedes","resultatsSauves","budgetsPompInit","c","currrentChrono","chronoTourInter","getPlayParameters","param","getConfiguration","type","sum","key","values","v","handleBudgetChange","newBudget","bSim","checkNouveauTour","handleClicValidated","bool","pop","nouveauTour","saveBudgetsPompFin","res","prochainPomp","prochainTour","prochainCycle","prochaineSequence","prochainChrono","chronoTourTact","socket","setSocket","s","connect","on","data","handleViewChange","event","newValue","textes","setTextes","getTextes","getTexts","getText","name","contenu","error","renderAttenteLancement","color","textAlign","fontSize","display","alignItems","flexDirection","justifyContent","flex","width","height","nbCyclesParSequence"],"mappings":"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","sourcesContent":["import \"../styles/App.css\"\r\nimport React, { useState, useEffect, useRef } from 'react'\r\nimport PlayAPI from \"../API/PlayAPI\"\r\nimport InterBandeauTop from \"../components/interfaceJoueur/InterBandeauTop\"\r\nimport InterBandeauBottom from \"../components/interfaceJoueur/InterBandeauBottom\"\r\nimport Grille from \"../components/interfaceJoueur/Grille\"\r\nimport InterInterventions from \"../components/interfaceJoueur/InterInterventions\"\r\nimport { useHistory } from 'react-router-dom';\r\nimport io from 'socket.io-client'\r\nimport { Typography } from \"@material-ui/core\"\r\nimport ContentsAPI from \"../API/ContentsAPI\"\r\nimport cookie from 'react-cookies'\r\nimport InterBandeauDroite from \"../components/interfaceJoueur/InterBandeauDroite\"\r\n\r\n\r\nconst InterInterface = () => {\r\n\r\n  const history = useHistory()\r\n\r\n  const user = cookie.load(\"user\")\r\n  const handleDisconnect = () => {\r\n    cookie.save('user', \"disconnected\", {\r\n      path: '/',\r\n      maxAge: 60 * 60 * 1.5, //sec\r\n    })\r\n    history.push('/login');\r\n  }\r\n\r\n  if (user === null || user === undefined || user==\"disconnected\") history.push(\"/login\");\r\n  if(user !== null && user !== undefined && user.role!==undefined && !user.role.includes(\"INTER\")) handleDisconnect()\r\n  const [play,setPlay]=useState(false)\r\n\r\n\r\n  const [numPompier, setNumPompier] = useState(0)\r\n  const [currentPomp, setCurrentPomp] = useState(null)\r\n  const [currentTour, setCurrentTour] = useState(null)\r\n  const [currentCycle, setCurrentCycle] = useState(null)\r\n  const [currentSequence, setCurrentSequence] = useState(null)\r\n\r\n  const [session, setSession] = useState(user !== null && user !== undefined ? user.session : null)\r\n  const [equipe, setEquipe] = useState(user !== null && user !== undefined ?  user.equipe : null)\r\n  const [chrono, setChrono]=useState(null)\r\n  const [vue, setVue] = useState(\"operations\")\r\n\r\n\r\n\r\n  const [configuration, setConfiguration] = useState(null)\r\n\r\n\r\n\r\n  const [couts, setCouts] = useState(null)\r\n\r\n\r\n\r\n  const [resultats, setResultats] = useState({\r\n    Decedes: 0,\r\n    Sauves: 0,\r\n    Marqueur: 0\r\n  })\r\n\r\n\r\n  const [budget, setBudget] = useState({\r\n    sequence: 0,\r\n    depense: 0\r\n  })\r\n\r\n\r\n  const [cycles, setCycles] = useState(null)\r\n\r\n  useEffect(() => {\r\n\r\n    if (configuration != null) {\r\n\r\n      setCouts({\r\n        interventions: {\r\n          coutInterDeplacement: configuration.coutInterDeplacement.valeur,\r\n          coutInterDeplacementHab: configuration.coutInterDeplacementHab.valeur,\r\n          coutInterFeu: configuration.coutInterFeu.valeur,\r\n          coutInterFeuFum: configuration.coutInterFeuFum.valeur,\r\n          coutInterFum: configuration.coutInterFum.valeur,\r\n          coutInterMarqueur: configuration.coutInterMarqueur.valeur,\r\n          coutInterPorte: configuration.coutInterPorte.valeur,\r\n          coutInterHab: configuration.coutInterHabitant.valeur,\r\n        },\r\n        equipements: {\r\n          coutEqFeu: configuration.coutEqFeu.valeur,\r\n          coutEqFeuFum: configuration.coutEqFeuFum.valeur,\r\n          coutEqFum: configuration.coutEqFum.valeur,\r\n          coutEqMarqueur: configuration.coutEqMarqueur.valeur,\r\n\r\n        }\r\n      })\r\n      setBudget({\r\n        interventions:{\r\n          sequence: configuration.budgetDefaultInter.valeur,\r\n          depense: 0\r\n        },\r\n        equipements:{\r\n          sequence: configuration.budgetDefaultInter.valeur,\r\n          depense: 0\r\n        }\r\n        \r\n      })\r\n\r\n      if (cycles != null) {\r\n        initInfos(cycles)\r\n      }\r\n\r\n    }\r\n  }, [configuration])\r\n\r\n\r\n\r\n  const [budgetSim, setBudgetSim] = useState(null)\r\n\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    if (cycles != null) {\r\n      // console.log(\"save bdg init\")\r\n      PlayAPI.saveBudgetsPompInit(cycles, session, equipe).then(()=>{\r\n        if (configuration != null) {\r\n          initInfos(cycles)\r\n        }\r\n  \r\n        if(budgetSim==null || budgetSim.interventions==undefined || budgetSim.interventions.numCycle!==(cycles.interventions.length) % 2 + 1 || budgetSim.equipements.numCycle!==(cycles.equipements.length) % 2 + 1){\r\n          setBudgetSim({\r\n            interventions: {\r\n              numSeq: cycles.interventions.length > 1 ? cycles.interventions.length % 2 == 0 ? cycles.interventions[cycles.interventions.length - 1].numSeq + 1 : cycles.interventions[cycles.interventions.length - 1].numSeq : 1,\r\n              numCycle: (cycles.interventions.length) % 2 + 1,\r\n              pomp1: 0,\r\n              pomp2: 0,\r\n              pomp3: 0,\r\n              pomp4: 0,\r\n              pomp5: 0,\r\n              pomp6: 0,\r\n            },\r\n            equipements: {\r\n              numSeq: cycles.equipements.length > 1 ? cycles.equipements.length % 2 == 0 ? cycles.equipements[cycles.equipements.length - 1].numSeq + 1 : cycles.equipements[cycles.equipements.length - 1].numSeq : 1,\r\n              numCycle: (cycles.equipements.length) % 2 + 1,\r\n              Feu: {\r\n                pomp1: 0,\r\n                pomp2: 0,\r\n                pomp3: 0,\r\n                pomp4: 0,\r\n                pomp5: 0,\r\n                pomp6: 0,\r\n              },\r\n              FeuFum: {\r\n                pomp1: 0,\r\n                pomp2: 0,\r\n                pomp3: 0,\r\n                pomp4: 0,\r\n                pomp5: 0,\r\n                pomp6: 0,\r\n              },\r\n              Fum: {\r\n                pomp1: 0,\r\n                pomp2: 0,\r\n                pomp3: 0,\r\n                pomp4: 0,\r\n                pomp5: 0,\r\n                pomp6: 0\r\n              },\r\n              Marqueur: {\r\n                pomp1: 0,\r\n                pomp2: 0,\r\n                pomp3: 0,\r\n                pomp4: 0,\r\n                pomp5: 0,\r\n                pomp6: 0,\r\n              },\r\n            },\r\n          })\r\n      }\r\n    })\r\n    }\r\n\r\n\r\n    // console.log(cycles.equipements)\r\n  }, [cycles])\r\n\r\n  const [validated, setValidated] = useState({\r\n    interventions:false,\r\n    equipements:false\r\n    \r\n  })\r\n  // const [page, setPage] = useState({\r\n  //   interventions: 0,\r\n  //   equipements: 0\r\n  // })\r\n\r\n\r\n\r\n  const isLoading = useRef(false)\r\n\r\n  // INITIALISATION DE LA CARTE\r\n\r\n  const [carte, setCarte] = useState([\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n  ])\r\n\r\n  // const [carte, setCarte] = useState([])\r\n\r\n  const [nbLignesGrille, setNbLignesGrille] = useState(0)\r\n  const [nbColonnesGrille, setNbColonnesGrille] = useState(0)\r\n  const [position, setPosition] = useState(null)\r\n\r\n\r\n  const [mursH, setMursH] = useState([\r\n    [1, 1, 1, 1, 1, 1, 2, 6, 1, 1, 1, 1, 2, 5, 1, 1],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [1, 1, 1, 1, 2, 6, 1, 6, 2, 1, 1, 1, 5, 2, 1, 1],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [1, 1, 1, 1, 1, 1, 6, 2, 1, 1, 1, 1, 1, 1, 1, 1]\r\n  ])\r\n\r\n  const [mursV, setMursV] = useState([\r\n    [1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    [2, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    [5, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 2],\r\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 5]\r\n  ])\r\n\r\n\r\n  const getNombreMarqueur = (mursH, mursV) => {\r\n    let nbMarqueur = 0\r\n    mursH.forEach(ligne => {\r\n      ligne.forEach(valeur => {\r\n        if (valeur == 3) nbMarqueur = nbMarqueur + 1\r\n        if (valeur == 4) nbMarqueur = nbMarqueur + 2\r\n      })\r\n    })\r\n    mursV.forEach(ligne => {\r\n      ligne.forEach(valeur => {\r\n        if (valeur == 3) nbMarqueur = nbMarqueur + 1\r\n        if (valeur == 4) nbMarqueur = nbMarqueur + 2\r\n      })\r\n    })\r\n    return nbMarqueur\r\n  }\r\n\r\n  // GET PLAY PARAMETERS \r\n\r\n\r\n\r\n  const initInfos = (cycles) => {\r\n    if (cycles !== null && configuration !== null) {\r\n      console.log(\"init infos\")\r\n      const lastCycleEq = [...cycles.equipements].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.equipements].length - 1]\r\n      const lastCycleInter = [...cycles.interventions].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.interventions].length - 1]\r\n\r\n      var val = {\r\n        interventions: false,\r\n        equipements: false\r\n      }\r\n\r\n      if (lastCycleInter !== null && lastCycleInter !== undefined && lastCycleInter.numSeq == currentSequence && lastCycleInter.numCycle == currentCycle) val.interventions = true\r\n      if (lastCycleEq !== null && lastCycleEq !== undefined && lastCycleEq.numSeq == currentSequence && lastCycleEq.numCycle == currentCycle) val.equipements = true\r\n      setValidated(val)\r\n\r\n      var b = {\r\n        interventions:{\r\n          sequence: configuration.budgetDefaultInter.valeur,\r\n          depense: getBudgetTot(budgetSim,\"interventions\")\r\n        },\r\n        equipements:{\r\n          sequence: configuration.budgetDefaultInter.valeur,\r\n          depense: getBudgetTot(budgetSim,\"equipements\")\r\n        }\r\n        \r\n      }\r\n\r\n\r\n      setBudget(b)\r\n    }\r\n\r\n  }\r\n\r\n  useEffect(() => {\r\n    initInfos(cycles)\r\n  }, [couts])\r\n\r\n\r\n  // useEffect(()=>{\r\n  //   console.log(chrono)\r\n  // },[chrono])\r\n\r\n\r\n\r\n  const getPlayState = async (session, equipe) => {\r\n    \r\n    if (!isLoading.current && configuration != null) {\r\n      \r\n      isLoading.current = true\r\n      console.log(\"getplaystate\")\r\n      const currentPlayState = await PlayAPI.getPlayState(session, equipe)\r\n      console.log(currentPlayState)\r\n      if (Object.keys(currentPlayState).length > 0) {\r\n\r\n        // console.log(currentPlayState)\r\n        setCurrentPomp(parseInt(JSON.parse(currentPlayState.currentPomp.valeur)))\r\n        setCurrentTour(parseInt(JSON.parse(currentPlayState.currentTour.valeur)))\r\n        setCurrentCycle(parseInt(JSON.parse(currentPlayState.currentCycle.valeur)))\r\n        setCurrentSequence(parseInt(JSON.parse(currentPlayState.currentSequence.valeur)))\r\n        const mursH = JSON.parse(currentPlayState.mursH.valeur)\r\n        const mursV = JSON.parse(currentPlayState.mursV.valeur)\r\n        setPlay(JSON.parse(currentPlayState.play.valeur))\r\n        setMursH(mursH)\r\n        setMursV(mursV)\r\n        setCarte(JSON.parse(currentPlayState.carte.valeur))\r\n        setResultats({\r\n          Decedes: parseInt(JSON.parse(currentPlayState.resultatsDecedes.valeur)),\r\n          Sauves: parseInt(JSON.parse(currentPlayState.resultatsSauves.valeur)),\r\n          Marqueur: getNombreMarqueur(mursH, mursV)\r\n        })\r\n        setCycles(JSON.parse(currentPlayState.budgetsPompInit.valeur))\r\n        const c = parseInt(JSON.parse(currentPlayState.currrentChrono.valeur))\r\n        if (configuration !== null && c <= configuration.chronoTourInter.valeur && parseInt(JSON.parse(currentPlayState.currentPomp.valeur)) == numPompier) {\r\n          setChrono(c)\r\n        } else {\r\n          setChrono(null)\r\n          // console.log(\"chrono\")\r\n        }\r\n        \r\n        setPlay(JSON.parse(currentPlayState.play.valeur))\r\n      }else{\r\n        console.log(\"error\")\r\n      }\r\n      // getPositionFromCarte(JSON.parse(currentPlayState.carte.valeur))\r\n      isLoading.current = false\r\n    }else{\r\n      console.log(configuration)\r\n    }\r\n\r\n  }\r\n\r\n  // useEffect(()=>{\r\n  //   console.log(currentPomp)\r\n  // },[currentPomp])\r\n\r\n\r\n  useEffect(() => {\r\n    // console.log(carte)\r\n    if (carte.length > 0) {\r\n      setNbLignesGrille(carte.length)\r\n      setNbColonnesGrille(carte[0].length)\r\n      setPosition([carte.length + 1, carte[0].length + 1])\r\n    }\r\n\r\n  }, [carte])\r\n\r\n  useEffect(()=>{\r\n    console.log(configuration)\r\n  },[configuration])\r\n  useEffect(() => {\r\n    if(configuration===null) getPlayParameters()\r\n    if (session != null && equipe != null && currentTour == null) {\r\n      \r\n      if (!isLoading.current && configuration!==null) getPlayState(session, equipe)\r\n      \r\n      // getPositionFromCarte()\r\n    }\r\n  }, [session, equipe, numPompier,configuration])\r\n\r\n  const getPlayParameters = async () => {\r\n    console.log(\"getPlay Parameters\")\r\n    const param =await PlayAPI.getConfiguration(session)\r\n    setConfiguration(param)\r\n    console.log(param)\r\n  }\r\n\r\n\r\n\r\n\r\n  const getBudgetTot = (budgetSim,type) => {\r\n    let sum = 0\r\n\r\n    if (couts !== null) {\r\n\r\n\r\n      if(type==\"interventions\"){\r\n        // if (budgetSim !== null && budgetSim !== undefined) {\r\n        //   const lastCycleInter = [...cycles.interventions].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.interventions].length - 1]\r\n        //   if (budgetSim.interventions.numSeq == currentSequence && budgetSim.interventions.numCycle > currentCycle || lastCycleInter === undefined) {\r\n        //     Object.keys(budgetSim.interventions).forEach((key) => {\r\n        //       if (key != \"numCycle\" && key != \"numSeq\") {\r\n        //         console.log(\"test\")\r\n        //         sum += budgetSim.interventions[key]\r\n        //       }\r\n        //     })\r\n        //   }\r\n\r\n\r\n          \r\n        // }\r\n        cycles.interventions.forEach((c) => {\r\n          if (c.numSeq == currentSequence) {\r\n            Object.keys(c).forEach((key) => {\r\n              if (key != \"numCycle\" && key != \"numSeq\") {\r\n                // console.log(c[key])\r\n                sum += c[key]\r\n              }\r\n            })\r\n          }\r\n        })\r\n      }else{\r\n\r\n\r\n        const lastCycleEq = [...cycles.equipements].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.equipements].length - 1]\r\n      \r\n\r\n        // if (budgetSim.equipements.numSeq == currentSequence && budgetSim.equipements.numCycle > currentCycle || lastCycleEq === undefined) {\r\n        //   Object.keys(budgetSim.equipements).forEach((key) => {\r\n        //     if (key != \"numCycle\" && key != \"numSeq\") {\r\n        //       Object.values(budgetSim.equipements[key]).forEach(value => {\r\n        //         sum += value * couts.equipements[\"coutEq\" + key]\r\n        //       })\r\n        //     }\r\n        //   })\r\n        // }\r\n\r\n        cycles.equipements.forEach((c) => {\r\n          if (c.numSeq == currentSequence) {\r\n            Object.keys(c).forEach((key) => {\r\n              if (key != \"numCycle\" && key != \"numSeq\") {\r\n                Object.values(c[key]).forEach((v) => {\r\n                  sum += couts.equipements[\"coutEq\" + key] * v\r\n                })\r\n              }\r\n  \r\n            })\r\n          }\r\n\r\n      \r\n        })\r\n\r\n      }\r\n\r\n    }\r\n    return sum\r\n  }\r\n  // useEffect(()=>{\r\n  //   if(budgetSim!==null){\r\n  //     console.log(budgetSim.interventions)\r\n  //   }\r\n    \r\n  // },[budgetSim])\r\n\r\n\r\n  const handleBudgetChange = (type, newBudget) => {\r\n    var bSim = { ...budgetSim }\r\n    bSim[type] = newBudget\r\n    setBudgetSim(bSim)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if(validated.interventions && validated.equipements && numPompier == currentPomp) checkNouveauTour()\r\n  },[validated,vue])\r\n\r\n  const handleClicValidated = (type,bool) => {\r\n    if(bool){\r\n      var v = { ...validated }\r\n      v[type] = true\r\n      setValidated(v)\r\n  \r\n      // var p = { ...page }\r\n      // if (type == \"interventions\") p[type] += 1\r\n      // if (type == \"equipements\") p[type] += 1\r\n      // setPage(p)\r\n  \r\n      var c = { ...cycles }\r\n      c[type].push(budgetSim[type])\r\n      setCycles(c)\r\n      setChrono(null)\r\n    }else{ // RETOUR\r\n      console.log(\"clic retour vue \",type)\r\n\r\n      var c = {...cycles}\r\n      if(c[type]!==undefined){\r\n        var bSim = {...budgetSim}\r\n        bSim[type]=c[type][c[type].length-1]\r\n        console.log(bSim)\r\n        setBudgetSim(bSim)\r\n        c[type].pop()\r\n        setCycles(c)\r\n  \r\n  \r\n        var v = { ...validated }\r\n        v[type] = false\r\n        setValidated(v)\r\n      }\r\n      \r\n    }\r\n  }\r\n\r\n\r\n\r\n  const nouveauTour =  () => {\r\n    isLoading.current=true\r\n    if (configuration != null) {\r\n      // if(bool){\r\n      console.log(\"save bdg fin\")\r\n      PlayAPI.saveBudgetsPompFin(cycles, session, equipe).then((res)=>{\r\n        let prochainPomp = 1\r\n        let prochainTour = currentTour\r\n        let prochainCycle = currentCycle\r\n        let prochaineSequence = currentSequence\r\n        let prochainChrono = configuration.chronoTourTact.valeur\r\n  \r\n  \r\n  \r\n        // if(numPompier==configuration.nbPompEquipe.valeur){ // DERNIER POMP DU TOUR\r\n        //   if(currentTour==configu  ration.nbToursParCycle.valeur){ // SEND TO INTER\r\n        //     prochainTour = 1\r\n        //     prochainPomp=0 // A CHANGER AVEC STRATEGIQUE\r\n  \r\n        //     if(prochainCycle==configuration.nbCyclesParSequence.valeur){\r\n        //       prochainCycle=1\r\n        //       prochaineSequence=prochaineSequence+1\r\n        //     }else{\r\n        //       prochainCycle=prochainCycle+1\r\n        //     }\r\n  \r\n  \r\n        //   }else{ // PAS DERNIER TOUR DU CYCLE\r\n        //     console.log(\"pas dernier tour\")\r\n        //     prochainPomp=1\r\n        //     prochainTour=prochainTour+1\r\n  \r\n  \r\n        //   }\r\n  \r\n        // }\r\n        \r\n         PlayAPI.nouveauTour(socket,prochainPomp, carte, mursH, mursV, prochaineSequence, prochainCycle, prochainTour, resultats.Decedes, resultats.Sauves, session, equipe,prochainChrono).then(()=>{\r\n          console.log(\"nouveau tour\")\r\n          isLoading.current=false\r\n         })\r\n        \r\n         \r\n        \r\n        // }else{\r\n        //   // retourAction()\r\n        // }\r\n      })\r\n      \r\n         \r\n        \r\n      \r\n\r\n     \r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  const checkNouveauTour =  () => {\r\n    console.log(\"check nv tour\")\r\n    if (validated.interventions && validated.equipements && numPompier == currentPomp) {\r\n      if(!isLoading.current){\r\n        nouveauTour()\r\n      }\r\n      \r\n    }\r\n  }\r\n\r\n  // SOCKETS\r\n  const [socket, setSocket] = useState(null)\r\n  useEffect(() => {\r\n    if (socket == null && configuration!==null) {\r\n      const s = io.connect(\"https://www.back.leaders-extreme.fr\")\r\n      setSocket(s)\r\n      s.on('changementTour', (data) => {\r\n\r\n      \r\n      // console.log(currentPomp != data.currentPomp)\r\n      if (currentPomp != data.currentPomp || currentCycle !== data.currentCycle || currentTour !== data.currentTour || currentSequence !== data.currentSequence) {        \r\n\r\n        getPlayState(session, equipe)\r\n      }\r\n\r\n\r\n\r\n    })\r\n\r\n    s.on('startStopPartie', (data) => {\r\n      //setPlay(data.start)\r\n      getPlayState(session, equipe)\r\n    });\r\n\r\n    // socket.on('revealHabitant',(data)=>{\r\n    //   if(carte!==null && carte.length>0){\r\n    //     // console.log(carte[data.y][data.x])\r\n    //     // console.log(carte[data.y])\r\n    //     if(carte[data.y][data.x]==20){\r\n    //       // console.log([data.y,data.x])\r\n    //       updateCarte([data.y,data.x],data.type)\r\n    //       // console.log(\"socket hab\")\r\n    //       // console.log(data)\r\n    //     }\r\n    //   }\r\n    // })\r\n  }\r\n  },[socket,configuration]);\r\n\r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\n  const handleViewChange = (event, newValue) => {\r\n    if (newValue != null) {\r\n      setVue(newValue)\r\n    }\r\n  }\r\n\r\n  \r\n  const [textes, setTextes] = useState(null)\r\n\r\n  useEffect(() => {\r\n    const getTextes = async () => {\r\n      const textes = ContentsAPI.getTexts(\"jeuInterInterface\").then(\r\n        (res) => { setTextes(res) }\r\n      )\r\n    }\r\n    if (textes == null) {\r\n      getTextes()\r\n    }\r\n    // console.log(textes)\r\n  }, [textes])\r\n\r\n  const getText = (name) => {\r\n    if (textes == null) {\r\n      return name\r\n    } else {\r\n      try {\r\n        return textes[name].contenu\r\n      } catch (error) {\r\n        // console.log(textes)\r\n        return name\r\n      }\r\n    }\r\n  }\r\n  const renderAttenteLancement = () => {\r\n\r\n    return (\r\n      <div style={{ color: \"gray\", textAlign: \"center\", fontSize: 20 }}>\r\n        <Typography >{getText('attenteLancement')}</Typography>\r\n        <Typography >{getText('infoLancement')}</Typography>\r\n      </div>\r\n    )\r\n  }\r\n\r\n\r\n  return (\r\n    <div style={{ position: \"absolute\", display: \"flex\", alignItems: \"center\", flexDirection: \"column\", justifyContent: \"center\", flex: 1, width: \"100%\", height: \"100%\" }}>\r\n\r\n    {\r\n    carte.length > 0 && position != null && configuration !== null && configuration !== undefined && budget != null && budget != undefined && couts!==null && couts!=undefined && play?\r\n\r\n      <div style={{ position: \"absolute\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\", flex: 1, width: \"100%\", height: \"100%\" }}>\r\n        <InterBandeauTop\r\n          // stocks={stocks}\r\n          numeroPompier={numPompier}\r\n          numEquipe={equipe}\r\n          numSession={session}\r\n          sequence={currentSequence}\r\n          cycle={currentCycle}\r\n          tour={currentTour}\r\n          pomp={currentPomp}\r\n          configuration={configuration}\r\n          handleViewChange={handleViewChange}\r\n          vue={vue}\r\n          interventionsValidated={validated.interventions}\r\n          equipementsValidated={validated.equipements}\r\n          play={play}\r\n          handleClicValidated={handleClicValidated}\r\n          chronoInit={chrono}\r\n          validated={validated}\r\n        />\r\n        {\r\n          vue == \"operations\" ?\r\n            <Grille\r\n              nbColonnesGrille={nbColonnesGrille}\r\n              nbLignesGrille={nbLignesGrille}\r\n              carte={carte}\r\n              position={position}\r\n              mursH={mursH}\r\n              mursV={mursV}\r\n            />\r\n            : null\r\n        }\r\n\r\n\r\n        {\r\n          vue == \"interventions\" && cycles != null ?\r\n\r\n            <InterInterventions\r\n              budget={{...budget.interventions}}\r\n              cycles={[...cycles.interventions]}\r\n              handleBudgetChange={handleBudgetChange}\r\n              type=\"interventions\"\r\n              currentCycle={currentCycle}\r\n              currentSequence={currentSequence}\r\n              budgetSim={{ ...budgetSim.interventions }}\r\n              couts={couts}\r\n              nbCycleParSeq={configuration !== null ? configuration.nbCyclesParSequence.valeur : 0}\r\n              configuration={configuration}\r\n            // page={page.interventions}\r\n            />\r\n            : null\r\n        }\r\n\r\n        {\r\n          vue == \"equipements\" && cycles != null ?\r\n\r\n            <InterInterventions\r\n              budget={{...budget.equipements}}\r\n              cycles={[...cycles.equipements]}\r\n              handleBudgetChange={handleBudgetChange}\r\n              type=\"equipements\"\r\n              currentCycle={currentCycle}\r\n              currentSequence={currentSequence}\r\n              budgetSim={{ ...budgetSim.equipements }}\r\n              couts={couts}\r\n              nbCycleParSeq={configuration !== null ? configuration.nbCyclesParSequence.valeur : 0}\r\n              configuration={configuration}\r\n            // page={page.equipements}\r\n            />\r\n            : null\r\n        }\r\n\r\n\r\n\r\n\r\n        <InterBandeauBottom\r\n          numeroPompier={numPompier}\r\n          tour={currentTour}\r\n          pomp={currentPomp}\r\n          resultats={resultats}\r\n          vue={vue}\r\n          couts={couts}\r\n          budget={vue === \"interventions\" ? budget.interventions : budget.equipements}\r\n          validated={validated}\r\n          handleClicValidated={handleClicValidated}\r\n          equipe={equipe}\r\n        />\r\n        <InterBandeauDroite\r\n          handleDisconnect={handleDisconnect}\r\n          configuration={configuration}\r\n        />\r\n      </div>\r\n      \r\n\r\n      :\r\n      renderAttenteLancement()\r\n\r\n      }\r\n      </div>\r\n\r\n  );\r\n\r\n}\r\n\r\nexport default InterInterface;\r\n\r\n"]},"metadata":{},"sourceType":"module"}