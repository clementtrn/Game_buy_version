{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import CaseDonnee from'./panels/CaseDonnee';import\"../../styles/TactBandeauTop.css\";import BookmarkRoundedIcon from'@material-ui/icons/BookmarkRounded';import Typography from'@material-ui/core/Typography';import Grid from'@material-ui/core/Grid';import PlayAPI from\"../../API/PlayAPI\";import ContentsAPI from\"../../API/ContentsAPI\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TactBandeauTop=function TactBandeauTop(_ref){var numeroPompier=_ref.numeroPompier,sequence=_ref.sequence,numEquipe=_ref.numEquipe,numSession=_ref.numSession,cycle=_ref.cycle,tour=_ref.tour,pomp=_ref.pomp,stocks=_ref.stocks,resultats=_ref.resultats,configuration=_ref.configuration,budget=_ref.budget,equipe=_ref.equipe,handleClicValidated=_ref.handleClicValidated,play=_ref.play,chronoInit=_ref.chronoInit,budgetDepense=_ref.budgetDepense;console.log(chronoInit);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),textes=_useState2[0],setTextes=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),chrono=_useState4[0],setChrono=_useState4[1];useEffect(function(){if(pomp==numeroPompier&&chrono!==null&&play&&chrono>=0){if(chrono>0){var chronoTimer=setInterval(function(){if(chrono%30==0&&chrono>10)PlayAPI.updateCurrentChrono(chrono,numSession,numEquipe);setChrono(function(chrono){return chrono-1;});},1000);}else{// clearInterval(chronoTimer)\n// console.log(\"handle\")\nif(chrono==0){handleClicValidated(true);setChrono(-1);}}}else{if(configuration!==null){if(chronoInit==null||chrono==-1){setChrono(-1);}else{setChrono(chronoInit);}}}return function(){clearInterval(chronoTimer);};},[chrono]);useEffect(function(){if(chronoInit!==null&&(chrono>=chronoInit||chrono==-1)&&configuration!==null){setChrono(chronoInit);}});useEffect(function(){console.log(chrono);},[chrono]);// useEffect(() => {\n//     // console.log(configuration.chronoTour.valeur)\n//     if (chrono === null && configuration !== null) {\n//         // setChrono(chronoInit)\n//     }\n// })\nuseEffect(function(){// console.log(\"use effect\")\nvar getTextes=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var textes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:textes=ContentsAPI.getTexts(\"jeuTactBandeauTop\").then(function(res){setTextes(res);});case 1:case\"end\":return _context.stop();}}},_callee);}));return function getTextes(){return _ref2.apply(this,arguments);};}();if(textes==null){getTextes();}},[textes]);var getText=function getText(name){if(textes==null){return name;}else{try{return textes[\"label\"+name.charAt(0).toUpperCase()+name.slice(1)].contenu;}catch(error){console.log(\"label\"+name.charAt(0).toUpperCase()+name.slice(1));return name;}}};var renderStocks=function renderStocks(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel donnees-container\",style:{flex:3},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"stockEquipements\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"sous-donnees-container\",children:[/*#__PURE__*/_jsx(CaseDonnee,{name:\"nbExtFeu\",value:stocks.Feu,primary:false,flexFactor:1,textes:textes},0),/*#__PURE__*/_jsx(CaseDonnee,{name:\"nbExtFum\",value:stocks.Fum,primary:false,flexFactor:1,textes:textes},1)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sous-donnees-container\",children:[/*#__PURE__*/_jsx(CaseDonnee,{name:\"nbExtFeuFum\",value:stocks.FeuFum,primary:false,flexFactor:2,textes:textes},2),/*#__PURE__*/_jsx(CaseDonnee,{name:\"nbMarqueurs\",value:stocks.Marqueur,primary:false,flexFactor:2,textes:textes},3)]})]});};var renderResults=function renderResults(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel donnees-container\",style:{flex:2},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"resultats\")+\" \"+equipe}),/*#__PURE__*/_jsx(CaseDonnee,{name:getText(\"nbDecedes\"),value:resultats.Decedes,primary:false,flexFactor:0},4),/*#__PURE__*/_jsx(CaseDonnee,{name:getText(\"nbSauves\"),value:resultats.Sauves,primary:false,flexFactor:0},5)]});};var renderNumPompier=function renderNumPompier(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"numPompier\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"donnees-container\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title label-num-pompier\",children:numeroPompier}),/*#__PURE__*/_jsx(BookmarkRoundedIcon,{className:\"icone-num-pompier\",fontSize:\"large\",stroke:\"white\",strokeWidth:1})]})]});};var renderCircleTours=function renderCircleTours(){var type=1,//circle type - 1 whole, 0.5 half, 0.25 quarter\nradius=20,//distance from center\nstart=-90,//shift start from 0\n// $elements = $('li:not(:first-child)'),\nnumberOfElements=configuration.nbPompEquipe.valeur,slice=360*type/numberOfElements;var renderCircleItems=function renderCircleItems(){var items=[];var decalage=1.2;// items.push(\n//     <li\n//         key={\"c\"}\n//         style={{\n//             'transform': 'translate(' + (-radius*decalage*2) + 'px,'+ (-radius*decalage) +'px)',\n//             \"backgroundColor\": tour==-1 ? \"#BF0000\" : null\n//         }}\n//     >\n//         {\"C\"}\n//     </li>\n// )\nitems.push(/*#__PURE__*/_jsx(\"li\",{style:{'transform':'translate('+radius*decalage+'px,'+-radius*decalage+'px)',\"backgroundColor\":pomp==0?\"#BF0000\":null},children:\"S\"},\"s\"));for(var i=0;i<numberOfElements;i++){var rotate=slice*i+start;var rotateReverse=rotate*-1;var decalageCircle=10;items.push(/*#__PURE__*/_jsx(\"li\",{style:{'transform':'rotate('+rotate+'deg) translate('+radius+'px) rotate('+rotateReverse+'deg) translate('+-radius/2+'px) translateY('+decalageCircle+'px)',\"backgroundColor\":i+1==pomp?\"#BF0000\":null},children:i+1},i));}return items;};return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"tourParTour\")}),/*#__PURE__*/_jsx(\"ul\",{children:renderCircleItems()})]});};var renderFeu=function renderFeu(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"play\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"donnees-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"feu\",children:[/*#__PURE__*/_jsx(\"div\",{className:chrono<30&&chrono>0?\"clignotant animation-reverted\":\"\",style:{backgroundColor:numeroPompier!=pomp?\"#ff0000\":chrono>=0&&chrono<30?\"#E26F00\":\"#9F9F9F\"}}),/*#__PURE__*/_jsx(\"div\",{className:chrono<30&&chrono>0?\"clignotant\":\"\",style:{backgroundColor:numeroPompier==pomp?chrono>=0&&chrono<30?\"#E26F00\":\"#4dff4d\":\"#9F9F9F\"}})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"case-value\",style:{marginTop:\"10%\",width:\"100%\",maxWidth:\"100%\"},children:[Math.floor((chrono>=0?chrono:configuration.chronoTour.valeur)/60).toString().padStart(2,\"0\")+\" : \",/*#__PURE__*/_jsxs(\"span\",{style:{color:chrono<=30&&chrono>0?\"red\":\"inherit\",marginLeft:5},children:[\" \",\" \"+((chrono>=0?chrono:configuration.chronoTour.valeur)%60).toString().padStart(2,\"0\"),\" \"]})]})]})]});};return configuration!=null?/*#__PURE__*/_jsx(\"div\",{className:\"bandeau-top\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cases-container\",children:[/*#__PURE__*/_jsx(CaseDonnee,{name:\"sequence\",value:sequence,primary:true,flexFactor:1,textes:textes,data:configuration.nbSequences.valeur}),/*#__PURE__*/_jsx(CaseDonnee,{name:\"cycle\",value:cycle,primary:true,flexFactor:1,textes:textes,data:configuration.nbCyclesParSequence.valeur}),/*#__PURE__*/_jsx(CaseDonnee,{name:\"tour\",value:tour,primary:true,flexFactor:1,textes:textes,data:configuration.nbToursParCycle.valeur}),/*#__PURE__*/_jsx(CaseDonnee,{name:\"budgetRestant\",value:budget+\" â‚¬\",primary:true,flexFactor:1,textes:textes,data:budgetDepense>=configuration.budgetTourMax.valeur}),renderStocks(),renderResults(),renderCircleTours(),renderNumPompier(),renderFeu()]})}):null;};export default TactBandeauTop;","map":{"version":3,"sources":["C:/Users/hugod/decitude/client/src/components/interfaceJoueur/TactBandeauTop.js"],"names":["React","useState","useEffect","CaseDonnee","BookmarkRoundedIcon","Typography","Grid","PlayAPI","ContentsAPI","TactBandeauTop","numeroPompier","sequence","numEquipe","numSession","cycle","tour","pomp","stocks","resultats","configuration","budget","equipe","handleClicValidated","play","chronoInit","budgetDepense","console","log","textes","setTextes","chrono","setChrono","chronoTimer","setInterval","updateCurrentChrono","clearInterval","getTextes","getTexts","then","res","getText","name","charAt","toUpperCase","slice","contenu","error","renderStocks","flex","Feu","Fum","FeuFum","Marqueur","renderResults","Decedes","Sauves","renderNumPompier","renderCircleTours","type","radius","start","numberOfElements","nbPompEquipe","valeur","renderCircleItems","items","decalage","push","i","rotate","rotateReverse","decalageCircle","renderFeu","backgroundColor","marginTop","width","maxWidth","Math","floor","chronoTour","toString","padStart","color","marginLeft","nbSequences","nbCyclesParSequence","nbToursParCycle","budgetTourMax"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport CaseDonnee from './panels/CaseDonnee'\r\nimport \"../../styles/TactBandeauTop.css\"\r\nimport BookmarkRoundedIcon from '@material-ui/icons/BookmarkRounded';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport PlayAPI from \"../../API/PlayAPI\"\r\nimport ContentsAPI from \"../../API/ContentsAPI\"\r\n\r\nconst TactBandeauTop = ({\r\n    numeroPompier,\r\n    sequence,\r\n    numEquipe,\r\n    numSession,\r\n    cycle,\r\n    tour,\r\n    pomp,\r\n    stocks,\r\n    resultats,\r\n    configuration,\r\n    budget,\r\n    equipe,\r\n    handleClicValidated,\r\n    play,\r\n    chronoInit,\r\n    budgetDepense\r\n\r\n}) => {\r\n    \r\n    console.log(chronoInit)\r\n    const [textes, setTextes] = useState(null)\r\n    const [chrono, setChrono] = useState(null)\r\n    useEffect(() => {\r\n        \r\n        if (pomp == numeroPompier && chrono !== null && play && chrono>=0) {\r\n            if (chrono > 0) {\r\n                var chronoTimer = setInterval(() => {\r\n                    if (chrono % 30 == 0 && chrono>10) PlayAPI.updateCurrentChrono(chrono, numSession, numEquipe)\r\n                    setChrono(chrono => chrono - 1)\r\n                    \r\n\r\n                }, 1000)\r\n\r\n            } else {\r\n                // clearInterval(chronoTimer)\r\n                // console.log(\"handle\")\r\n                if(chrono==0){\r\n                    handleClicValidated(true)\r\n                    setChrono(-1)\r\n                }\r\n                \r\n            }\r\n           \r\n        } else {\r\n            if (configuration !== null ) {\r\n                if(chronoInit==null || chrono==-1){\r\n                    setChrono(-1)\r\n                }else{\r\n                    setChrono(chronoInit)\r\n                }\r\n                 \r\n            }\r\n        }\r\n\r\n        return () => {\r\n            clearInterval(chronoTimer)\r\n        }\r\n    }, [chrono])\r\n\r\n    useEffect(()=>{\r\n        if(chronoInit!==null && (chrono>=chronoInit || chrono==-1)   && configuration!==null){\r\n          setChrono(chronoInit)\r\n        }\r\n      })\r\n\r\n\r\n      useEffect(()=>{\r\n          console.log(chrono)\r\n      },[chrono])\r\n\r\n\r\n    // useEffect(() => {\r\n    //     // console.log(configuration.chronoTour.valeur)\r\n    //     if (chrono === null && configuration !== null) {\r\n    //         // setChrono(chronoInit)\r\n    //     }\r\n    // })\r\n\r\n\r\n    useEffect(() => {\r\n        // console.log(\"use effect\")\r\n        const getTextes = async () => {\r\n            const textes = ContentsAPI.getTexts(\"jeuTactBandeauTop\").then(\r\n                (res) => { setTextes(res) }\r\n            )\r\n        }\r\n        if (textes == null) {\r\n            getTextes()\r\n        }\r\n    }, [textes])\r\n\r\n\r\n\r\n    const getText = (name) => {\r\n        if (textes == null) {\r\n            return name\r\n        } else {\r\n            try {\r\n                return textes[\"label\" + name.charAt(0).toUpperCase() + name.slice(1)].contenu\r\n            } catch (error) {\r\n                console.log(\"label\" + name.charAt(0).toUpperCase() + name.slice(1))\r\n                return name\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    const renderStocks = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel donnees-container\"\r\n                style={{\r\n                    flex: 3\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"stockEquipements\")}\r\n                </label>\r\n                <div className=\"sous-donnees-container\">\r\n                    <CaseDonnee\r\n                        key={0}\r\n                        name={\"nbExtFeu\"}\r\n                        value={stocks.Feu}\r\n                        primary={false}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n\r\n                    />\r\n                    <CaseDonnee\r\n                        key={1}\r\n                        name={\"nbExtFum\"}\r\n                        value={stocks.Fum}\r\n                        primary={false}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n\r\n                    />\r\n                </div>\r\n                <div className=\"sous-donnees-container\">\r\n                    <CaseDonnee\r\n                        key={2}\r\n                        name={\"nbExtFeuFum\"}\r\n                        value={stocks.FeuFum}\r\n                        primary={false}\r\n                        flexFactor={2}\r\n                        textes={textes}\r\n\r\n                    />\r\n                    <CaseDonnee\r\n                        key={3}\r\n                        name={\"nbMarqueurs\"}\r\n                        value={stocks.Marqueur}\r\n                        primary={false}\r\n                        flexFactor={2}\r\n                        textes={textes}\r\n\r\n                    />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderResults = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel donnees-container\"\r\n                style={{\r\n                    flex: 2\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"resultats\") + \" \" + equipe}\r\n                </label>\r\n                <CaseDonnee\r\n                    key={4}\r\n                    name={getText(\"nbDecedes\")}\r\n                    value={resultats.Decedes}\r\n                    primary={false}\r\n                    flexFactor={0}\r\n                />\r\n                <CaseDonnee\r\n                    key={5}\r\n                    name={getText(\"nbSauves\")}\r\n                    value={resultats.Sauves}\r\n                    primary={false}\r\n                    flexFactor={0}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderNumPompier = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel\"\r\n                style={{\r\n                    flex: 1\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"numPompier\")}\r\n                </label>\r\n                <div className=\"donnees-container\">\r\n                    <label\r\n                        className=\"label-title label-num-pompier\"\r\n                    >\r\n                        {numeroPompier}\r\n                    </label>\r\n                    <BookmarkRoundedIcon\r\n                        className=\"icone-num-pompier\"\r\n                        fontSize=\"large\"\r\n                        stroke={\"white\"}\r\n                        strokeWidth={1}\r\n                    />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderCircleTours = () => {\r\n        var type = 1, //circle type - 1 whole, 0.5 half, 0.25 quarter\r\n            radius = 20, //distance from center\r\n            start = -90, //shift start from 0\r\n            // $elements = $('li:not(:first-child)'),\r\n            numberOfElements = configuration.nbPompEquipe.valeur,\r\n            slice = 360 * type / numberOfElements;\r\n\r\n        const renderCircleItems = () => {\r\n            var items = []\r\n            const decalage = 1.2\r\n            // items.push(\r\n            //     <li\r\n            //         key={\"c\"}\r\n            //         style={{\r\n            //             'transform': 'translate(' + (-radius*decalage*2) + 'px,'+ (-radius*decalage) +'px)',\r\n            //             \"backgroundColor\": tour==-1 ? \"#BF0000\" : null\r\n            //         }}\r\n\r\n            //     >\r\n            //         {\"C\"}\r\n            //     </li>\r\n            // )\r\n            items.push(\r\n                <li\r\n                    key={\"s\"}\r\n                    style={{\r\n                        'transform': 'translate(' + (radius * decalage) + 'px,' + (-radius * decalage) + 'px)',\r\n                        \"backgroundColor\": pomp == 0 ? \"#BF0000\" : null\r\n                    }}\r\n\r\n                >\r\n                    {\"S\"}\r\n                </li>\r\n            )\r\n\r\n            for (let i = 0; i < numberOfElements; i++) {\r\n                const rotate = slice * i + start\r\n                const rotateReverse = rotate * -1\r\n                const decalageCircle = 10\r\n\r\n                items.push(\r\n                    <li\r\n                        key={i}\r\n                        style={{\r\n                            'transform': 'rotate(' + rotate + 'deg) translate(' + radius + 'px) rotate(' + rotateReverse + 'deg) translate(' + -radius / 2 + 'px) translateY(' + decalageCircle + 'px)',\r\n                            \"backgroundColor\": i + 1 == pomp ? \"#BF0000\" : null\r\n                        }}\r\n\r\n                    >\r\n                        {i + 1}\r\n                    </li>\r\n\r\n                )\r\n            }\r\n            return items\r\n        }\r\n\r\n        return (\r\n            <div\r\n                className=\"case-panel\"\r\n                style={{\r\n                    flex: 1\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"tourParTour\")}\r\n                </label>\r\n                <ul >\r\n                    {renderCircleItems()}\r\n                </ul>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderFeu = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel\"\r\n                style={{\r\n                    flex: 1\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"play\")}\r\n                </label>\r\n\r\n                <div className=\"donnees-container\">\r\n                    <div className='feu'>\r\n                        <div\r\n                            className={chrono < 30 && chrono>0? \"clignotant animation-reverted\" : \"\"}\r\n                            style={{ backgroundColor: numeroPompier != pomp ? \"#ff0000\" : chrono>=0 && chrono < 30 ? \"#E26F00\" : \"#9F9F9F\"  }}></div>\r\n                        <div\r\n                            className={chrono < 30 && chrono>0 ? \"clignotant\" : \"\"}\r\n                            style={{ backgroundColor: numeroPompier == pomp ? chrono>=0 && chrono < 30 ? \"#E26F00\" : \"#4dff4d\" : \"#9F9F9F\" }}\r\n                        ></div>\r\n                    </div>\r\n                    <span className=\"case-value\" style={{\r\n                        marginTop: \"10%\",\r\n                        width: \"100%\",\r\n                        maxWidth: \"100%\"\r\n                    }} >\r\n                        {(Math.floor((chrono>=0 ? chrono : configuration.chronoTour.valeur)/ 60)).toString().padStart(2, \"0\") + \" : \"}\r\n                        <span style={{ color: chrono <= 30 && chrono>0? \"red\" : \"inherit\", marginLeft: 5 }}> {\" \" + ((chrono>=0 ? chrono : configuration.chronoTour.valeur) % 60).toString().padStart(2, \"0\")} </span>\r\n                    </span>\r\n                </div>\r\n\r\n\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n    return (\r\n        configuration != null ?\r\n            <div className=\"bandeau-top\">\r\n                <div className=\"cases-container\">\r\n                    <CaseDonnee\r\n                        name={\"sequence\"}\r\n                        value={sequence}\r\n                        primary={true}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n                        data={configuration.nbSequences.valeur}\r\n                    />\r\n                    <CaseDonnee\r\n                        name={\"cycle\"}\r\n                        value={cycle}\r\n                        primary={true}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n                        data={configuration.nbCyclesParSequence.valeur}\r\n                    />\r\n                    <CaseDonnee\r\n                        name={\"tour\"}\r\n                        value={tour}\r\n                        primary={true}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n                        data={configuration.nbToursParCycle.valeur}\r\n                    />\r\n                    <CaseDonnee\r\n                        name={\"budgetRestant\"}\r\n                        value={budget + \" â‚¬\"}\r\n                        primary={true}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n                        data={budgetDepense >= configuration.budgetTourMax.valeur}\r\n\r\n                    />\r\n                    {renderStocks()}\r\n                    {renderResults()}\r\n                    {renderCircleTours()}\r\n                    {renderNumPompier()}\r\n                    {renderFeu()}\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n\r\n            :\r\n            null\r\n\r\n\r\n    );\r\n}\r\n\r\nexport default TactBandeauTop;"]},"metadata":{},"sourceType":"module"}