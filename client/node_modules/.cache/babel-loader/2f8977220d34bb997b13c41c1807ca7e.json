{"ast":null,"code":"import _toConsumableArray from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useRef}from'react';import Grid from\"@material-ui/core/Grid\";import Paper from\"@material-ui/core/Paper\";import Table from'@material-ui/core/Table';import TableBody from'@material-ui/core/TableBody';import TableCell from'@material-ui/core/TableCell';import TableContainer from'@material-ui/core/TableContainer';import TableHead from'@material-ui/core/TableHead';import TableRow from'@material-ui/core/TableRow';import TableFooter from'@material-ui/core/TableFooter';import TablePagination from'@material-ui/core/TablePagination';import InputLabel from'@material-ui/core/InputLabel';import MenuItem from'@material-ui/core/MenuItem';import FormHelperText from'@material-ui/core/FormHelperText';import FormControl from'@material-ui/core/FormControl';import Select from'@material-ui/core/Select';import TextField from'@material-ui/core/TextField';import ContentsAPI from\"../../API/ContentsAPI\";import'../../styles/Interfaces.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var InterInterventions=function InterInterventions(_ref){var budget=_ref.budget,cycles=_ref.cycles,handleBudgetChange=_ref.handleBudgetChange,type=_ref.type,currentCycle=_ref.currentCycle,currentSequence=_ref.currentSequence,budgetSim=_ref.budgetSim,couts=_ref.couts,page=_ref.page,nbCycleParSeq=_ref.nbCycleParSeq,configuration=_ref.configuration;var lastRow=useRef(null);var nbPompiers=configuration.nbPompEquipe.valeur;var _useState=useState(budgetSim.numCycle),_useState2=_slicedToArray(_useState,2),numCycle=_useState2[0],setNumCycle=_useState2[1];var _useState3=useState(budgetSim),_useState4=_slicedToArray(_useState3,2),lastCycle=_useState4[0],setLastCycle=_useState4[1];var initLocalPage=function initLocalPage(){console.log(\"init local page\");if(nbCycleParSeq>0&&budgetSim.numSeq>0){if(type==\"interventions\"){// return Math.floor(budgetSim.numSeq/nbCycleParSeq) \nreturn cycles.length>0?Math.floor(cycles[cycles.length-1].numSeq/nbCycleParSeq):0;}else{// return Math.floor((budgetSim.numSeq-1)*nbCycleParSeq+budgetSim.numCycle-1)\nreturn cycles.length>0?Math.floor((cycles[cycles.length-1].numSeq-1)*nbCycleParSeq+cycles[cycles.length-1].numCycle-1):0;}}return 0;};var _useState5=useState(initLocalPage()),_useState6=_slicedToArray(_useState5,2),localPage=_useState6[0],setLocalPage=_useState6[1];// useEffect(()=>{\n//     console.log(localPage)\n// },[localPage])\nvar renderHeaders=function renderHeaders(){var components=[];components.push(/*#__PURE__*/_jsx(TableCell,{align:\"center\",component:\"th\",children:\"S\\xE9quence\"},\"head\"+0));components.push(/*#__PURE__*/_jsx(TableCell,{align:\"center\",component:\"th\",children:\"Cycle\"},\"head\"+1));if(type==\"equipements\"){components.push(/*#__PURE__*/_jsx(TableCell,{align:\"center\",component:\"th\",children:\"Type\"},\"head\"+2));}for(var i=1;i<=nbPompiers;i++){components.push(/*#__PURE__*/_jsxs(TableCell,{align:\"center\",component:\"th\",children:[\"Pompier \",i]},\"head\"+i+3));}components.push(/*#__PURE__*/_jsx(TableCell,{align:\"center\",component:\"th\",children:\"Total\"},1000));return/*#__PURE__*/_jsx(TableRow,{children:components},\"header\");};var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),textes=_useState8[0],setTextes=_useState8[1];useEffect(function(){var getTextes=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var textes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:textes=ContentsAPI.getTexts(\"jeuInterInterventions\").then(function(res){setTextes(res);});case 1:case\"end\":return _context.stop();}}},_callee);}));return function getTextes(){return _ref2.apply(this,arguments);};}();if(textes==null){getTextes();}// console.log(textes)\n},[textes]);var getText=function getText(name){if(textes==null){return name;}else{try{return textes[\"label\"+name.charAt(0).toUpperCase()+name.slice(1)].contenu;}catch(error){console.log(\"label\"+name.charAt(0).toUpperCase()+name.slice(1));return name;}}};// useEffect(()=>{\n//     // setLocalPage(initLocalPage())\n// },[lastCycle])\nvar initLastCycle=function initLastCycle(){// setLastCycle(\n//     type == \"interventions\" ?\n//         {\n//             numSeq: cycles.length>0 ? cycles.length%nbCycleParSeq == 0  ? cycles[cycles.length -1].numSeq +1 : cycles[cycles.length -1].numSeq :1 ,\n//             numCycle:(cycles.length)%nbCycleParSeq+1,\n//             pomp1: 0,\n//             pomp2: 0,\n//             pomp3: 0,\n//             pomp4: 0,\n//             pomp5: 0,\n//             pomp6: 0,\n//         }\n//         :\n//         {\n//             numSeq:cycles.length>0 ? cycles.length>1 ? cycles.length%2 == 0  ? cycles[cycles.length -1].numSeq +1 : cycles[cycles.length -1].numSeq : 1 :1 ,\n//             numCycle: (cycles.length)%2+1,\n//             Feu: {\n//                 pomp1: 0,\n//                 pomp2: 0,\n//                 pomp3: 0,\n//                 pomp4: 0,\n//                 pomp5: 0,\n//                 pomp6: 0,\n//             },\n//             FeuFum: {\n//                 pomp1: 0,\n//                 pomp2: 0,\n//                 pomp3: 0,\n//                 pomp4: 0,\n//                 pomp5: 0,\n//                 pomp6: 0,\n//             },\n//             Fum: {\n//                 pomp1: 0,\n//                 pomp2: 0,\n//                 pomp3: 0,\n//                 pomp4: 0,\n//                 pomp5: 0,\n//                 pomp6: 0,\n//             },\n//             Marqueur: {\n//                 pomp1: 0,\n//                 pomp2: 0,\n//                 pomp3: 0,\n//                 pomp4: 0,\n//                 pomp5: 0,\n//                 pomp6: 0,\n//             }\n//         }\n// )\nsetLastCycle(budgetSim);};// useEffect(()=>{\n//     console.log(\"local page\", localPage)\n// },[localPage])\n// useEffect(()=>{\n//     console.log(lastCycle)\n// },[lastCycle])\nvar handleChangeSelect=function handleChangeSelect(numPompier,event,key){var c=_objectSpread({},lastCycle);if(type==\"interventions\"){c[\"pomp\"+numPompier]=event.target.value;}else{c[key][\"pomp\"+numPompier]=event.target.value;}setLastCycle(c);handleBudgetChange(type,c);};var renderPropositionsBudget=function renderPropositionsBudget(nSeq,nCycle,numPompier,value){var cycle=_toConsumableArray(cycles).sort(function(a,b){return a.numCycle-b.numCycle;}).sort(function(a,b){return a.numSeq-b.numSeq;})[(nSeq-1)*nbCycleParSeq+nCycle-1];if(cycle==null)cycle=_objectSpread({},lastCycle);var sum=0;if(cycle!=null){Object.keys(cycle).forEach(function(key,index){if(key!=\"numCycle\"&&key!==\"numSeq\"&&(numPompier!==index-1||nCycle<lastCycle.numCycle||nSeq<lastCycle.numSeq)){sum+=cycle[key];}});}var components=[];var maxValue=cycle!=null&&(nCycle<lastCycle.numCycle||nSeq<lastCycle.numSeq)?sum:budget.sequence-budget.depense-sum;// console.log(value)\nfor(var i=0;i<=Math.floor(maxValue/100);i++){components.push(/*#__PURE__*/_jsx(MenuItem,{value:i*100,align:\"right\",children:i*100+\"€\"},\"item\"+nCycle+\":\"+numPompier+\":\"+i));}return components;};var renderSelectBudgetCycle=function renderSelectBudgetCycle(nSeq,nCycle,disabled,numPompier,value){// console.log(nCycle)\nreturn/*#__PURE__*/_jsx(FormControl,{disabled:disabled,variant:\"outlined\",children:/*#__PURE__*/_jsxs(Select,{value:value,onChange:function onChange(value){return handleChangeSelect(numPompier,value);},displayEmpty:true,color:\"secondary\",className:value==0||disabled?\"empty\":\"\",children:[/*#__PURE__*/_jsxs(MenuItem,{value:\"\",disabled:true,align:\"center\",children:[\"Budget \",numPompier]}),renderPropositionsBudget(nSeq,nCycle,numPompier,value)]})},\"select\"+nSeq+\":\"+nCycle+\" : \"+numPompier);};var renderRowBudgetCycle=function renderRowBudgetCycle(cycle){var comp=[];var sum=0;if(cycle.numCycle%nbCycleParSeq==1){comp.push(/*#__PURE__*/_jsxs(TableCell,{scope:\"row\",align:\"center\",component:\"th\",rowSpan:nbCycleParSeq,children:[\"S\\xE9quence n\\xB0\",cycle.numSeq]},\"row\"+cycle+\":\"+0));}comp.push(/*#__PURE__*/_jsxs(TableCell,{scope:\"row\",align:\"center\",component:\"th\",children:[\"Cycle n\\xB0\",cycle.numCycle]},\"row\"+cycle+\":\"+1));var disabled=cycle.numSeq<lastCycle.numSeq||cycle.numCycle<lastCycle.numCycle;// console.log(disabled)\nObject.keys(cycle).forEach(function(key,index){if(key!=\"numCycle\"&&key!=\"numSeq\"){comp.push(/*#__PURE__*/_jsx(TableCell,{scope:\"row\",align:\"center\",children:renderSelectBudgetCycle(cycle[\"numSeq\"],cycle[\"numCycle\"],disabled,index-1,cycle[key])},\"row\"+cycle+\":pomp\"+index));sum+=cycle[key];}});comp.push(/*#__PURE__*/_jsx(TableCell,{scope:\"row\",align:\"center\",children:/*#__PURE__*/_jsx(TextField,{variant:\"outlined\",disabled:true,value:sum+\" €\",inputProps:{style:{color:!disabled?sum>budget.sequence-budget.depense?\"red\":\"green\":null,fontWeight:!disabled?\"bold\":null,fontStyle:disabled?\"italic\":null,textAlign:\"center\",backgroundColor:\"#f1f1f1\",borderRadius:5}}})},1000));return/*#__PURE__*/_jsx(TableRow,{hover:true,ref:cycle.numCycle>=currentCycle?lastRow:null,children:comp},\"row\"+cycle.numSeq+\" : \"+cycle.numCycle+Math.random());};var renderBudgetsCycles=function renderBudgetsCycles(){if(budgetSim.numCycle!==lastCycle.numCycle)initLastCycle();// if(budgetSim.numCycle<lastCycle.numCycle) setLastCycle(budgetSim)\nvar cyclesSorted=_toConsumableArray(cycles).sort(function(a,b){return a.numCycle-b.numCycle;}).sort(function(a,b){return a.numSeq-b.numSeq;});// console.log(cycles)\nvar components=[];cyclesSorted.forEach(function(cycle,index){// type==\"interventions\" ? Math.floor(currentCycle+(currentSequence-1)*nbCycleParSeq)/nbCycleParSeq-1: currentCycle-1\nif(cycle.numSeq<currentSequence||cycle.numSeq==currentSequence&&cycle.numCycle<currentCycle+1){if(cycle.numSeq==localPage+1){// console.log(\"render\",localPage,cycle.numCycle,cycle.numSeq)\ncomponents.push(renderRowBudgetCycle(cycle));}}});// console.log(lastCycle,localPage)\nif(lastCycle.numSeq==localPage+1){components.push(renderRowBudgetCycle(lastCycle));}return components;};var renderPropositionsStock=function renderPropositionsStock(nSeq,nCycle,numPompier,key){var cycle=_toConsumableArray(cycles).sort(function(a,b){return a.numCycle-b.numCycle;}).sort(function(a,b){return a.numSeq-b.numSeq;})[(nSeq-1)*nbCycleParSeq+nCycle-1];if(cycle==null)cycle=_objectSpread({},lastCycle);var sum=0;if(cycle!=null){Object.keys(cycle).forEach(function(k){if(k!=\"numCycle\"&&k!==\"numSeq\"&&k!==\"type\"){Object.values(cycle[k]).forEach(function(value,index){if(key!==k||numPompier!==index+1||nCycle<lastCycle.numCycle||nSeq<lastCycle.numSeq){sum+=value*couts.equipements[\"coutEq\"+k];}});}});}var components=[];var maxValue=cycle!=null&&(nCycle<lastCycle.numCycle||nSeq<lastCycle.numSeq)?Math.floor(sum/couts.equipements[\"coutEq\"+key]):Math.floor((budget.sequence-budget.depense-sum)/couts.equipements[\"coutEq\"+key]);for(var i=0;i<=Math.max(0,maxValue);i++){components.push(/*#__PURE__*/_jsx(MenuItem,{value:i,align:\"right\",children:i},nCycle+\":\"+numPompier+\":\"+i));}return components;};var renderSelectStockCycle=function renderSelectStockCycle(nSeq,nCycle,disabled,numPompier,value,key){// console.log(value)\nreturn/*#__PURE__*/_jsx(FormControl,{disabled:disabled,variant:\"outlined\",children:/*#__PURE__*/_jsxs(Select,{value:value,onChange:function onChange(value){return handleChangeSelect(numPompier,value,key);},displayEmpty:true,color:\"secondary\",className:value==0||disabled?\"empty\":\"\",children:[/*#__PURE__*/_jsxs(MenuItem,{value:\"\",disabled:true,align:\"center\",children:[\"Stock \",numPompier]}),renderPropositionsStock(nSeq,nCycle,numPompier,key)]})},nSeq+\":\"+nCycle+\" :\"+numPompier+\":\"+key+Math.random());};var renderRowStocksCycle=function renderRowStocksCycle(cycle,key,data){if(cycle.numCycle<currentCycle+2){var comp=[];var sum=0;// console.log(key,data)\nvar nbLignesParCycle=Object.keys(lastCycle).length-2;if(key==\"Feu\"){// if(cycle.numCycle%nbCycleParSeq==1){\ncomp.push(/*#__PURE__*/_jsxs(TableCell,{scope:\"row\",align:\"center\",component:\"th\",rowSpan:nbCycleParSeq*(Object.keys(lastCycle).length-2),children:[\"S\\xE9quence n\\xB0\",cycle.numSeq]},\"row\"+cycle+\":\"+0));// }\ncomp.push(/*#__PURE__*/_jsxs(TableCell,{scope:\"row\",align:\"center\",component:\"th\",rowSpan:Object.keys(lastCycle).length-2,children:[\"Cycle n\\xB0\",cycle.numCycle]},\"row\"+cycle+\":\"+1));}comp.push(/*#__PURE__*/_jsx(TableCell,{scope:\"row\",align:\"center\",children:getText(key!==\"Marqueur\"?\"Ext\"+key:key)},\"row\"+cycle+\":\"+2));var disabled=cycle.numSeq<lastCycle.numSeq||cycle.numCycle<lastCycle.numCycle;// console.log()\nif(data!==null&&data!==undefined){Object.keys(data).forEach(function(k,index){if(k!=\"numCycle\"&&k!=\"numSeq\"&&k!==\"type\"){comp.push(/*#__PURE__*/_jsx(TableCell,{align:\"center\",scope:\"row\",children:renderSelectStockCycle(cycle.numSeq,cycle.numCycle,disabled,index+1,data[k],key)},\"row\"+cycle+\":pomp\"+index+3));sum+=data[k]*couts.equipements[\"coutEq\"+key];}});}comp.push(/*#__PURE__*/_jsx(TableCell,{scope:\"row\",align:\"center\",children:/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic\",variant:\"outlined\",disabled:true,value:sum+\" €\",inputProps:{style:{color:!disabled?sum>budget.sequence-budget.depense?\"red\":\"green\":null,fontWeight:!disabled?\"bold\":null,fontStyle:disabled?\"italic\":null,textAlign:\"center\",backgroundColor:\"#f1f1f1\",borderRadius:5// minWidth: 70\n}}})},20));return/*#__PURE__*/_jsx(TableRow,{hover:true,ref:cycle.numCycle>=currentCycle?lastRow:null,children:comp},cycle.numSeq+\" : \"+cycle.numCycle+\" : \"+key+Math.random());}else{return null;}};var renderStocksCycle=function renderStocksCycle(){if(budgetSim.numCycle!==lastCycle.numCycle)initLastCycle();var cyclesSorted=_toConsumableArray(cycles).sort(function(a,b){return(a.numSeq-b.numSeq)*100+a.numCycle-b.numCycle;});var components=[];cyclesSorted.forEach(function(cycle,index){if(index==localPage){Object.keys(cycle).forEach(function(key){if(key!==\"numSeq\"&&key!==\"numCycle\"){components.push(renderRowStocksCycle(cycle,key,cycle[key]));}});}});if(localPage==(lastCycle.numSeq-1)*nbCycleParSeq+lastCycle.numCycle-1){Object.keys(lastCycle).forEach(function(key){if(key!==\"numSeq\"&&key!==\"numCycle\"){components.push(renderRowStocksCycle(lastCycle,key,lastCycle[key]));}});}return components;};var handleChangePage=function handleChangePage(event,newPage){setLocalPage(newPage);// console.log(\"new Page\", newPage)\n};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(TableContainer,{component:Paper,className:\"tableau\",children:/*#__PURE__*/_jsxs(Table,{stickyHeader:true,size:\"small\",children:[/*#__PURE__*/_jsx(TableHead,{children:renderHeaders()}),/*#__PURE__*/_jsxs(TableBody,{children:[type==\"interventions\"?renderBudgetsCycles():null,type==\"equipements\"?renderStocksCycle():null]}),/*#__PURE__*/_jsx(TableFooter,{children:/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TablePagination,{rowsPerPageOptions:[Object.keys(lastCycle).length-2]// colSpan={3}\n,count:type==\"interventions\"?lastCycle.numSeq*nbCycleParSeq:(lastCycle.numSeq-1)*nbCycleParSeq+lastCycle.numCycle,rowsPerPage:type==\"interventions\"?nbCycleParSeq:1,page:localPage// labelDisplayedRows={({ from, to, count }) => type == \"interventions\" ? \"Séquence n° \" + Math.ceil(from/nbCycleParSeq) + \" | Cycles \"+1+\" - \"+(nbCycleParSeq) : \"Séquence n° \" + Math.ceil(from/nbCycleParSeq) + \"    |    Cycle n° \" + ((to+1)%nbCycleParSeq+1) }\n,labelDisplayedRows:function labelDisplayedRows(_ref3){var from=_ref3.from,to=_ref3.to,count=_ref3.count;return type==\"interventions\"?\"Séquence n° \"+Math.ceil(from/nbCycleParSeq)+\" | Cycles \"+1+\" - \"+nbCycleParSeq:\"Séquence n° \"+Math.ceil(from/nbCycleParSeq)+\"    |    Cycle n° \"+(localPage%nbCycleParSeq+1);}// SelectProps={{\n//     inputProps: { 'aria-label': 'rows per page' },\n//     native: true,\n// }}\n,onChangePage:handleChangePage// onRowsPerPageChange={handleChangeRowsPerPage}\n// ActionsComponent={TablePaginationActions}\n})},\"footer-row\")})]})})});};export default InterInterventions;","map":{"version":3,"sources":["C:/Users/hugod/decitude/client/src/components/interfaceJoueur/InterInterventions.js"],"names":["React","useEffect","useState","useRef","Grid","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","TableFooter","TablePagination","InputLabel","MenuItem","FormHelperText","FormControl","Select","TextField","ContentsAPI","InterInterventions","budget","cycles","handleBudgetChange","type","currentCycle","currentSequence","budgetSim","couts","page","nbCycleParSeq","configuration","lastRow","nbPompiers","nbPompEquipe","valeur","numCycle","setNumCycle","lastCycle","setLastCycle","initLocalPage","console","log","numSeq","length","Math","floor","localPage","setLocalPage","renderHeaders","components","push","i","textes","setTextes","getTextes","getTexts","then","res","getText","name","charAt","toUpperCase","slice","contenu","error","initLastCycle","handleChangeSelect","numPompier","event","key","c","target","value","renderPropositionsBudget","nSeq","nCycle","cycle","sort","a","b","sum","Object","keys","forEach","index","maxValue","sequence","depense","renderSelectBudgetCycle","disabled","renderRowBudgetCycle","comp","style","color","fontWeight","fontStyle","textAlign","backgroundColor","borderRadius","random","renderBudgetsCycles","cyclesSorted","renderPropositionsStock","k","values","equipements","max","renderSelectStockCycle","renderRowStocksCycle","data","nbLignesParCycle","undefined","renderStocksCycle","handleChangePage","newPage","from","to","count","ceil"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport Grid from \"@material-ui/core/Grid\"\r\nimport Paper from \"@material-ui/core/Paper\"\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport TableFooter from '@material-ui/core/TableFooter';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport ContentsAPI from \"../../API/ContentsAPI\"\r\n\r\nimport '../../styles/Interfaces.css';\r\n\r\n\r\nconst InterInterventions = ({\r\n    budget,\r\n    cycles,\r\n    handleBudgetChange,\r\n    type,\r\n    currentCycle,\r\n    currentSequence,\r\n    budgetSim,\r\n    couts,\r\n    page,\r\n    nbCycleParSeq,\r\n    configuration\r\n\r\n}) => {\r\n    const lastRow = useRef(null)\r\n    const nbPompiers = configuration.nbPompEquipe.valeur\r\n    const [numCycle, setNumCycle] = useState(budgetSim.numCycle)\r\n    const [lastCycle, setLastCycle] = useState(budgetSim)\r\n\r\n    const initLocalPage=()=>{\r\n        console.log(\"init local page\")\r\n        if(nbCycleParSeq>0 && budgetSim.numSeq>0){\r\n            if(type==\"interventions\"){\r\n                // return Math.floor(budgetSim.numSeq/nbCycleParSeq) \r\n                return cycles.length>0 ? Math.floor(cycles[cycles.length-1].numSeq/nbCycleParSeq) : 0\r\n            }else{\r\n                \r\n                // return Math.floor((budgetSim.numSeq-1)*nbCycleParSeq+budgetSim.numCycle-1)\r\n                return cycles.length>0 ? Math.floor((cycles[cycles.length-1].numSeq-1)*nbCycleParSeq+cycles[cycles.length-1].numCycle-1) : 0\r\n            }\r\n        }\r\n        return 0    \r\n    }\r\n    const [localPage, setLocalPage] = useState(initLocalPage())\r\n\r\n    // useEffect(()=>{\r\n    //     console.log(localPage)\r\n    // },[localPage])\r\n\r\n\r\n    const renderHeaders = () => {\r\n        var components = []\r\n        components.push(\r\n            <TableCell key={\"head\"+0} align=\"center\" component=\"th\">Séquence</TableCell>\r\n        )\r\n        components.push(\r\n            <TableCell key={\"head\"+1} align=\"center\" component=\"th\">Cycle</TableCell>\r\n        )\r\n        if (type == \"equipements\") {\r\n            components.push(\r\n                <TableCell key={\"head\"+2} align=\"center\" component=\"th\">Type</TableCell>\r\n            )\r\n        }\r\n\r\n        for (let i = 1; i <= nbPompiers; i++) {\r\n            components.push(\r\n                <TableCell key={\"head\"+i+3} align=\"center\" component=\"th\">Pompier {i}</TableCell>\r\n            )\r\n        }\r\n        components.push(\r\n            <TableCell key={1000} align=\"center\" component=\"th\">Total</TableCell>\r\n        )\r\n        return (\r\n            <TableRow key={\"header\"}>\r\n                {components}\r\n            </TableRow>\r\n        )\r\n    }\r\n\r\n\r\n\r\n\r\n    const [textes, setTextes] = useState(null)\r\n\r\n    useEffect(() => {\r\n        const getTextes = async () => {\r\n            const textes = ContentsAPI.getTexts(\"jeuInterInterventions\").then(\r\n                (res) => { setTextes(res) }\r\n            )\r\n        }\r\n        if (textes == null) {\r\n            getTextes()\r\n        }\r\n        // console.log(textes)\r\n    }, [textes])\r\n\r\n\r\n    const getText = (name) => {\r\n        if (textes == null) {\r\n            return name\r\n        } else {\r\n            try {\r\n                return textes[\"label\" + name.charAt(0).toUpperCase() + name.slice(1)].contenu\r\n            } catch (error) {\r\n                console.log(\"label\" + name.charAt(0).toUpperCase() + name.slice(1))\r\n                return name\r\n            }\r\n        }\r\n    }\r\n\r\n    // useEffect(()=>{\r\n    //     // setLocalPage(initLocalPage())\r\n    // },[lastCycle])\r\n\r\n\r\n\r\n    const initLastCycle = () => {\r\n        \r\n        // setLastCycle(\r\n        //     type == \"interventions\" ?\r\n        //         {\r\n        //             numSeq: cycles.length>0 ? cycles.length%nbCycleParSeq == 0  ? cycles[cycles.length -1].numSeq +1 : cycles[cycles.length -1].numSeq :1 ,\r\n        //             numCycle:(cycles.length)%nbCycleParSeq+1,\r\n        //             pomp1: 0,\r\n        //             pomp2: 0,\r\n        //             pomp3: 0,\r\n        //             pomp4: 0,\r\n        //             pomp5: 0,\r\n        //             pomp6: 0,\r\n\r\n        //         }\r\n        //         :\r\n        //         {\r\n        //             numSeq:cycles.length>0 ? cycles.length>1 ? cycles.length%2 == 0  ? cycles[cycles.length -1].numSeq +1 : cycles[cycles.length -1].numSeq : 1 :1 ,\r\n        //             numCycle: (cycles.length)%2+1,\r\n        //             Feu: {\r\n        //                 pomp1: 0,\r\n        //                 pomp2: 0,\r\n        //                 pomp3: 0,\r\n        //                 pomp4: 0,\r\n        //                 pomp5: 0,\r\n        //                 pomp6: 0,\r\n        //             },\r\n        //             FeuFum: {\r\n        //                 pomp1: 0,\r\n        //                 pomp2: 0,\r\n        //                 pomp3: 0,\r\n        //                 pomp4: 0,\r\n        //                 pomp5: 0,\r\n        //                 pomp6: 0,\r\n        //             },\r\n        //             Fum: {\r\n        //                 pomp1: 0,\r\n        //                 pomp2: 0,\r\n        //                 pomp3: 0,\r\n        //                 pomp4: 0,\r\n        //                 pomp5: 0,\r\n        //                 pomp6: 0,\r\n        //             },\r\n        //             Marqueur: {\r\n        //                 pomp1: 0,\r\n        //                 pomp2: 0,\r\n        //                 pomp3: 0,\r\n        //                 pomp4: 0,\r\n        //                 pomp5: 0,\r\n        //                 pomp6: 0,\r\n        //             }\r\n        //         }\r\n        // )\r\n        setLastCycle(budgetSim)\r\n    }\r\n\r\n    // useEffect(()=>{\r\n    //     console.log(\"local page\", localPage)\r\n    // },[localPage])\r\n\r\n\r\n    // useEffect(()=>{\r\n    //     console.log(lastCycle)\r\n    // },[lastCycle])\r\n\r\n    const handleChangeSelect = (numPompier, event, key) => {\r\n        var c = { ...lastCycle }\r\n        if (type == \"interventions\") {\r\n            c[\"pomp\" + numPompier] = event.target.value\r\n        } else {\r\n            c[key][\"pomp\" + numPompier] = event.target.value\r\n        }\r\n        setLastCycle(c)\r\n        handleBudgetChange(type, c)\r\n        \r\n    }\r\n\r\n    const renderPropositionsBudget = (nSeq, nCycle, numPompier,value) => {\r\n        let cycle = [...cycles].sort((a, b) => a.numCycle - b.numCycle).sort((a, b) => a.numSeq - b.numSeq)[(nSeq-1)*nbCycleParSeq+nCycle - 1]\r\n        if (cycle == null) cycle = {...lastCycle}\r\n        let sum = 0\r\n        if (cycle != null) {\r\n            Object.keys(cycle).forEach((key, index) => {\r\n                if (key != \"numCycle\" && key !== \"numSeq\" && (numPompier !== index - 1 || nCycle < lastCycle.numCycle || nSeq<lastCycle.numSeq)) {\r\n                    sum += cycle[key]\r\n                }\r\n            })\r\n        }\r\n\r\n        var components = []\r\n        const maxValue = cycle != null && (nCycle < lastCycle.numCycle || nSeq<lastCycle.numSeq) ? sum : (budget.sequence - budget.depense - sum)\r\n        // console.log(value)\r\n        for (let i = 0; i <= Math.floor(maxValue/100); i++) {\r\n            components.push(\r\n                <MenuItem  key={\"item\"+nCycle+\":\"+numPompier+\":\"+i} value={i * 100} align=\"right\" >{i * 100 + \"€\"}</MenuItem>\r\n            )\r\n        }\r\n        return components\r\n    }\r\n    const renderSelectBudgetCycle = (nSeq,nCycle, disabled, numPompier, value) => {\r\n        // console.log(nCycle)\r\n        return (\r\n            <FormControl disabled={disabled}  key={\"select\"+nSeq+\":\"+nCycle+\" : \"+numPompier} variant=\"outlined\">\r\n                <Select\r\n                    value={value}\r\n                    onChange={(value) => handleChangeSelect(numPompier, value)}\r\n                    displayEmpty\r\n                    color=\"secondary\"\r\n                    className={value==0 || disabled ? \"empty\" : \"\"}   \r\n                >\r\n                    <MenuItem value=\"\" disabled align=\"center\">\r\n                        Budget {numPompier}\r\n                    </MenuItem>\r\n\r\n                    {renderPropositionsBudget(nSeq,nCycle, numPompier,value)}\r\n\r\n                </Select >\r\n            </FormControl>\r\n        )\r\n    }\r\n    const renderRowBudgetCycle = (cycle) => {\r\n            var comp = []\r\n            var sum = 0\r\n            if (cycle.numCycle % nbCycleParSeq == 1) {\r\n                comp.push(\r\n                    <TableCell key={\"row\"+cycle+\":\"+0} scope=\"row\" align=\"center\" component=\"th\" rowSpan={nbCycleParSeq}>\r\n                        Séquence n°{cycle.numSeq}\r\n                    </TableCell>\r\n                )\r\n            }\r\n\r\n            comp.push(\r\n                <TableCell key={\"row\"+cycle+\":\"+1} scope=\"row\" align=\"center\" component=\"th\" >\r\n                    Cycle n°{cycle.numCycle}\r\n                </TableCell>\r\n            )\r\n\r\n            const disabled = cycle.numSeq<lastCycle.numSeq || cycle.numCycle<lastCycle.numCycle\r\n            // console.log(disabled)\r\n\r\n            Object.keys(cycle).forEach((key, index) => {\r\n                if (key != \"numCycle\" && key != \"numSeq\") {\r\n                    comp.push(\r\n                        <TableCell scope=\"row\"  key={\"row\"+cycle+\":pomp\"+index} align=\"center\">{renderSelectBudgetCycle(cycle[\"numSeq\"],cycle[\"numCycle\"],disabled, index - 1, cycle[key])}</TableCell>\r\n                    )\r\n                    sum += cycle[key]\r\n                }\r\n            })\r\n            comp.push(\r\n                <TableCell scope=\"row\" align=\"center\" key={1000} >\r\n\r\n                    <TextField\r\n                        variant=\"outlined\"\r\n                        disabled\r\n                        value={sum + \" €\"}\r\n                        inputProps={{\r\n                            style: {\r\n                                color: !(disabled) ? sum > budget.sequence - budget.depense ? \"red\" : \"green\" : null,\r\n                                fontWeight: !disabled ? \"bold\" : null,\r\n                                fontStyle: disabled ? \"italic\" : null ,\r\n                                textAlign: \"center\",\r\n                                backgroundColor: \"#f1f1f1\",\r\n                                borderRadius: 5,\r\n                            },\r\n                        }}\r\n                    />\r\n\r\n                </TableCell>\r\n            )\r\n            return (\r\n                <TableRow hover key={\"row\"+cycle.numSeq + \" : \" + cycle.numCycle+Math.random()} ref={cycle.numCycle >= currentCycle ? lastRow : null}>\r\n                    {comp}\r\n                </TableRow>\r\n            )\r\n\r\n    }\r\n    const renderBudgetsCycles = () => {\r\n        \r\n        if (budgetSim.numCycle !== lastCycle.numCycle ) initLastCycle()\r\n        // if(budgetSim.numCycle<lastCycle.numCycle) setLastCycle(budgetSim)\r\n        const cyclesSorted = [...cycles].sort((a,b)=>a.numCycle-b.numCycle).sort((a,b)=>a.numSeq-b.numSeq)\r\n        // console.log(cycles)\r\n        var components = []\r\n        cyclesSorted.forEach((cycle, index) => {\r\n            // type==\"interventions\" ? Math.floor(currentCycle+(currentSequence-1)*nbCycleParSeq)/nbCycleParSeq-1: currentCycle-1\r\n            if (cycle.numSeq < currentSequence || (cycle.numSeq == currentSequence && cycle.numCycle<currentCycle+1)) {\r\n\r\n            if (cycle.numSeq==localPage+1 ) {\r\n                // console.log(\"render\",localPage,cycle.numCycle,cycle.numSeq)\r\n\r\n                components.push(\r\n                    renderRowBudgetCycle(cycle)\r\n                )\r\n            }\r\n        }\r\n\r\n        })\r\n\r\n        // console.log(lastCycle,localPage)\r\n        if (lastCycle.numSeq==localPage+1) {\r\n            components.push(renderRowBudgetCycle(lastCycle))\r\n        }\r\n\r\n        return (\r\n            components\r\n        )\r\n    }\r\n\r\n\r\n    const renderPropositionsStock = (nSeq,nCycle, numPompier, key) => {\r\n        let cycle = [...cycles].sort((a, b) => a.numCycle - b.numCycle).sort((a, b) => a.numSeq - b.numSeq)[(nSeq-1)*nbCycleParSeq+nCycle - 1]\r\n        if (cycle == null) cycle = {...lastCycle}\r\n\r\n        let sum=0\r\n\r\n        if (cycle != null) {\r\n            Object.keys(cycle).forEach((k) => {\r\n                if (k != \"numCycle\" && k !== \"numSeq\" && k !== \"type\") {\r\n\r\n                    Object.values(cycle[k]).forEach((value, index) => {\r\n                        if ((key!==k ) || numPompier!==index+1 ||( nCycle < lastCycle.numCycle || nSeq<lastCycle.numSeq)) {\r\n                            sum+= value * couts.equipements[\"coutEq\" + k]\r\n                            \r\n                        }\r\n                    });\r\n                }\r\n            })\r\n        }\r\n\r\n        var components = []\r\n        const maxValue = cycle != null && (nCycle < lastCycle.numCycle || nSeq<lastCycle.numSeq) ? Math.floor((sum) / couts.equipements[\"coutEq\" + key]) : Math.floor((budget.sequence - budget.depense - sum) / couts.equipements[\"coutEq\" + key])\r\n       \r\n        \r\n        for (let i = 0; i <= Math.max(0,maxValue); i++) {\r\n            components.push(\r\n                <MenuItem key={nCycle+\":\"+numPompier+\":\"+i} value={i} align=\"right\" >{i}</MenuItem>\r\n            )\r\n        }\r\n        return components\r\n    }\r\n\r\n    const renderSelectStockCycle = (nSeq,nCycle, disabled, numPompier, value, key) => {\r\n        // console.log(value)\r\n        return (\r\n            <FormControl disabled={disabled} variant=\"outlined\" key={nSeq+\":\"+nCycle+\" :\" +numPompier+\":\"+key+Math.random()}>\r\n                <Select\r\n                    value={value}\r\n                    onChange={(value) => handleChangeSelect(numPompier, value, key)}\r\n                    displayEmpty\r\n                    color=\"secondary\"\r\n                    className={value==0 || disabled ? \"empty\" : \"\"}   \r\n\r\n                >\r\n                    <MenuItem value=\"\" disabled align=\"center\">\r\n                        Stock {numPompier}\r\n                    </MenuItem>\r\n\r\n                    {renderPropositionsStock(nSeq,nCycle, numPompier, key)}\r\n\r\n                </Select >\r\n            </FormControl>\r\n        )\r\n    }\r\n\r\n    const renderRowStocksCycle = (cycle, key, data) => {\r\n        if (cycle.numCycle < currentCycle + 2) {\r\n            var comp = []\r\n            var sum = 0\r\n\r\n            // console.log(key,data)\r\n            const nbLignesParCycle = (Object.keys(lastCycle).length - 2)\r\n\r\n            if (key == \"Feu\") {\r\n                // if(cycle.numCycle%nbCycleParSeq==1){\r\n                comp.push(\r\n                    <TableCell key={\"row\"+cycle+\":\"+0} scope=\"row\" align=\"center\" component=\"th\" rowSpan={nbCycleParSeq * (Object.keys(lastCycle).length - 2)}>\r\n                        Séquence n°{cycle.numSeq}\r\n                    </TableCell>\r\n                )\r\n                // }\r\n                comp.push(\r\n                    <TableCell key={\"row\"+cycle+\":\"+1} scope=\"row\" align=\"center\" component=\"th\" rowSpan={Object.keys(lastCycle).length - 2}>\r\n                        Cycle n°{cycle.numCycle}\r\n                    </TableCell>\r\n                )\r\n            }\r\n\r\n            comp.push(\r\n                <TableCell key={\"row\"+cycle+\":\"+2} scope=\"row\" align=\"center\"  >\r\n                    {getText(key!==\"Marqueur\" ? \"Ext\"+key : key)}\r\n                </TableCell>\r\n            )\r\n            const disabled = cycle.numSeq<lastCycle.numSeq || cycle.numCycle<lastCycle.numCycle\r\n            // console.log()\r\n            if (data !== null && data !== undefined) {\r\n                Object.keys(data).forEach((k, index) => {\r\n                    if (k != \"numCycle\" && k != \"numSeq\" && k !== \"type\") {\r\n                        comp.push(\r\n                            <TableCell key={\"row\"+cycle+\":pomp\"+index + 3} align=\"center\" scope=\"row\">{renderSelectStockCycle(cycle.numSeq,cycle.numCycle, disabled, index + 1, data[k], key)}</TableCell>\r\n                        )\r\n                        sum += data[k] * couts.equipements[\"coutEq\" + key]\r\n                    }\r\n                })\r\n            }\r\n\r\n            comp.push(\r\n                <TableCell scope=\"row\" align=\"center\" key={20} >\r\n                    <TextField\r\n                        id=\"outlined-basic\"\r\n                        variant=\"outlined\"\r\n                        disabled\r\n                        value={sum + \" €\"}\r\n                        inputProps={{\r\n                            style: {\r\n                                color: !disabled ? sum > budget.sequence - budget.depense ? \"red\" : \"green\" : null,\r\n                                fontWeight: !disabled? \"bold\" : null,\r\n                                fontStyle: disabled ? \"italic\" : null,\r\n                                textAlign: \"center\",\r\n                                backgroundColor: \"#f1f1f1\",\r\n                                borderRadius: 5,\r\n                                // minWidth: 70\r\n\r\n                            },\r\n                        }}\r\n                    />\r\n                </TableCell>\r\n            )\r\n\r\n            return (\r\n                <TableRow hover key={cycle.numSeq + \" : \" + cycle.numCycle + \" : \" + key+Math.random()} ref={cycle.numCycle >= currentCycle ? lastRow : null}>\r\n                    {comp}\r\n                </TableRow>\r\n            )\r\n\r\n        } else {\r\n            return null\r\n        }\r\n    }\r\n\r\n    const renderStocksCycle = () => {\r\n        if (budgetSim.numCycle !== lastCycle.numCycle ) initLastCycle()\r\n        const cyclesSorted = [...cycles].sort((a, b) => (a.numSeq-b.numSeq)*100+a.numCycle - b.numCycle)\r\n        var components = []\r\n        cyclesSorted.forEach((cycle, index) => {\r\n            if (index == localPage) {\r\n                Object.keys(cycle).forEach(key => {\r\n                    if (key !== \"numSeq\" && key !== \"numCycle\") {\r\n                        components.push(\r\n                            renderRowStocksCycle(cycle, key, cycle[key])\r\n                        )\r\n                    }\r\n                });\r\n            }\r\n        })\r\n        if (localPage == (lastCycle.numSeq-1)*nbCycleParSeq+lastCycle.numCycle - 1) {\r\n            Object.keys(lastCycle).forEach(key => {\r\n                if (key !== \"numSeq\" && key !== \"numCycle\") {\r\n                    components.push(renderRowStocksCycle(lastCycle, key, lastCycle[key]))\r\n\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n        return (\r\n            components\r\n        )\r\n    }\r\n\r\n    const handleChangePage = (event, newPage) => {\r\n        setLocalPage(newPage);\r\n        // console.log(\"new Page\", newPage)\r\n    };\r\n\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <TableContainer component={Paper} className=\"tableau\">\r\n                <Table stickyHeader size=\"small\" >\r\n                    <TableHead>\r\n                        {renderHeaders()}\r\n                    </TableHead>\r\n                    <TableBody>\r\n                        {\r\n                            type == \"interventions\" ?\r\n                                renderBudgetsCycles()\r\n\r\n                                : null\r\n                        }\r\n                        {\r\n                            type == \"equipements\" ?\r\n                                renderStocksCycle()\r\n\r\n                                : null\r\n                        }\r\n\r\n                    </TableBody>\r\n                    <TableFooter>\r\n                        <TableRow key=\"footer-row\">\r\n                            <TablePagination\r\n                                rowsPerPageOptions={[Object.keys(lastCycle).length - 2]}\r\n                                // colSpan={3}\r\n                                count={type == \"interventions\" ? lastCycle.numSeq*nbCycleParSeq : (lastCycle.numSeq-1)*nbCycleParSeq+ lastCycle.numCycle}\r\n                                \r\n                                rowsPerPage={type == \"interventions\" ? nbCycleParSeq : 1}\r\n                                page={localPage}\r\n                                // labelDisplayedRows={({ from, to, count }) => type == \"interventions\" ? \"Séquence n° \" + Math.ceil(from/nbCycleParSeq) + \" | Cycles \"+1+\" - \"+(nbCycleParSeq) : \"Séquence n° \" + Math.ceil(from/nbCycleParSeq) + \"    |    Cycle n° \" + ((to+1)%nbCycleParSeq+1) }\r\n                                labelDisplayedRows={({ from, to, count }) => type == \"interventions\" ? \"Séquence n° \" + Math.ceil(from/nbCycleParSeq) + \" | Cycles \"+1+\" - \"+(nbCycleParSeq) : \"Séquence n° \" + Math.ceil(from/nbCycleParSeq) + \"    |    Cycle n° \" + ((localPage)%nbCycleParSeq+1) }\r\n\r\n                                // SelectProps={{\r\n                                //     inputProps: { 'aria-label': 'rows per page' },\r\n                                //     native: true,\r\n                                // }}\r\n                                onChangePage={handleChangePage}\r\n                            // onRowsPerPageChange={handleChangeRowsPerPage}\r\n                            // ActionsComponent={TablePaginationActions}\r\n                            />\r\n                        </TableRow>\r\n                    </TableFooter>\r\n                </Table>\r\n            </TableContainer>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default InterInterventions;"]},"metadata":{},"sourceType":"module"}