{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import CaseDonnee from'./panels/CaseDonnee';import\"../../styles/InterBandeauTop.css\";import BookmarkRoundedIcon from'@material-ui/icons/BookmarkRounded';import Typography from'@material-ui/core/Typography';import Grid from'@material-ui/core/Grid';import ToggleButtonGroup from'@material-ui/lab/ToggleButtonGroup';import ToggleButton from'@material-ui/lab/ToggleButton';import PlayAPI from\"../../API/PlayAPI\";import ContentsAPI from\"../../API/ContentsAPI\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var InterBandeauTop=function InterBandeauTop(_ref){var numeroPompier=_ref.numeroPompier,numEquipe=_ref.numEquipe,numSession=_ref.numSession,sequence=_ref.sequence,cycle=_ref.cycle,tour=_ref.tour,configuration=_ref.configuration,handleViewChange=_ref.handleViewChange,vue=_ref.vue,interventionsValidated=_ref.interventionsValidated,equipementsValidated=_ref.equipementsValidated,pomp=_ref.pomp,play=_ref.play,handleClicValidated=_ref.handleClicValidated,chronoInit=_ref.chronoInit,validated=_ref.validated;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),textes=_useState2[0],setTextes=_useState2[1];// console.log(chronoInit)\nuseEffect(function(){var getTextes=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var textes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:textes=ContentsAPI.getTexts(\"jeuInterBandeauTop\").then(function(res){setTextes(res);});case 1:case\"end\":return _context.stop();}}},_callee);}));return function getTextes(){return _ref2.apply(this,arguments);};}();if(textes==null){getTextes();}// console.log(textes)\n},[textes]);var getText=function getText(name){if(textes==null){return name;}else{try{return textes[\"label\"+name.charAt(0).toUpperCase()+name.slice(1)].contenu;}catch(error){// console.log(\"label\" + name.charAt(0).toUpperCase() + name.slice(1))\nreturn name;}}};var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),chrono=_useState4[0],setChrono=_useState4[1];useEffect(function(){if(pomp==numeroPompier&&chrono!==null&&play&&chrono>=0){if(chrono>0){var chronoTimer=setInterval(function(){if(chrono%30==0&&chrono>10)PlayAPI.updateCurrentChrono(chrono,numSession,numEquipe);setChrono(function(chrono){return chrono-1;});},1000);}else{// clearInterval(chronoTimer)\n// console.log(\"handle\")\nif(chrono==0){if(!validated.interventions)handleClicValidated(\"interventions\",true);if(!validated.equipements)handleClicValidated(\"equipements\",true);setChrono(-1);}}}else{if(configuration!==null){if(chronoInit==null||chrono==-1){setChrono(-1);}else{setChrono(chronoInit);}}}return function(){clearInterval(chronoTimer);};},[chrono]);useEffect(function(){if(chronoInit!==null&&(chrono>=chronoInit||chrono==-1)&&configuration!==null){setChrono(chronoInit);}});var renderNumEquipe=function renderNumEquipe(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"numEquipe\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"donnees-container\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title label-num-pompier\",children:numEquipe}),/*#__PURE__*/_jsx(BookmarkRoundedIcon,{className:\"icone-num-pompier\",fontSize:\"large\",stroke:\"white\",strokeWidth:1})]})]});};var renderCircleTours=function renderCircleTours(){var type=1,//circle type - 1 whole, 0.5 half, 0.25 quarter\nradius=20,//distance from center\nstart=-90,//shift start from 0\n// $elements = $('li:not(:first-child)'),\nnumberOfElements=configuration.nbPompEquipe.valeur,slice=360*type/numberOfElements;var renderCircleItems=function renderCircleItems(){var items=[];var decalage=1.2;// items.push(\n//     <li\n//         key={\"c\"}\n//         style={{\n//             'transform': 'translate(' + (-radius*decalage*2) + 'px,'+ (-radius*decalage) +'px)',\n//             \"backgroundColor\": tour==-1 ? \"#BF0000\" : null\n//         }}\n//     >\n//         {\"C\"}\n//     </li>\n// )\nitems.push(/*#__PURE__*/_jsx(\"li\",{style:{'transform':'translate('+radius*decalage+'px,'+-radius*decalage+'px)',\"backgroundColor\":pomp==0?\"#BF0000\":null},children:\"S\"},\"s\"));for(var i=0;i<numberOfElements;i++){var rotate=slice*i+start;var rotateReverse=rotate*-1;var decalageCircle=10;items.push(/*#__PURE__*/_jsx(\"li\",{style:{'transform':'rotate('+rotate+'deg) translate('+radius+'px) rotate('+rotateReverse+'deg) translate('+-radius/2+'px) translateY('+decalageCircle+'px)',\"backgroundColor\":i+1==pomp?\"#BF0000\":null},children:i+1},i));}return items;};return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"tourParTour\")}),/*#__PURE__*/_jsx(\"ul\",{children:renderCircleItems()})]});};var renderFeu=function renderFeu(){return/*#__PURE__*/_jsxs(\"div\",{className:\"case-panel\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-title\",children:getText(\"play\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"donnees-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"feu\",children:[/*#__PURE__*/_jsx(\"div\",{className:chrono<30&&chrono>0?\"clignotant animation-reverted\":\"\",style:{backgroundColor:numeroPompier!=pomp?\"#ff0000\":chrono>=0&&chrono<30?\"#E26F00\":\"#9F9F9F\"}}),/*#__PURE__*/_jsx(\"div\",{className:chrono<30&&chrono>0?\"clignotant\":\"\",style:{backgroundColor:numeroPompier==pomp?chrono>=0&&chrono<30?\"#E26F00\":\"#4dff4d\":\"#9F9F9F\"}})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"case-value\",style:{marginTop:\"10%\",width:\"100%\",maxWidth:\"100%\"},children:[Math.floor((chrono>=0?chrono:configuration.chronoTour.valeur)/60).toString().padStart(2,\"0\")+\" : \",/*#__PURE__*/_jsxs(\"span\",{style:{color:chrono<=30&&chrono>0?\"red\":\"inherit\",marginLeft:5},children:[\" \",\" \"+((chrono>=0?chrono:configuration.chronoTour.valeur)%60).toString().padStart(2,\"0\"),\" \"]})]})]})]});};return configuration!=null?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"bandeau-top-right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cases-container\",children:[/*#__PURE__*/_jsx(CaseDonnee,{name:\"sequence\",value:sequence,primary:true,flexFactor:1,textes:textes,data:configuration.nbSequences.valeur}),/*#__PURE__*/_jsx(CaseDonnee,{name:\"cycle\",value:cycle,primary:true,flexFactor:1,textes:textes,data:configuration.nbCyclesParSequence.valeur}),/*#__PURE__*/_jsx(CaseDonnee,{name:\"tour\",value:tour,primary:true,flexFactor:1,textes:textes,data:configuration.nbToursParCycle.valeur}),renderCircleTours(),renderNumEquipe(),renderFeu()]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bandeau-top-left\",children:/*#__PURE__*/_jsxs(ToggleButtonGroup,{value:vue,exclusive:true,onChange:handleViewChange,\"aria-label\":\"text alignment\",className:\"bouton-vue-container\",children:[/*#__PURE__*/_jsxs(ToggleButton,{value:\"operations\",\"aria-label\":\"operations\",className:\"bouton-vue\",children:[/*#__PURE__*/_jsx(Typography,{className:\"label-vue\",variant:\"h5\",children:textes!==null?textes[\"labelOperations\"].titre:\"\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:textes!==null?textes[\"labelOperations\"].contenu:\"\"})]}),/*#__PURE__*/_jsxs(ToggleButton,{value:\"interventions\",\"aria-label\":\"interventions\",className:\"bouton-vue\",children:[/*#__PURE__*/_jsx(Typography,{className:\"label-vue\",variant:\"h5\",children:textes!==null?textes[\"labelInterventions\"].titre:\"\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:textes!==null?textes[\"labelInterventions\"].contenu:\"\"}),/*#__PURE__*/_jsx(\"div\",{className:interventionsValidated?\"indicateur vert\":\"indicateur rouge\",children:/*#__PURE__*/_jsx(\"img\",{src:interventionsValidated?\"assets/validate.png\":\"assets/cancel.png\",alt:\"image\"})})]}),/*#__PURE__*/_jsxs(ToggleButton,{value:\"equipements\",\"aria-label\":\"equipements\",className:\"bouton-vue\",children:[/*#__PURE__*/_jsx(Typography,{className:\"label-vue\",variant:\"h5\",children:textes!==null?textes[\"labelEquipements\"].titre:\"\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:textes!==null?textes[\"labelEquipements\"].contenu:\"\"}),/*#__PURE__*/_jsx(\"div\",{className:equipementsValidated?\"indicateur vert\":\"indicateur rouge\",children:/*#__PURE__*/_jsx(\"img\",{src:equipementsValidated?\"assets/validate.png\":\"assets/cancel.png\",alt:\"image\"})})]})]})})]}):null;};export default InterBandeauTop;","map":{"version":3,"sources":["C:/Users/hugod/decitude/client/src/components/interfaceJoueur/InterBandeauTop.js"],"names":["React","useState","useEffect","CaseDonnee","BookmarkRoundedIcon","Typography","Grid","ToggleButtonGroup","ToggleButton","PlayAPI","ContentsAPI","InterBandeauTop","numeroPompier","numEquipe","numSession","sequence","cycle","tour","configuration","handleViewChange","vue","interventionsValidated","equipementsValidated","pomp","play","handleClicValidated","chronoInit","validated","textes","setTextes","getTextes","getTexts","then","res","getText","name","charAt","toUpperCase","slice","contenu","error","chrono","setChrono","chronoTimer","setInterval","updateCurrentChrono","interventions","equipements","clearInterval","renderNumEquipe","flex","renderCircleTours","type","radius","start","numberOfElements","nbPompEquipe","valeur","renderCircleItems","items","decalage","push","i","rotate","rotateReverse","decalageCircle","renderFeu","backgroundColor","marginTop","width","maxWidth","Math","floor","chronoTour","toString","padStart","color","marginLeft","nbSequences","nbCyclesParSequence","nbToursParCycle","titre"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport CaseDonnee from './panels/CaseDonnee'\r\nimport \"../../styles/InterBandeauTop.css\"\r\nimport BookmarkRoundedIcon from '@material-ui/icons/BookmarkRounded';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport ToggleButtonGroup from '@material-ui/lab/ToggleButtonGroup';\r\nimport ToggleButton from '@material-ui/lab/ToggleButton';\r\n\r\nimport PlayAPI from \"../../API/PlayAPI\"\r\nimport ContentsAPI from \"../../API/ContentsAPI\"\r\n\r\nconst InterBandeauTop = ({\r\n    numeroPompier,\r\n    numEquipe,\r\n    numSession,\r\n    sequence,\r\n    cycle,\r\n    tour,\r\n    configuration,\r\n    handleViewChange,\r\n    vue,\r\n    interventionsValidated,\r\n    equipementsValidated,\r\n    pomp,\r\n    play,\r\n    handleClicValidated,\r\n    chronoInit,\r\n    validated\r\n}) => {\r\n    const [textes, setTextes] = useState(null)\r\n    // console.log(chronoInit)\r\n    useEffect(() => {\r\n        const getTextes = async () => {\r\n            const textes = ContentsAPI.getTexts(\"jeuInterBandeauTop\").then(\r\n                (res) => { setTextes(res) }\r\n            )\r\n        }\r\n        if (textes == null) {\r\n            getTextes()\r\n        }\r\n        // console.log(textes)\r\n    }, [textes])\r\n\r\n   \r\n\r\n\r\n    const getText = (name) => {\r\n        if (textes == null) {\r\n            return name\r\n        } else {\r\n            try {\r\n                return textes[\"label\" + name.charAt(0).toUpperCase() + name.slice(1)].contenu\r\n            } catch (error) {\r\n                // console.log(\"label\" + name.charAt(0).toUpperCase() + name.slice(1))\r\n                return name\r\n            }\r\n        }\r\n    }\r\n\r\n    const [chrono, setChrono] = useState(null)\r\n    useEffect(() => {\r\n        \r\n        if (pomp == numeroPompier && chrono !== null && play && chrono>=0) {\r\n            if (chrono > 0) {\r\n                var chronoTimer = setInterval(() => {\r\n                    if (chrono % 30 == 0 && chrono>10) PlayAPI.updateCurrentChrono(chrono, numSession, numEquipe)\r\n                    setChrono(chrono => chrono - 1)\r\n                    \r\n\r\n                }, 1000)\r\n\r\n            } else {\r\n                // clearInterval(chronoTimer)\r\n                // console.log(\"handle\")\r\n                if(chrono==0){\r\n                    if(!validated.interventions ) handleClicValidated(\"interventions\",true)\r\n                    if(!validated.equipements) handleClicValidated(\"equipements\",true)\r\n                    setChrono(-1)\r\n                }\r\n                \r\n            }\r\n           \r\n        } else {\r\n            if (configuration !== null ) {\r\n                if(chronoInit==null || chrono==-1){\r\n                    setChrono(-1)\r\n                }else{\r\n                    setChrono(chronoInit)\r\n                }\r\n                 \r\n            }\r\n        }\r\n\r\n        return () => {\r\n            clearInterval(chronoTimer)\r\n        }\r\n    }, [chrono])\r\n\r\n    useEffect(()=>{\r\n        if(chronoInit!==null && (chrono>=chronoInit || chrono==-1)   && configuration!==null){\r\n          setChrono(chronoInit)\r\n        }\r\n      })\r\n\r\n\r\n  \r\n\r\n    const renderNumEquipe = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel\"\r\n                style={{\r\n                    flex: 1\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"numEquipe\")}\r\n                </label>\r\n                <div className=\"donnees-container\">\r\n                    <label\r\n                        className=\"label-title label-num-pompier\"\r\n                    >\r\n                        {numEquipe}\r\n                    </label>\r\n                    <BookmarkRoundedIcon\r\n                        className=\"icone-num-pompier\"\r\n                        fontSize=\"large\"\r\n                        stroke={\"white\"}\r\n                        strokeWidth={1}\r\n                    />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderCircleTours = () => {\r\n        var type = 1, //circle type - 1 whole, 0.5 half, 0.25 quarter\r\n            radius = 20, //distance from center\r\n            start = -90, //shift start from 0\r\n            // $elements = $('li:not(:first-child)'),\r\n            numberOfElements = configuration.nbPompEquipe.valeur,\r\n            slice = 360 * type / numberOfElements;\r\n\r\n       \r\n        const renderCircleItems = () => {\r\n            var items = []\r\n            const decalage = 1.2\r\n            // items.push(\r\n            //     <li\r\n            //         key={\"c\"}\r\n            //         style={{\r\n            //             'transform': 'translate(' + (-radius*decalage*2) + 'px,'+ (-radius*decalage) +'px)',\r\n            //             \"backgroundColor\": tour==-1 ? \"#BF0000\" : null\r\n            //         }}\r\n\r\n            //     >\r\n            //         {\"C\"}\r\n            //     </li>\r\n            // )\r\n            items.push(\r\n                <li\r\n                    key={\"s\"}\r\n                    style={{\r\n                        'transform': 'translate(' + (radius*decalage) + 'px,'+ (-radius*decalage) +'px)',\r\n                        \"backgroundColor\": pomp==0 ? \"#BF0000\" : null\r\n                    }}\r\n\r\n                >\r\n                    {\"S\"}\r\n                </li>\r\n            )\r\n\r\n            for (let i = 0; i < numberOfElements; i++) {\r\n                const rotate = slice * i + start\r\n                const rotateReverse = rotate * -1\r\n                const decalageCircle=10\r\n\r\n                items.push(\r\n                    <li\r\n                        key={i}\r\n                        style={{\r\n                            'transform': 'rotate(' + rotate + 'deg) translate(' + radius + 'px) rotate(' + rotateReverse + 'deg) translate(' + -radius / 2 + 'px) translateY('+decalageCircle+'px)',\r\n                            \"backgroundColor\": i + 1 == pomp ? \"#BF0000\" : null\r\n                        }}\r\n\r\n                    >\r\n                        {i + 1}\r\n                    </li>\r\n\r\n                )\r\n            }\r\n            return items\r\n        }\r\n\r\n        return (\r\n            <div\r\n                className=\"case-panel\"\r\n                style={{\r\n                    flex: 1\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"tourParTour\")}\r\n                </label>\r\n                <ul >\r\n                   \r\n                    {renderCircleItems()}\r\n                </ul>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderFeu = () => {\r\n        return (\r\n            <div\r\n                className=\"case-panel\"\r\n                style={{\r\n                    flex: 1\r\n                }}\r\n            >\r\n                <label\r\n                    className=\"label-title\"\r\n                >\r\n                    {getText(\"play\")}\r\n                </label>\r\n\r\n                <div className=\"donnees-container\">\r\n                <div className='feu'>\r\n                        <div\r\n                            className={chrono < 30 && chrono>0? \"clignotant animation-reverted\" : \"\"}\r\n                            style={{ backgroundColor: numeroPompier != pomp ? \"#ff0000\" : chrono>=0 && chrono < 30 ? \"#E26F00\" : \"#9F9F9F\"  }}></div>\r\n                        <div\r\n                            className={chrono < 30 && chrono>0 ? \"clignotant\" : \"\"}\r\n                            style={{ backgroundColor: numeroPompier == pomp ? chrono>=0 && chrono < 30 ? \"#E26F00\" : \"#4dff4d\" : \"#9F9F9F\" }}\r\n                        ></div>\r\n                    </div>\r\n                    <span className=\"case-value\" style={{\r\n                        marginTop: \"10%\",\r\n                        width: \"100%\",\r\n                        maxWidth: \"100%\"\r\n                    }} >\r\n                        {(Math.floor((chrono>=0 ? chrono : configuration.chronoTour.valeur)/ 60)).toString().padStart(2, \"0\") + \" : \"}\r\n                        <span style={{ color: chrono <= 30 && chrono>0? \"red\" : \"inherit\", marginLeft: 5 }}> {\" \" + ((chrono>=0 ? chrono : configuration.chronoTour.valeur) % 60).toString().padStart(2, \"0\")} </span>\r\n                    </span>\r\n                </div>\r\n\r\n\r\n\r\n\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n\r\n\r\n    return (\r\n        configuration != null ?\r\n            <>\r\n                <div className=\"bandeau-top-right\">\r\n\r\n                    <div className=\"cases-container\">\r\n                        <CaseDonnee\r\n                            name={\"sequence\"}\r\n                            value={sequence}\r\n                            primary={true}\r\n                            flexFactor={1}\r\n                            textes={textes}\r\n                            data={configuration.nbSequences.valeur}\r\n                        />\r\n                        <CaseDonnee\r\n                            name={\"cycle\"}\r\n                            value={cycle}\r\n                            primary={true}\r\n                            flexFactor={1}\r\n                            textes={textes}\r\n                            data={configuration.nbCyclesParSequence.valeur}\r\n                        />\r\n                        <CaseDonnee\r\n                            name={\"tour\"}\r\n                            value={tour}\r\n                            primary={true}\r\n                            flexFactor={1}\r\n                            textes={textes}\r\n                            data={configuration.nbToursParCycle.valeur}\r\n                        />\r\n                        {/* <CaseDonnee\r\n                        name={\"budgetRestant\"}\r\n                        value={budget+\" â‚¬\"}\r\n                        primary={true}\r\n                        flexFactor={1}\r\n                        textes={textes}\r\n\r\n                    /> */}\r\n                        {renderCircleTours()}\r\n                        {renderNumEquipe()}\r\n                        {renderFeu()}\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n\r\n                <div className=\"bandeau-top-left\">\r\n                    <ToggleButtonGroup\r\n                        value={vue}\r\n                        exclusive\r\n                        onChange={handleViewChange}\r\n                        aria-label=\"text alignment\"\r\n                        className='bouton-vue-container'\r\n                    >\r\n                        <ToggleButton value=\"operations\" aria-label=\"operations\" className='bouton-vue'>\r\n                            <Typography\r\n                                className=\"label-vue\"\r\n                                variant=\"h5\" >{textes!==null ? textes[\"labelOperations\"].titre : \"\"}</Typography>\r\n                            <Typography variant=\"h6\">\r\n                                {textes!==null ? textes[\"labelOperations\"].contenu : \"\"}\r\n                            </Typography>\r\n                        </ToggleButton>\r\n                        <ToggleButton value=\"interventions\" aria-label=\"interventions\" className='bouton-vue'>\r\n                        <Typography\r\n                                className=\"label-vue\"\r\n                                variant=\"h5\" >{textes!==null ? textes[\"labelInterventions\"].titre : \"\"}</Typography>\r\n                            <Typography variant=\"h6\">\r\n                                {textes!==null ? textes[\"labelInterventions\"].contenu : \"\"}\r\n                            </Typography>\r\n                            <div\r\n                                className={interventionsValidated ? \"indicateur vert\" : \"indicateur rouge\"}\r\n                            >\r\n                                <img src={\r\n                                    interventionsValidated? \"assets/validate.png\" : \"assets/cancel.png\"\r\n                                    } alt={\"image\"} />\r\n                            </div>\r\n                        </ToggleButton>\r\n                        <ToggleButton value=\"equipements\" aria-label=\"equipements\" className='bouton-vue'>\r\n                        <Typography\r\n                                className=\"label-vue\"\r\n                                variant=\"h5\" >{textes!==null ? textes[\"labelEquipements\"].titre : \"\"}</Typography>\r\n                            <Typography variant=\"h6\">\r\n                                {textes!==null ? textes[\"labelEquipements\"].contenu : \"\"}\r\n                            </Typography>\r\n                            <div\r\n                                className={equipementsValidated? \"indicateur vert\" : \"indicateur rouge\"}\r\n                            >\r\n                                <img src={\r\n                                    equipementsValidated? \"assets/validate.png\" : \"assets/cancel.png\"\r\n                                    } alt={\"image\"} />\r\n                            </div>\r\n                        </ToggleButton>\r\n                    </ToggleButtonGroup>\r\n                </div>\r\n\r\n            </>\r\n\r\n\r\n            :\r\n            null\r\n\r\n\r\n    );\r\n}\r\n\r\nexport default InterBandeauTop;"]},"metadata":{},"sourceType":"module"}