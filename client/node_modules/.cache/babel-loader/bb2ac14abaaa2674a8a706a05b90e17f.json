{"ast":null,"code":"import _slicedToArray from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState,useEffect,useLayoutEffect}from'react';import MurPiece from\"./MurPiece\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CasePiece=function CasePiece(_ref){var murs=_ref.murs,type=_ref.type,coordX=_ref.coordX,coordY=_ref.coordY,nbColonnesPiece=_ref.nbColonnesPiece,nbLignesPiece=_ref.nbLignesPiece,nbColonnesGrille=_ref.nbColonnesGrille,nbLignesGrille=_ref.nbLignesGrille,anchor=_ref.anchor,propositionMursDetruire=_ref.propositionMursDetruire,propositionsCase=_ref.propositionsCase,handleClicMur=_ref.handleClicMur,handleClicCase=_ref.handleClicCase,mursH=_ref.mursH,mursV=_ref.mursV,position=_ref.position,idPiece=_ref.idPiece,deplacementEnCours=_ref.deplacementEnCours;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),height=_useState2[0],setHeight=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),width=_useState4[0],setWidth=_useState4[1];var colorClignotant=\"#E26F00\";var colorCache=\"#D1D1D1\";var colorFondPosition=\"white\";var colorFondPiece=\"#EEEEEE\";var element=useRef();var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),contentDisplayed=_useState6[0],setContentDisplayed=_useState6[1];useLayoutEffect(function(){function updateSize(){setHeight(element.current.clientHeight);setWidth(element.current.clientWidth);}setContentDisplayed(true);window.addEventListener('resize',updateSize);updateSize();return function(){return window.removeEventListener('resize',updateSize);};},[]);var renderMurs=function renderMurs(){var mursComponents=[];for(var i=0;i<4;i++){mursComponents.push(/*#__PURE__*/_jsx(MurPiece,{num:i,height:height,width:width,type:murs[i],coordX:coordX,coordY:coordY,anchor:anchor,nbColonnesPiece:nbColonnesPiece,nbLignesPiece:nbLignesPiece,nbColonnesGrille:nbColonnesGrille,nbLignesGrille:nbLignesGrille,propositionMursDetruire:propositionMursDetruire,handleClicMur:handleClicMur,mursH:mursH,mursV:mursV},i));}return/*#__PURE__*/_jsx(_Fragment,{children:mursComponents});};var renderContenuCase=function renderContenuCase(){var opacity=0;var source=\"\";var sourceCasque=\"\";var rotate=-90;var align=\"center\";var justify=\"center\";if(Math.floor(type/1000)==1){// POMPIER.\nsourceCasque=\"assets/Casque\"+(type%1000-type%100)/100+\".png\";if(type%100<10){// POMPIER SEUL\nopacity=1;if(position[0]==coordY&&position[1]==coordX){// CASE DU JOUEUR\nsource=\"assets/Pompier0\"+(deplacementEnCours!==null&&deplacementEnCours!==undefined?deplacementEnCours.type:\"0\")+\".png\";}else{source=\"assets/Pompier00.png\";}}else{// POMPIER HABITANT\nopacity=1;source=\"assets/PompierHabitant\"+(type%100-type%10)/10+\".png\";}if(deplacementEnCours!==null&&deplacementEnCours!==undefined&&position[0]==coordY&&position[1]==coordX){switch(deplacementEnCours.rotation){case 1:// HAUT\nrotate=-90;switch(deplacementEnCours.type){case 1:align=\"flex-start\";break;case 2:align=\"flex-end\";break;}break;case 2:// DROITE\nrotate=0;switch(deplacementEnCours.type){case 1:justify=\"flex-end\";break;case 2:justify=\"flex-start\";break;}break;case 3:// BAS\nrotate=90;switch(deplacementEnCours.type){case 1:align=\"flex-end\";break;case 2:align=\"flex-start\";break;}break;case 4:// GAUCHE\nrotate=180;switch(deplacementEnCours.type){case 1:justify=\"flex-start\";break;case 2:justify=\"flex-end\";break;}break;default:rotate=0;break;}}else{switch(type%10){case 1:rotate=-90;break;case 2:rotate=0;break;case 3:rotate=90;break;case 4:rotate=180;break;default:rotate=-90;break;}}}else{// console.log(anchor)\nif(position[0]<nbLignesPiece+anchor[0]&&position[1]<nbColonnesPiece+anchor[1]){// console.log(\"test2\")\nif(Math.floor(type/10)==2){source=\"assets/Habitant0.png\";if(position!==null&&position[0]-1==coordY&&position[1]==coordX&&type>20)source=\"assets/Habitant\"+type%10+\".png\";// CASE DESSUS\nif(position!==null&&position[0]==coordY&&position[1]+1==coordX&&type>20)source=\"assets/Habitant\"+type%10+\".png\";// CASE DROITE\nif(position!==null&&position[0]+1==coordY&&position[1]==coordX&&type>20)source=\"assets/Habitant\"+type%10+\".png\";// CASE DESSOUS\nif(position!==null&&position[0]==coordY&&position[1]-1==coordX&&type>20)source=\"assets/Habitant\"+type%10+\".png\";// CASE GAUCHE\nopacity=1;rotate=0;}else if(type==3){opacity=1;source=\"assets/Fumee.png\";rotate=Math.random()*360;}else if(type==4){opacity=1;source=\"assets/Flamme2.png\";rotate=Math.random()*360;}else{if(position!==null&&position[0]-1==coordY&&position[1]==coordX&&deplacementEnCours.type==1&&deplacementEnCours.rotation==1)align=\"flex-end\";// CASE DESSUS\nif(position!==null&&position[0]==coordY&&position[1]+1==coordX&&deplacementEnCours.type==1&&deplacementEnCours.rotation==2)align=\"flex-start\";// CASE DROITE\nif(position!==null&&position[0]+1==coordY&&position[1]==coordX&&deplacementEnCours.type==1&&deplacementEnCours.rotation==3)align=\"flex-start\";// CASE DESSOUS\nif(position!==null&&position[0]==coordY&&position[1]-1==coordX&&deplacementEnCours.type==1&&deplacementEnCours.rotation==4)align=\"flex-end\";// CASE GAUCHE\nrotate=0;}}// console.log(source,rotate,opacity)\n}return/*#__PURE__*/_jsxs(\"div\",{style:{position:\"absolute\",display:\"flex\",opacity:position[0]==coordY&&position[1]==coordX?opacity:1,width:\"100%\",height:\"100%\",alignItems:align,justifyContent:justify// zIndex:1\n},children:[/*#__PURE__*/_jsx(\"img\",{style:{// maxHeight: height * 0.9,\n// maxWidth: width * 0.8,\nposition:\"absolute\",display:!contentDisplayed&&position[0]==coordY&&position[1]==coordX?\"none\":\"\",maxWidth:Math.floor(type/1000)==1&&type%100>=10?\"85%\":\"90%\",height:Math.floor(type/1000)==1&&type%100>=10?\"80%\":\"90%\",objectFit:\"contain\",transform:rotate!==undefined?\"rotate(\"+rotate+\"deg)\":\"\",zIndex:4},src:source// onError={(evt)=>{\n//     setContentDisplayed(false)\n// }}\n// onLoad={()=>setContentDisplayed(true)}\n}),sourceCasque!==\"\"?/*#__PURE__*/_jsx(\"img\",{style:{position:\"absolute\",display:!contentDisplayed&&position[0]==coordY&&position[1]==coordX?\"none\":\"\",maxWidth:Math.floor(type/1000)==1&&type%100>=10?\"85%\":\"90%\",height:Math.floor(type/1000)==1&&type%100>=10?\"80%\":\"90%\",objectFit:\"contain\",transform:rotate!==undefined?\"rotate(\"+rotate+\"deg)\":\"\",zIndex:10},src:sourceCasque// onError={(evt)=>{\n//     setContentDisplayed(false)\n// }}\n// onLoad={()=>setContentDisplayed(true)}\n}):null]});};var renderCase=function renderCase(){var source=idPiece!==null&&idPiece!==undefined?\"assets/Sol_0\"+(idPiece%6+1)+\".png\":null;return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flex:1,width:\"100%\",// height: \"100%\",\njustifyContent:\"center\",alignItems:\"center\"// zIndex:0\n},children:[source!==null?/*#__PURE__*/_jsx(\"img\",{style:{position:\"absolute\",width:\"100%\",height:\"100%\",objectFit:\"cover\",filter:\"brightness(0.90) grayscale(5%) contrast(95%)\"},src:source}):null,renderContenuCase()]});};var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),clignotant=_useState8[0],setClignotant=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),valeurApres=_useState10[0],setValeurApres=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),valeurAvant=_useState12[0],setValeurAvant=_useState12[1];var checkInCoords=function checkInCoords(){var checked=false;if(propositionsCase!==null&&propositionsCase!==undefined){var valApres=null;var valAvant=null;propositionsCase.forEach(function(coords){if(coords[0]==coordY&&coords[1]==coordX){checked=true;valAvant=coords[2];valApres=coords[3];}});if(checked&&valApres!=null){setValeurAvant(valAvant);setValeurApres(valApres);}}return checked;};// useEffect(()=>{\n//     console.log(valeurApres)\n// },[valeurApres])\nuseEffect(function(){setClignotant(checkInCoords());});return/*#__PURE__*/_jsxs(\"div\",{ref:element,className:clignotant?\"clignotant case-piece\":\"case-piece\",style:{backgroundColor:clignotant?colorClignotant:type>=0?position[0]==coordY&&position[1]==coordX?colorFondPosition:colorFondPiece:colorCache,// -1 caché\"\ntransition:\"2s\",filter:position[0]==coordY&&position[1]==coordX?\"brightness(1.2)\":\"\"},onClick:clignotant?function(){return handleClicCase(valeurAvant,valeurApres,coordX,coordY);}:null,children:[renderMurs(),renderCase()]});};export default CasePiece;","map":{"version":3,"sources":["C:/Users/hugod/decitude/client/src/components/interfaceJoueur/pieces/CasePiece.js"],"names":["React","useRef","useState","useEffect","useLayoutEffect","MurPiece","CasePiece","murs","type","coordX","coordY","nbColonnesPiece","nbLignesPiece","nbColonnesGrille","nbLignesGrille","anchor","propositionMursDetruire","propositionsCase","handleClicMur","handleClicCase","mursH","mursV","position","idPiece","deplacementEnCours","height","setHeight","width","setWidth","colorClignotant","colorCache","colorFondPosition","colorFondPiece","element","contentDisplayed","setContentDisplayed","updateSize","current","clientHeight","clientWidth","window","addEventListener","removeEventListener","renderMurs","mursComponents","i","push","renderContenuCase","opacity","source","sourceCasque","rotate","align","justify","Math","floor","undefined","rotation","random","display","alignItems","justifyContent","maxWidth","objectFit","transform","zIndex","renderCase","flex","filter","clignotant","setClignotant","valeurApres","setValeurApres","valeurAvant","setValeurAvant","checkInCoords","checked","valApres","valAvant","forEach","coords","backgroundColor","transition"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect, useLayoutEffect } from 'react'\nimport MurPiece from \"./MurPiece\"\n\nconst CasePiece = ({\n    murs,\n    type,\n    coordX,\n    coordY,\n    nbColonnesPiece,\n    nbLignesPiece,\n    nbColonnesGrille,\n    nbLignesGrille,\n    anchor,\n    propositionMursDetruire,\n    propositionsCase,\n    handleClicMur,\n    handleClicCase,\n    mursH,\n    mursV,\n    position,\n    idPiece,\n    deplacementEnCours\n}) => {\n    const [height, setHeight] = useState(0)\n    const [width, setWidth] = useState(0)\n\n    const colorClignotant = \"#E26F00\"\n    const colorCache = \"#D1D1D1\"\n    const colorFondPosition = \"white\"\n    const colorFondPiece = \"#EEEEEE\"\n\n    const element = useRef()\n\n\n    const [contentDisplayed,setContentDisplayed]=useState(false)\n\n    useLayoutEffect(() => {\n        function updateSize() {\n            setHeight(element.current.clientHeight)\n            setWidth(element.current.clientWidth)\n        }\n        setContentDisplayed(true)\n        window.addEventListener('resize', updateSize);\n        updateSize();\n        return () => window.removeEventListener('resize', updateSize);\n    }, []);\n\n    const renderMurs = () => {\n        var mursComponents = []\n        for (let i = 0; i < 4; i++) {\n\n            mursComponents.push(\n                <MurPiece\n                    key={i}\n                    num={i}\n                    height={height}\n                    width={width}\n                    type={murs[i]}\n                    coordX={coordX}\n                    coordY={coordY}\n                    anchor={anchor}\n                    nbColonnesPiece={nbColonnesPiece}\n                    nbLignesPiece={nbLignesPiece}\n                    nbColonnesGrille={nbColonnesGrille}\n                    nbLignesGrille={nbLignesGrille}\n                    propositionMursDetruire={propositionMursDetruire}\n                    handleClicMur={handleClicMur}\n                    mursH={mursH}\n                    mursV={mursV}\n                />\n            )\n        }\n        return (\n            <>\n                {mursComponents}\n            </>\n        )\n    }\n\n\n    const renderContenuCase = () => {\n        let opacity = 0\n        let source = \"\"\n        var sourceCasque = \"\"\n        var rotate=-90\n\n        \n        \n        let align=\"center\"\n        let justify=\"center\"\n\n        if (Math.floor(type / 1000) == 1) { // POMPIER.\n            sourceCasque=\"assets/Casque\"+(type % 1000 - type % 100) / 100+\".png\"\n            if (type % 100 < 10) { // POMPIER SEUL\n                opacity = 1\n                if(position[0] == coordY && position[1] == coordX){ // CASE DU JOUEUR\n                    source = \"assets/Pompier0\"+(deplacementEnCours!==null && deplacementEnCours!==undefined ? deplacementEnCours.type : \"0\")+\".png\"\n                }else{\n                    source = \"assets/Pompier00.png\"\n                }\n                \n\n            } else { // POMPIER HABITANT\n                opacity = 1\n                source = \"assets/PompierHabitant\" + (type % 100 - type % 10) / 10 + \".png\"\n            }\n\n            if(deplacementEnCours!==null && deplacementEnCours!==undefined && position[0] == coordY && position[1] == coordX){\n                switch (deplacementEnCours.rotation) {\n                    \n                    case 1: // HAUT\n                        rotate = -90\n                        switch (deplacementEnCours.type) {\n                            case 1:\n                                align=\"flex-start\"\n                                break;\n                        \n                            case 2:\n                                align=\"flex-end\"\n                                break;\n                        }\n                        break;\n                    case 2: // DROITE\n                        rotate = 0\n                        switch (deplacementEnCours.type) {\n                            case 1:\n                                justify=\"flex-end\"\n                                break;\n                        \n                            case 2:\n                                justify=\"flex-start\"\n                                break;\n                        }\n                        break;\n                    case 3: // BAS\n                        rotate = 90\n                        switch (deplacementEnCours.type) {\n                            case 1:\n                                align=\"flex-end\"\n                                break;\n                        \n                            case 2:\n                                align=\"flex-start\"\n                                break;\n                        }\n                        break;\n                    case 4: // GAUCHE\n                        rotate = 180\n                        switch (deplacementEnCours.type) {\n                            case 1:\n                                justify=\"flex-start\"\n                                break;\n                        \n                            case 2:\n                                justify=\"flex-end\"\n                                break;\n                        }\n                        break;\n                    default:\n                        rotate = 0\n                        break;\n                }\n           \n    \n            }else{\n                switch (type%10) {\n                    case 1:\n                        rotate = -90\n                        break;\n                    case 2:\n                        rotate = 0\n                        break;\n                    case 3:\n                        rotate = 90\n                        break;\n                    case 4:\n                        rotate = 180\n                        break;\n                    default:\n                        rotate=-90\n                        break;\n                }\n            }\n            \n        } else{\n            // console.log(anchor)\n            if(position[0] < nbLignesPiece+anchor[0] && position[1]< nbColonnesPiece+anchor[1] ){\n                \n                // console.log(\"test2\")\n                if (Math.floor(type / 10) == 2) {\n                    source = \"assets/Habitant0.png\"\n                    if( position!==null && position[0]-1 == coordY && position[1] == coordX && type>20) source = \"assets/Habitant\"+type%10+\".png\"// CASE DESSUS\n                    if( position!==null && position[0] == coordY && position[1] +1 == coordX && type>20) source = \"assets/Habitant\"+type%10+\".png\"// CASE DROITE\n                    if( position!==null && position[0]+1 == coordY && position[1] == coordX && type>20) source = \"assets/Habitant\"+type%10+\".png\"// CASE DESSOUS\n                    if( position!==null && position[0] == coordY && position[1]-1== coordX && type>20) source = \"assets/Habitant\"+type%10+\".png\"// CASE GAUCHE\n                    opacity = 1\n                    rotate=0\n\n\n\n                } else if (type == 3) {\n                    opacity = 1\n                    source = \"assets/Fumee.png\"\n                    rotate=Math.random()*360\n                }\n                else if (type == 4) {\n                    opacity = 1\n                    source = \"assets/Flamme2.png\"\n                    rotate=Math.random()*360\n                }else{\n                    \n                    if( position!==null && position[0]-1 == coordY && position[1] == coordX && deplacementEnCours.type==1 && deplacementEnCours.rotation==1) align=\"flex-end\"// CASE DESSUS\n                    if( position!==null && position[0] == coordY && position[1] +1 == coordX && deplacementEnCours.type==1 && deplacementEnCours.rotation==2) align=\"flex-start\"// CASE DROITE\n                    if( position!==null && position[0]+1 == coordY && position[1] == coordX && deplacementEnCours.type==1 && deplacementEnCours.rotation==3) align=\"flex-start\"// CASE DESSOUS\n                    if( position!==null && position[0] == coordY && position[1]-1== coordX && deplacementEnCours.type==1 && deplacementEnCours.rotation==4) align=\"flex-end\"// CASE GAUCHE\n            \n                    rotate=0\n                    \n                }\n            }\n\n           \n\n            // console.log(source,rotate,opacity)\n        } \n\n\n\n        return (\n            <div\n                style={{\n                    position:\"absolute\",\n                    display:\"flex\",\n                    opacity: position[0] == coordY && position[1] == coordX ? opacity : 1,\n                    \n                    width:\"100%\",\n                    height:\"100%\",\n                    alignItems:align,\n                    justifyContent:justify,\n                    // zIndex:1\n                    \n                }}\n            >\n\n                \n               \n                <img\n                    style={{\n                        // maxHeight: height * 0.9,\n                        // maxWidth: width * 0.8,\n                        position:\"absolute\",\n                        display:!contentDisplayed && position[0] == coordY && position[1] == coordX ? \"none\" : \"\",\n                        maxWidth:Math.floor(type / 1000) == 1 && type%100>=10 ? \"85%\":\"90%\",\n                        height:Math.floor(type / 1000) == 1 && type%100>=10 ? \"80%\":\"90%\",\n                        objectFit: \"contain\",\n                        transform: rotate !== undefined ? \"rotate(\" + rotate + \"deg)\" : \"\",\n                        zIndex:4\n                    }}\n                    src={source}\n                    // onError={(evt)=>{\n                    //     setContentDisplayed(false)\n                    // }}\n                    // onLoad={()=>setContentDisplayed(true)}\n                />\n                {sourceCasque!==\"\" ?\n                 <img\n                 style={{\n                     position:\"absolute\",\n                     display:!contentDisplayed && position[0] == coordY && position[1] == coordX ? \"none\" : \"\",\n                     maxWidth:Math.floor(type / 1000) == 1 && type%100>=10 ? \"85%\":\"90%\",\n                     height:Math.floor(type / 1000) == 1 && type%100>=10 ? \"80%\":\"90%\",\n                     objectFit: \"contain\",\n                     transform: rotate !== undefined ? \"rotate(\" + rotate + \"deg)\" : \"\",\n                     zIndex:10\n                 }}\n                 src={sourceCasque}\n                 // onError={(evt)=>{\n                 //     setContentDisplayed(false)\n                 // }}\n                 // onLoad={()=>setContentDisplayed(true)}\n             />\n                :\n                null\n                } \n            </div>\n        )\n    }\n\n\n    const renderCase = () => {\n        const source = idPiece!==null && idPiece!==undefined ? \"assets/Sol_0\"+((idPiece)%6+1)+\".png\" : null\n\n\n        return (\n            <div \n                style={{\n                    display:\"flex\",\n                    flex:1,\n                    width: \"100%\",\n                    // height: \"100%\",\n                    justifyContent:\"center\",\n                    alignItems:\"center\",\n                    // zIndex:0\n                }}\n            >\n                {source!==null ? \n                <img\n                style={{\n                    position:\"absolute\",\n                    width: \"100%\",\n                    height: \"100%\",\n                    objectFit: \"cover\",\n                    filter: \"brightness(0.90) grayscale(5%) contrast(95%)\",\n                    \n                }}\n                src={source}\n                \n            />\n            : null}\n                \n                {renderContenuCase()}\n            </div>\n\n        )\n    }\n\n\n\n    const [clignotant, setClignotant] = useState(false)\n    const [valeurApres, setValeurApres] = useState(null)\n    const [valeurAvant, setValeurAvant] = useState(null)\n    const checkInCoords = () => {\n        var checked = false\n        if (propositionsCase !== null && propositionsCase !== undefined) {\n            var valApres = null\n            var valAvant = null\n            propositionsCase.forEach((coords) => {\n                if (coords[0] == coordY && coords[1] == coordX) {\n                    checked = true\n                    valAvant = coords[2]\n                    valApres = coords[3]\n                }\n            });\n\n            if (checked && valApres != null) {\n                setValeurAvant(valAvant)\n                setValeurApres(valApres)\n            }\n        }\n\n        return checked\n\n    }\n\n    // useEffect(()=>{\n    //     console.log(valeurApres)\n    // },[valeurApres])\n\n\n\n    useEffect(() => {\n        setClignotant(checkInCoords())\n    })\n\n\n    return (\n\n        <div\n\n            ref={element}\n            className={clignotant ? \"clignotant case-piece\" : \"case-piece\"}\n            style={{\n                backgroundColor: clignotant ? colorClignotant : (type >= 0 ? (position[0] == coordY && position[1] == coordX ? colorFondPosition : colorFondPiece) : colorCache), // -1 caché\"\n                transition: \"2s\",\n                filter: position[0] == coordY && position[1] == coordX ? \"brightness(1.2)\" :\"\"\n            }}\n            onClick={clignotant ? () => handleClicCase(valeurAvant, valeurApres, coordX, coordY)\n                : null}\n        >\n            {renderMurs()}\n            {renderCase()}\n\n        </div>\n\n    );\n}\n\nexport default CasePiece;"]},"metadata":{},"sourceType":"module"}