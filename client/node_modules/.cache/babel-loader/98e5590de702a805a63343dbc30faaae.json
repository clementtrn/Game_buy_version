{"ast":null,"code":"import _objectSpread from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/hugod/decitude/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"../styles/App.css\";import React,{useState,useEffect,useRef}from'react';import PlayAPI from\"../API/PlayAPI\";import InterBandeauTop from\"../components/interfaceJoueur/InterBandeauTop\";import InterBandeauBottom from\"../components/interfaceJoueur/InterBandeauBottom\";import Grille from\"../components/interfaceJoueur/Grille\";import InterInterventions from\"../components/interfaceJoueur/InterInterventions\";import{useHistory}from'react-router-dom';import io from'socket.io-client';import cookie from'react-cookies';import InterBandeauDroite from\"../components/interfaceJoueur/InterBandeauDroite\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var InterInterface=function InterInterface(){var history=useHistory();var user=cookie.load(\"user\");var handleDisconnect=function handleDisconnect(){cookie.save('user',\"disconnected\",{path:'/',maxAge:60*60*1.5//sec\n});history.push('/login');};if(user===null||user===undefined||user==\"disconnected\")history.push(\"/login\");if(user!==null&&user!==undefined&&user.role!==undefined&&!user.role.includes(\"INTER\"))handleDisconnect();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),play=_useState2[0],setPlay=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),numPompier=_useState4[0],setNumPompier=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),currentPomp=_useState6[0],setCurrentPomp=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),currentTour=_useState8[0],setCurrentTour=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),currentCycle=_useState10[0],setCurrentCycle=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),currentSequence=_useState12[0],setCurrentSequence=_useState12[1];var _useState13=useState(user!==null&&user!==undefined?user.session:null),_useState14=_slicedToArray(_useState13,2),session=_useState14[0],setSession=_useState14[1];var _useState15=useState(user!==null&&user!==undefined?user.equipe:null),_useState16=_slicedToArray(_useState15,2),equipe=_useState16[0],setEquipe=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),chrono=_useState18[0],setChrono=_useState18[1];var _useState19=useState(\"operations\"),_useState20=_slicedToArray(_useState19,2),vue=_useState20[0],setVue=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),configuration=_useState22[0],setConfiguration=_useState22[1];var _useState23=useState(null),_useState24=_slicedToArray(_useState23,2),couts=_useState24[0],setCouts=_useState24[1];var _useState25=useState({Decedes:0,Sauves:0,Marqueur:0}),_useState26=_slicedToArray(_useState25,2),resultats=_useState26[0],setResultats=_useState26[1];var _useState27=useState({sequence:0,depense:0}),_useState28=_slicedToArray(_useState27,2),budget=_useState28[0],setBudget=_useState28[1];var _useState29=useState(null),_useState30=_slicedToArray(_useState29,2),cycles=_useState30[0],setCycles=_useState30[1];useEffect(function(){if(configuration!=null){setCouts({interventions:{coutInterDeplacement:configuration.coutInterDeplacement.valeur,coutInterFeu:configuration.coutInterFeu.valeur,coutInterFeuFum:configuration.coutInterFeuFum.valeur,coutInterFum:configuration.coutInterFum.valeur,coutInterMarqueur:configuration.coutInterMarqueur.valeur,coutInterPorte:configuration.coutInterPorte.valeur,coutInterHab:configuration.coutInterHabitant.valeur},equipements:{coutEqFeu:configuration.coutEqFeu.valeur,coutEqFeuFum:configuration.coutEqFeuFum.valeur,coutEqFum:configuration.coutEqFum.valeur,coutEqMarqueur:configuration.coutEqMarqueur.valeur}});setBudget({interventions:{sequence:configuration.budgetDefaultInter.valeur,depense:0},equipements:{sequence:configuration.budgetDefaultInter.valeur,depense:0}});if(cycles!=null){initInfos(cycles);}}},[configuration]);var _useState31=useState(null),_useState32=_slicedToArray(_useState31,2),budgetSim=_useState32[0],setBudgetSim=_useState32[1];useEffect(function(){if(cycles!=null){console.log(\"save bdg init\");PlayAPI.saveBudgetsPompInit(cycles,session,equipe).then(function(){if(configuration!=null){initInfos(cycles);}if(budgetSim==null||budgetSim.interventions==undefined||budgetSim.interventions.numCycle!==cycles.interventions.length%2+1||budgetSim.equipements.numCycle!==cycles.equipements.length%2+1){setBudgetSim({interventions:{numSeq:cycles.interventions.length>1?cycles.interventions.length%2==0?cycles.interventions[cycles.interventions.length-1].numSeq+1:cycles.interventions[cycles.interventions.length-1].numSeq:1,numCycle:cycles.interventions.length%2+1,pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0},equipements:{numSeq:cycles.equipements.length>1?cycles.equipements.length%2==0?cycles.equipements[cycles.equipements.length-1].numSeq+1:cycles.equipements[cycles.equipements.length-1].numSeq:1,numCycle:cycles.equipements.length%2+1,Feu:{pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0},FeuFum:{pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0},Fum:{pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0},Marqueur:{pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0}}});}});}// console.log(cycles.equipements)\n},[cycles]);var _useState33=useState({interventions:false,equipements:false}),_useState34=_slicedToArray(_useState33,2),validated=_useState34[0],setValidated=_useState34[1];// const [page, setPage] = useState({\n//   interventions: 0,\n//   equipements: 0\n// })\nvar isLoading=useRef(false);// INITIALISATION DE LA CARTE\nvar _useState35=useState([[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),_useState36=_slicedToArray(_useState35,2),carte=_useState36[0],setCarte=_useState36[1];// const [carte, setCarte] = useState([])\nvar _useState37=useState(0),_useState38=_slicedToArray(_useState37,2),nbLignesGrille=_useState38[0],setNbLignesGrille=_useState38[1];var _useState39=useState(0),_useState40=_slicedToArray(_useState39,2),nbColonnesGrille=_useState40[0],setNbColonnesGrille=_useState40[1];var _useState41=useState(null),_useState42=_slicedToArray(_useState41,2),position=_useState42[0],setPosition=_useState42[1];var _useState43=useState([[1,1,1,1,1,1,2,6,1,1,1,1,2,5,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,2,6,1,6,2,1,1,1,5,2,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,6,2,1,1,1,1,1,1,1,1]]),_useState44=_slicedToArray(_useState43,2),mursH=_useState44[0],setMursH=_useState44[1];var _useState45=useState([[1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1],[2,0,0,5,0,0,0,0,0,0,0,1,0,0,0,0,1],[5,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1],[1,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,1],[1,0,0,0,0,0,2,0,0,0,5,0,0,0,0,0,1],[1,0,0,0,0,0,5,0,0,0,5,0,0,0,0,0,2],[1,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,5]]),_useState46=_slicedToArray(_useState45,2),mursV=_useState46[0],setMursV=_useState46[1];var getNombreMarqueur=function getNombreMarqueur(mursH,mursV){var nbMarqueur=0;mursH.forEach(function(ligne){ligne.forEach(function(valeur){if(valeur==3)nbMarqueur=nbMarqueur+1;if(valeur==4)nbMarqueur=nbMarqueur+2;});});mursV.forEach(function(ligne){ligne.forEach(function(valeur){if(valeur==3)nbMarqueur=nbMarqueur+1;if(valeur==4)nbMarqueur=nbMarqueur+2;});});return nbMarqueur;};// GET PLAY PARAMETERS \nvar initInfos=function initInfos(cycles){if(cycles!==null&&configuration!==null){console.log(\"init infos\");var lastCycleEq=_toConsumableArray(cycles.equipements).sort(function(a,b){return(a.numSeq-b.numSeq)*100+a.numCycle-b.numCycle;})[_toConsumableArray(cycles.equipements).length-1];var lastCycleInter=_toConsumableArray(cycles.interventions).sort(function(a,b){return(a.numSeq-b.numSeq)*100+a.numCycle-b.numCycle;})[_toConsumableArray(cycles.interventions).length-1];var val={interventions:false,equipements:false};if(lastCycleInter!==null&&lastCycleInter!==undefined&&lastCycleInter.numSeq==currentSequence&&lastCycleInter.numCycle==currentCycle)val.interventions=true;if(lastCycleEq!==null&&lastCycleEq!==undefined&&lastCycleEq.numSeq==currentSequence&&lastCycleEq.numCycle==currentCycle)val.equipements=true;setValidated(val);var b={interventions:{sequence:configuration.budgetDefaultInter.valeur,depense:getBudgetTot(budgetSim,\"interventions\")},equipements:{sequence:configuration.budgetDefaultInter.valeur,depense:getBudgetTot(budgetSim,\"equipements\")}};setBudget(b);}};useEffect(function(){initInfos(cycles);},[couts]);useEffect(function(){console.log(chrono);},[chrono]);var getPlayState=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(session,equipe){var currentPlayState,_mursH,_mursV,c;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!isLoading.current&&configuration!=null)){_context.next=11;break;}isLoading.current=true;console.log(\"getplaystate\");_context.next=5;return PlayAPI.getPlayState(session,equipe);case 5:currentPlayState=_context.sent;console.log(currentPlayState);if(Object.keys(currentPlayState).length>0){// console.log(currentPlayState)\nsetCurrentPomp(parseInt(JSON.parse(currentPlayState.currentPomp.valeur)));setCurrentTour(parseInt(JSON.parse(currentPlayState.currentTour.valeur)));setCurrentCycle(parseInt(JSON.parse(currentPlayState.currentCycle.valeur)));setCurrentSequence(parseInt(JSON.parse(currentPlayState.currentSequence.valeur)));_mursH=JSON.parse(currentPlayState.mursH.valeur);_mursV=JSON.parse(currentPlayState.mursV.valeur);setPlay(JSON.parse(currentPlayState.play.valeur));setMursH(_mursH);setMursV(_mursV);setCarte(JSON.parse(currentPlayState.carte.valeur));setResultats({Decedes:parseInt(JSON.parse(currentPlayState.resultatsDecedes.valeur)),Sauves:parseInt(JSON.parse(currentPlayState.resultatsSauves.valeur)),Marqueur:getNombreMarqueur(_mursH,_mursV)});setCycles(JSON.parse(currentPlayState.budgetsPompInit.valeur));c=parseInt(JSON.parse(currentPlayState.currrentChrono.valeur));if(configuration!==null&&c<=configuration.chronoTour.valeur&&parseInt(JSON.parse(currentPlayState.currentPomp.valeur))==numPompier){setChrono(c);}else{setChrono(null);// console.log(\"chrono\")\n}setPlay(JSON.parse(currentPlayState.play.valeur));}else{console.log(\"error\");}// getPositionFromCarte(JSON.parse(currentPlayState.carte.valeur))\nisLoading.current=false;_context.next=12;break;case 11:console.log(configuration);case 12:case\"end\":return _context.stop();}}},_callee);}));return function getPlayState(_x,_x2){return _ref.apply(this,arguments);};}();// useEffect(()=>{\n//   console.log(currentPomp)\n// },[currentPomp])\nuseEffect(function(){// console.log(carte)\nif(carte.length>0){setNbLignesGrille(carte.length);setNbColonnesGrille(carte[0].length);setPosition([carte.length+1,carte[0].length+1]);}},[carte]);useEffect(function(){console.log(configuration);},[configuration]);useEffect(function(){if(configuration===null)getPlayParameters();if(session!=null&&equipe!=null&&currentTour==null){if(!isLoading.current&&configuration!==null)getPlayState(session,equipe);// getPositionFromCarte()\n}},[session,equipe,numPompier,configuration]);var getPlayParameters=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var param;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(\"getPlay Parameters\");_context2.next=3;return PlayAPI.getConfiguration(session);case 3:param=_context2.sent;setConfiguration(param);console.log(param);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function getPlayParameters(){return _ref2.apply(this,arguments);};}();var getBudgetTot=function getBudgetTot(budgetSim,type){var sum=0;if(couts!==null){if(type==\"interventions\"){// if (budgetSim !== null && budgetSim !== undefined) {\n//   const lastCycleInter = [...cycles.interventions].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.interventions].length - 1]\n//   if (budgetSim.interventions.numSeq == currentSequence && budgetSim.interventions.numCycle > currentCycle || lastCycleInter === undefined) {\n//     Object.keys(budgetSim.interventions).forEach((key) => {\n//       if (key != \"numCycle\" && key != \"numSeq\") {\n//         console.log(\"test\")\n//         sum += budgetSim.interventions[key]\n//       }\n//     })\n//   }\n// }\ncycles.interventions.forEach(function(c){if(c.numSeq==currentSequence){Object.keys(c).forEach(function(key){if(key!=\"numCycle\"&&key!=\"numSeq\"){// console.log(c[key])\nsum+=c[key];}});}});}else{var lastCycleEq=_toConsumableArray(cycles.equipements).sort(function(a,b){return(a.numSeq-b.numSeq)*100+a.numCycle-b.numCycle;})[_toConsumableArray(cycles.equipements).length-1];// if (budgetSim.equipements.numSeq == currentSequence && budgetSim.equipements.numCycle > currentCycle || lastCycleEq === undefined) {\n//   Object.keys(budgetSim.equipements).forEach((key) => {\n//     if (key != \"numCycle\" && key != \"numSeq\") {\n//       Object.values(budgetSim.equipements[key]).forEach(value => {\n//         sum += value * couts.equipements[\"coutEq\" + key]\n//       })\n//     }\n//   })\n// }\ncycles.equipements.forEach(function(c){if(c.numSeq==currentSequence){Object.keys(c).forEach(function(key){if(key!=\"numCycle\"&&key!=\"numSeq\"){Object.values(c[key]).forEach(function(v){sum+=couts.equipements[\"coutEq\"+key]*v;});}});}});}}return sum;};// useEffect(()=>{\n//   if(budgetSim!==null){\n//     console.log(budgetSim.interventions)\n//   }\n// },[budgetSim])\nvar handleBudgetChange=function handleBudgetChange(type,newBudget){var bSim=_objectSpread({},budgetSim);bSim[type]=newBudget;setBudgetSim(bSim);};useEffect(function(){if(validated.interventions&&validated.equipements&&numPompier==currentPomp)checkNouveauTour();},[validated,vue]);var handleClicValidated=function handleClicValidated(type,bool){if(bool){var v=_objectSpread({},validated);v[type]=true;setValidated(v);// var p = { ...page }\n// if (type == \"interventions\") p[type] += 1\n// if (type == \"equipements\") p[type] += 1\n// setPage(p)\nvar c=_objectSpread({},cycles);c[type].push(budgetSim[type]);setCycles(c);setChrono(null);}else{// RETOUR\nconsole.log(\"clic retour vue \",type);var c=_objectSpread({},cycles);if(c[type]!==undefined){var bSim=_objectSpread({},budgetSim);bSim[type]=c[type][c[type].length-1];console.log(bSim);setBudgetSim(bSim);c[type].pop();setCycles(c);var v=_objectSpread({},validated);v[type]=false;setValidated(v);}}};var nouveauTour=function nouveauTour(){isLoading.current=true;if(configuration!=null){// if(bool){\nconsole.log(\"save bdg fin\");PlayAPI.saveBudgetsPompFin(cycles,session,equipe).then(function(res){var prochainPomp=1;var prochainTour=currentTour;var prochainCycle=currentCycle;var prochaineSequence=currentSequence;// if(numPompier==configuration.nbPompEquipe.valeur){ // DERNIER POMP DU TOUR\n//   if(currentTour==configu  ration.nbToursParCycle.valeur){ // SEND TO INTER\n//     prochainTour = 1\n//     prochainPomp=0 // A CHANGER AVEC STRATEGIQUE\n//     if(prochainCycle==configuration.nbCyclesParSequence.valeur){\n//       prochainCycle=1\n//       prochaineSequence=prochaineSequence+1\n//     }else{\n//       prochainCycle=prochainCycle+1\n//     }\n//   }else{ // PAS DERNIER TOUR DU CYCLE\n//     console.log(\"pas dernier tour\")\n//     prochainPomp=1\n//     prochainTour=prochainTour+1\n//   }\n// }\nPlayAPI.nouveauTour(socket,prochainPomp,carte,mursH,mursV,prochaineSequence,prochainCycle,prochainTour,resultats.Decedes,resultats.Sauves,session,equipe,configuration.chronoTour.valeur).then(function(){console.log(\"nouveau tour\");isLoading.current=false;});// }else{\n//   // retourAction()\n// }\n});}};var checkNouveauTour=function checkNouveauTour(){console.log(\"check nv tour\");if(validated.interventions&&validated.equipements&&numPompier==currentPomp){if(!isLoading.current){nouveauTour();}}};// SOCKETS\nvar _useState47=useState(null),_useState48=_slicedToArray(_useState47,2),socket=_useState48[0],setSocket=_useState48[1];useEffect(function(){if(socket==null&&configuration!==null){var s=io.connect(\"https://www.back.leaders-extreme.fr:4000\");setSocket(s);s.on('changementTour',function(data){// console.log(currentPomp != data.currentPomp)\nif(currentPomp!=data.currentPomp||currentCycle!==data.currentCycle||currentTour!==data.currentTour||currentSequence!==data.currentSequence){getPlayState(session,equipe);}});s.on('startStopPartie',function(data){setPlay(data.start);});// socket.on('revealHabitant',(data)=>{\n//   if(carte!==null && carte.length>0){\n//     // console.log(carte[data.y][data.x])\n//     // console.log(carte[data.y])\n//     if(carte[data.y][data.x]==20){\n//       // console.log([data.y,data.x])\n//       updateCarte([data.y,data.x],data.type)\n//       // console.log(\"socket hab\")\n//       // console.log(data)\n//     }\n//   }\n// })\n}},[socket,configuration]);var handleViewChange=function handleViewChange(event,newValue){if(newValue!=null){setVue(newValue);}};// useEffect(() => {\n//   console.log(vue)\n// }, [vue])\nreturn carte.length>0&&position!=null&&configuration!==null&&configuration!==undefined&&budget!=null&&budget!=undefined&&couts!==null&&couts!=undefined&&play?/*#__PURE__*/_jsxs(\"div\",{style:{position:\"absolute\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",flex:1,width:\"100%\",height:\"100%\"},children:[/*#__PURE__*/_jsx(InterBandeauTop// stocks={stocks}\n,{numeroPompier:numPompier,numEquipe:equipe,numSession:session,sequence:currentSequence,cycle:currentCycle,tour:currentTour,pomp:currentPomp,configuration:configuration,handleViewChange:handleViewChange,vue:vue,interventionsValidated:validated.interventions,equipementsValidated:validated.equipements,play:play,handleClicValidated:handleClicValidated,chronoInit:chrono,validated:validated}),vue==\"operations\"?/*#__PURE__*/_jsx(Grille,{nbColonnesGrille:nbColonnesGrille,nbLignesGrille:nbLignesGrille,carte:carte,position:position,mursH:mursH,mursV:mursV}):null,vue==\"interventions\"&&cycles!=null?/*#__PURE__*/_jsx(InterInterventions,{budget:_objectSpread({},budget.interventions),cycles:_toConsumableArray(cycles.interventions),handleBudgetChange:handleBudgetChange,type:\"interventions\",currentCycle:currentCycle,currentSequence:currentSequence,budgetSim:_objectSpread({},budgetSim.interventions),couts:couts,nbCycleParSeq:configuration!==null?configuration.nbCyclesParSequence.valeur:0,configuration:configuration// page={page.interventions}\n}):null,vue==\"equipements\"&&cycles!=null?/*#__PURE__*/_jsx(InterInterventions,{budget:_objectSpread({},budget.equipements),cycles:_toConsumableArray(cycles.equipements),handleBudgetChange:handleBudgetChange,type:\"equipements\",currentCycle:currentCycle,currentSequence:currentSequence,budgetSim:_objectSpread({},budgetSim.equipements),couts:couts,nbCycleParSeq:configuration!==null?configuration.nbCyclesParSequence.valeur:0,configuration:configuration// page={page.equipements}\n}):null,/*#__PURE__*/_jsx(InterBandeauBottom,{numeroPompier:numPompier,tour:currentTour,pomp:currentPomp,resultats:resultats,vue:vue,couts:couts,budget:vue===\"interventions\"?budget.interventions:budget.equipements,validated:validated,handleClicValidated:handleClicValidated,equipe:equipe}),/*#__PURE__*/_jsx(InterBandeauDroite,{handleDisconnect:handleDisconnect,configuration:configuration})]}):null;};export default InterInterface;","map":{"version":3,"sources":["C:/Users/hugod/decitude/client/src/routes/InterInterface.js"],"names":["React","useState","useEffect","useRef","PlayAPI","InterBandeauTop","InterBandeauBottom","Grille","InterInterventions","useHistory","io","cookie","InterBandeauDroite","InterInterface","history","user","load","handleDisconnect","save","path","maxAge","push","undefined","role","includes","play","setPlay","numPompier","setNumPompier","currentPomp","setCurrentPomp","currentTour","setCurrentTour","currentCycle","setCurrentCycle","currentSequence","setCurrentSequence","session","setSession","equipe","setEquipe","chrono","setChrono","vue","setVue","configuration","setConfiguration","couts","setCouts","Decedes","Sauves","Marqueur","resultats","setResultats","sequence","depense","budget","setBudget","cycles","setCycles","interventions","coutInterDeplacement","valeur","coutInterFeu","coutInterFeuFum","coutInterFum","coutInterMarqueur","coutInterPorte","coutInterHab","coutInterHabitant","equipements","coutEqFeu","coutEqFeuFum","coutEqFum","coutEqMarqueur","budgetDefaultInter","initInfos","budgetSim","setBudgetSim","console","log","saveBudgetsPompInit","then","numCycle","length","numSeq","pomp1","pomp2","pomp3","pomp4","pomp5","pomp6","Feu","FeuFum","Fum","validated","setValidated","isLoading","carte","setCarte","nbLignesGrille","setNbLignesGrille","nbColonnesGrille","setNbColonnesGrille","position","setPosition","mursH","setMursH","mursV","setMursV","getNombreMarqueur","nbMarqueur","forEach","ligne","lastCycleEq","sort","a","b","lastCycleInter","val","getBudgetTot","getPlayState","current","currentPlayState","Object","keys","parseInt","JSON","parse","resultatsDecedes","resultatsSauves","budgetsPompInit","c","currrentChrono","chronoTour","getPlayParameters","getConfiguration","param","type","sum","key","values","v","handleBudgetChange","newBudget","bSim","checkNouveauTour","handleClicValidated","bool","pop","nouveauTour","saveBudgetsPompFin","res","prochainPomp","prochainTour","prochainCycle","prochaineSequence","socket","setSocket","s","connect","on","data","start","handleViewChange","event","newValue","display","alignItems","justifyContent","flex","width","height","nbCyclesParSequence"],"mappings":"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","sourcesContent":["import \"../styles/App.css\"\r\nimport React, { useState, useEffect, useRef } from 'react'\r\nimport PlayAPI from \"../API/PlayAPI\"\r\nimport InterBandeauTop from \"../components/interfaceJoueur/InterBandeauTop\"\r\nimport InterBandeauBottom from \"../components/interfaceJoueur/InterBandeauBottom\"\r\nimport Grille from \"../components/interfaceJoueur/Grille\"\r\nimport InterInterventions from \"../components/interfaceJoueur/InterInterventions\"\r\nimport { useHistory } from 'react-router-dom';\r\nimport io from 'socket.io-client'\r\n\r\nimport cookie from 'react-cookies'\r\nimport InterBandeauDroite from \"../components/interfaceJoueur/InterBandeauDroite\"\r\n\r\n\r\nconst InterInterface = () => {\r\n\r\n  const history = useHistory()\r\n\r\n  const user = cookie.load(\"user\")\r\n  const handleDisconnect = () => {\r\n    cookie.save('user', \"disconnected\", {\r\n      path: '/',\r\n      maxAge: 60 * 60 * 1.5, //sec\r\n    })\r\n    history.push('/login');\r\n  }\r\n\r\n  if (user === null || user === undefined || user==\"disconnected\") history.push(\"/login\");\r\n  if(user !== null && user !== undefined && user.role!==undefined && !user.role.includes(\"INTER\")) handleDisconnect()\r\n  const [play,setPlay]=useState(false)\r\n\r\n\r\n  const [numPompier, setNumPompier] = useState(0)\r\n  const [currentPomp, setCurrentPomp] = useState(null)\r\n  const [currentTour, setCurrentTour] = useState(null)\r\n  const [currentCycle, setCurrentCycle] = useState(null)\r\n  const [currentSequence, setCurrentSequence] = useState(null)\r\n\r\n  const [session, setSession] = useState(user !== null && user !== undefined ? user.session : null)\r\n  const [equipe, setEquipe] = useState(user !== null && user !== undefined ?  user.equipe : null)\r\n  const [chrono, setChrono]=useState(null)\r\n  const [vue, setVue] = useState(\"operations\")\r\n\r\n\r\n\r\n  const [configuration, setConfiguration] = useState(null)\r\n\r\n\r\n\r\n  const [couts, setCouts] = useState(null)\r\n\r\n\r\n\r\n  const [resultats, setResultats] = useState({\r\n    Decedes: 0,\r\n    Sauves: 0,\r\n    Marqueur: 0\r\n  })\r\n\r\n\r\n  const [budget, setBudget] = useState({\r\n    sequence: 0,\r\n    depense: 0\r\n  })\r\n\r\n\r\n  const [cycles, setCycles] = useState(null)\r\n\r\n  useEffect(() => {\r\n\r\n    if (configuration != null) {\r\n\r\n      setCouts({\r\n        interventions: {\r\n          coutInterDeplacement: configuration.coutInterDeplacement.valeur,\r\n          coutInterFeu: configuration.coutInterFeu.valeur,\r\n          coutInterFeuFum: configuration.coutInterFeuFum.valeur,\r\n          coutInterFum: configuration.coutInterFum.valeur,\r\n          coutInterMarqueur: configuration.coutInterMarqueur.valeur,\r\n          coutInterPorte: configuration.coutInterPorte.valeur,\r\n          coutInterHab: configuration.coutInterHabitant.valeur,\r\n        },\r\n        equipements: {\r\n          coutEqFeu: configuration.coutEqFeu.valeur,\r\n          coutEqFeuFum: configuration.coutEqFeuFum.valeur,\r\n          coutEqFum: configuration.coutEqFum.valeur,\r\n          coutEqMarqueur: configuration.coutEqMarqueur.valeur,\r\n\r\n        }\r\n      })\r\n      setBudget({\r\n        interventions:{\r\n          sequence: configuration.budgetDefaultInter.valeur,\r\n          depense: 0\r\n        },\r\n        equipements:{\r\n          sequence: configuration.budgetDefaultInter.valeur,\r\n          depense: 0\r\n        }\r\n        \r\n      })\r\n\r\n      if (cycles != null) {\r\n        initInfos(cycles)\r\n      }\r\n\r\n    }\r\n  }, [configuration])\r\n\r\n\r\n\r\n  const [budgetSim, setBudgetSim] = useState(null)\r\n\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    if (cycles != null) {\r\n      console.log(\"save bdg init\")\r\n      PlayAPI.saveBudgetsPompInit(cycles, session, equipe).then(()=>{\r\n        if (configuration != null) {\r\n          initInfos(cycles)\r\n        }\r\n  \r\n        if(budgetSim==null || budgetSim.interventions==undefined || budgetSim.interventions.numCycle!==(cycles.interventions.length) % 2 + 1 || budgetSim.equipements.numCycle!==(cycles.equipements.length) % 2 + 1){\r\n          setBudgetSim({\r\n            interventions: {\r\n              numSeq: cycles.interventions.length > 1 ? cycles.interventions.length % 2 == 0 ? cycles.interventions[cycles.interventions.length - 1].numSeq + 1 : cycles.interventions[cycles.interventions.length - 1].numSeq : 1,\r\n              numCycle: (cycles.interventions.length) % 2 + 1,\r\n              pomp1: 0,\r\n              pomp2: 0,\r\n              pomp3: 0,\r\n              pomp4: 0,\r\n              pomp5: 0,\r\n              pomp6: 0,\r\n            },\r\n            equipements: {\r\n              numSeq: cycles.equipements.length > 1 ? cycles.equipements.length % 2 == 0 ? cycles.equipements[cycles.equipements.length - 1].numSeq + 1 : cycles.equipements[cycles.equipements.length - 1].numSeq : 1,\r\n              numCycle: (cycles.equipements.length) % 2 + 1,\r\n              Feu: {\r\n                pomp1: 0,\r\n                pomp2: 0,\r\n                pomp3: 0,\r\n                pomp4: 0,\r\n                pomp5: 0,\r\n                pomp6: 0,\r\n              },\r\n              FeuFum: {\r\n                pomp1: 0,\r\n                pomp2: 0,\r\n                pomp3: 0,\r\n                pomp4: 0,\r\n                pomp5: 0,\r\n                pomp6: 0,\r\n              },\r\n              Fum: {\r\n                pomp1: 0,\r\n                pomp2: 0,\r\n                pomp3: 0,\r\n                pomp4: 0,\r\n                pomp5: 0,\r\n                pomp6: 0\r\n              },\r\n              Marqueur: {\r\n                pomp1: 0,\r\n                pomp2: 0,\r\n                pomp3: 0,\r\n                pomp4: 0,\r\n                pomp5: 0,\r\n                pomp6: 0,\r\n              },\r\n            },\r\n          })\r\n      }\r\n    })\r\n    }\r\n\r\n\r\n    // console.log(cycles.equipements)\r\n  }, [cycles])\r\n\r\n  const [validated, setValidated] = useState({\r\n    interventions:false,\r\n    equipements:false\r\n    \r\n  })\r\n  // const [page, setPage] = useState({\r\n  //   interventions: 0,\r\n  //   equipements: 0\r\n  // })\r\n\r\n\r\n\r\n  const isLoading = useRef(false)\r\n\r\n  // INITIALISATION DE LA CARTE\r\n\r\n  const [carte, setCarte] = useState([\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n  ])\r\n\r\n  // const [carte, setCarte] = useState([])\r\n\r\n  const [nbLignesGrille, setNbLignesGrille] = useState(0)\r\n  const [nbColonnesGrille, setNbColonnesGrille] = useState(0)\r\n  const [position, setPosition] = useState(null)\r\n\r\n\r\n  const [mursH, setMursH] = useState([\r\n    [1, 1, 1, 1, 1, 1, 2, 6, 1, 1, 1, 1, 2, 5, 1, 1],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [1, 1, 1, 1, 2, 6, 1, 6, 2, 1, 1, 1, 5, 2, 1, 1],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [1, 1, 1, 1, 1, 1, 6, 2, 1, 1, 1, 1, 1, 1, 1, 1]\r\n  ])\r\n\r\n  const [mursV, setMursV] = useState([\r\n    [1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    [2, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    [5, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 2],\r\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 5]\r\n  ])\r\n\r\n\r\n  const getNombreMarqueur = (mursH, mursV) => {\r\n    let nbMarqueur = 0\r\n    mursH.forEach(ligne => {\r\n      ligne.forEach(valeur => {\r\n        if (valeur == 3) nbMarqueur = nbMarqueur + 1\r\n        if (valeur == 4) nbMarqueur = nbMarqueur + 2\r\n      })\r\n    })\r\n    mursV.forEach(ligne => {\r\n      ligne.forEach(valeur => {\r\n        if (valeur == 3) nbMarqueur = nbMarqueur + 1\r\n        if (valeur == 4) nbMarqueur = nbMarqueur + 2\r\n      })\r\n    })\r\n    return nbMarqueur\r\n  }\r\n\r\n  // GET PLAY PARAMETERS \r\n\r\n\r\n\r\n  const initInfos = (cycles) => {\r\n    if (cycles !== null && configuration !== null) {\r\n      console.log(\"init infos\")\r\n      const lastCycleEq = [...cycles.equipements].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.equipements].length - 1]\r\n      const lastCycleInter = [...cycles.interventions].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.interventions].length - 1]\r\n\r\n      var val = {\r\n        interventions: false,\r\n        equipements: false\r\n      }\r\n\r\n      if (lastCycleInter !== null && lastCycleInter !== undefined && lastCycleInter.numSeq == currentSequence && lastCycleInter.numCycle == currentCycle) val.interventions = true\r\n      if (lastCycleEq !== null && lastCycleEq !== undefined && lastCycleEq.numSeq == currentSequence && lastCycleEq.numCycle == currentCycle) val.equipements = true\r\n      setValidated(val)\r\n\r\n      var b = {\r\n        interventions:{\r\n          sequence: configuration.budgetDefaultInter.valeur,\r\n          depense: getBudgetTot(budgetSim,\"interventions\")\r\n        },\r\n        equipements:{\r\n          sequence: configuration.budgetDefaultInter.valeur,\r\n          depense: getBudgetTot(budgetSim,\"equipements\")\r\n        }\r\n        \r\n      }\r\n\r\n\r\n      setBudget(b)\r\n    }\r\n\r\n  }\r\n\r\n  useEffect(() => {\r\n    initInfos(cycles)\r\n  }, [couts])\r\n\r\n\r\n  useEffect(()=>{\r\n    console.log(chrono)\r\n  },[chrono])\r\n\r\n\r\n\r\n  const getPlayState = async (session, equipe) => {\r\n    \r\n    if (!isLoading.current && configuration != null) {\r\n      \r\n      isLoading.current = true\r\n      console.log(\"getplaystate\")\r\n      const currentPlayState = await PlayAPI.getPlayState(session, equipe)\r\n      console.log(currentPlayState)\r\n      if (Object.keys(currentPlayState).length > 0) {\r\n\r\n        // console.log(currentPlayState)\r\n        setCurrentPomp(parseInt(JSON.parse(currentPlayState.currentPomp.valeur)))\r\n        setCurrentTour(parseInt(JSON.parse(currentPlayState.currentTour.valeur)))\r\n        setCurrentCycle(parseInt(JSON.parse(currentPlayState.currentCycle.valeur)))\r\n        setCurrentSequence(parseInt(JSON.parse(currentPlayState.currentSequence.valeur)))\r\n        const mursH = JSON.parse(currentPlayState.mursH.valeur)\r\n        const mursV = JSON.parse(currentPlayState.mursV.valeur)\r\n        setPlay(JSON.parse(currentPlayState.play.valeur))\r\n        setMursH(mursH)\r\n        setMursV(mursV)\r\n        setCarte(JSON.parse(currentPlayState.carte.valeur))\r\n        setResultats({\r\n          Decedes: parseInt(JSON.parse(currentPlayState.resultatsDecedes.valeur)),\r\n          Sauves: parseInt(JSON.parse(currentPlayState.resultatsSauves.valeur)),\r\n          Marqueur: getNombreMarqueur(mursH, mursV)\r\n        })\r\n        setCycles(JSON.parse(currentPlayState.budgetsPompInit.valeur))\r\n        const c = parseInt(JSON.parse(currentPlayState.currrentChrono.valeur))\r\n        if (configuration !== null && c <= configuration.chronoTour.valeur && parseInt(JSON.parse(currentPlayState.currentPomp.valeur)) == numPompier) {\r\n          setChrono(c)\r\n        } else {\r\n          setChrono(null)\r\n          // console.log(\"chrono\")\r\n        }\r\n        \r\n        setPlay(JSON.parse(currentPlayState.play.valeur))\r\n      }else{\r\n        console.log(\"error\")\r\n      }\r\n      // getPositionFromCarte(JSON.parse(currentPlayState.carte.valeur))\r\n      isLoading.current = false\r\n    }else{\r\n      console.log(configuration)\r\n    }\r\n\r\n  }\r\n\r\n  // useEffect(()=>{\r\n  //   console.log(currentPomp)\r\n  // },[currentPomp])\r\n\r\n\r\n  useEffect(() => {\r\n    // console.log(carte)\r\n    if (carte.length > 0) {\r\n      setNbLignesGrille(carte.length)\r\n      setNbColonnesGrille(carte[0].length)\r\n      setPosition([carte.length + 1, carte[0].length + 1])\r\n    }\r\n\r\n  }, [carte])\r\n\r\n  useEffect(()=>{\r\n    console.log(configuration)\r\n  },[configuration])\r\n  useEffect(() => {\r\n    if(configuration===null) getPlayParameters()\r\n    if (session != null && equipe != null && currentTour == null) {\r\n      \r\n      if (!isLoading.current && configuration!==null) getPlayState(session, equipe)\r\n      \r\n      // getPositionFromCarte()\r\n    }\r\n  }, [session, equipe, numPompier,configuration])\r\n\r\n  const getPlayParameters = async () => {\r\n    console.log(\"getPlay Parameters\")\r\n    const param =await PlayAPI.getConfiguration(session)\r\n    setConfiguration(param)\r\n    console.log(param)\r\n  }\r\n\r\n\r\n\r\n\r\n  const getBudgetTot = (budgetSim,type) => {\r\n    let sum = 0\r\n\r\n    if (couts !== null) {\r\n\r\n\r\n      if(type==\"interventions\"){\r\n        // if (budgetSim !== null && budgetSim !== undefined) {\r\n        //   const lastCycleInter = [...cycles.interventions].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.interventions].length - 1]\r\n        //   if (budgetSim.interventions.numSeq == currentSequence && budgetSim.interventions.numCycle > currentCycle || lastCycleInter === undefined) {\r\n        //     Object.keys(budgetSim.interventions).forEach((key) => {\r\n        //       if (key != \"numCycle\" && key != \"numSeq\") {\r\n        //         console.log(\"test\")\r\n        //         sum += budgetSim.interventions[key]\r\n        //       }\r\n        //     })\r\n        //   }\r\n\r\n\r\n          \r\n        // }\r\n        cycles.interventions.forEach((c) => {\r\n          if (c.numSeq == currentSequence) {\r\n            Object.keys(c).forEach((key) => {\r\n              if (key != \"numCycle\" && key != \"numSeq\") {\r\n                // console.log(c[key])\r\n                sum += c[key]\r\n              }\r\n            })\r\n          }\r\n        })\r\n      }else{\r\n\r\n\r\n        const lastCycleEq = [...cycles.equipements].sort((a, b) => (a.numSeq - b.numSeq) * 100 + a.numCycle - b.numCycle)[[...cycles.equipements].length - 1]\r\n      \r\n\r\n        // if (budgetSim.equipements.numSeq == currentSequence && budgetSim.equipements.numCycle > currentCycle || lastCycleEq === undefined) {\r\n        //   Object.keys(budgetSim.equipements).forEach((key) => {\r\n        //     if (key != \"numCycle\" && key != \"numSeq\") {\r\n        //       Object.values(budgetSim.equipements[key]).forEach(value => {\r\n        //         sum += value * couts.equipements[\"coutEq\" + key]\r\n        //       })\r\n        //     }\r\n        //   })\r\n        // }\r\n\r\n        cycles.equipements.forEach((c) => {\r\n          if (c.numSeq == currentSequence) {\r\n            Object.keys(c).forEach((key) => {\r\n              if (key != \"numCycle\" && key != \"numSeq\") {\r\n                Object.values(c[key]).forEach((v) => {\r\n                  sum += couts.equipements[\"coutEq\" + key] * v\r\n                })\r\n              }\r\n  \r\n            })\r\n          }\r\n\r\n      \r\n        })\r\n\r\n      }\r\n\r\n    }\r\n    return sum\r\n  }\r\n  // useEffect(()=>{\r\n  //   if(budgetSim!==null){\r\n  //     console.log(budgetSim.interventions)\r\n  //   }\r\n    \r\n  // },[budgetSim])\r\n\r\n\r\n  const handleBudgetChange = (type, newBudget) => {\r\n    var bSim = { ...budgetSim }\r\n    bSim[type] = newBudget\r\n    setBudgetSim(bSim)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if(validated.interventions && validated.equipements && numPompier == currentPomp) checkNouveauTour()\r\n  },[validated,vue])\r\n\r\n  const handleClicValidated = (type,bool) => {\r\n    if(bool){\r\n      var v = { ...validated }\r\n      v[type] = true\r\n      setValidated(v)\r\n  \r\n      // var p = { ...page }\r\n      // if (type == \"interventions\") p[type] += 1\r\n      // if (type == \"equipements\") p[type] += 1\r\n      // setPage(p)\r\n  \r\n      var c = { ...cycles }\r\n      c[type].push(budgetSim[type])\r\n      setCycles(c)\r\n      setChrono(null)\r\n    }else{ // RETOUR\r\n      console.log(\"clic retour vue \",type)\r\n\r\n      var c = {...cycles}\r\n      if(c[type]!==undefined){\r\n        var bSim = {...budgetSim}\r\n        bSim[type]=c[type][c[type].length-1]\r\n        console.log(bSim)\r\n        setBudgetSim(bSim)\r\n        c[type].pop()\r\n        setCycles(c)\r\n  \r\n  \r\n        var v = { ...validated }\r\n        v[type] = false\r\n        setValidated(v)\r\n      }\r\n      \r\n    }\r\n  }\r\n\r\n\r\n\r\n  const nouveauTour =  () => {\r\n    isLoading.current=true\r\n    if (configuration != null) {\r\n      // if(bool){\r\n      console.log(\"save bdg fin\")\r\n      PlayAPI.saveBudgetsPompFin(cycles, session, equipe).then((res)=>{\r\n        let prochainPomp = 1\r\n        let prochainTour = currentTour\r\n        let prochainCycle = currentCycle\r\n        let prochaineSequence = currentSequence\r\n  \r\n  \r\n  \r\n        // if(numPompier==configuration.nbPompEquipe.valeur){ // DERNIER POMP DU TOUR\r\n        //   if(currentTour==configu  ration.nbToursParCycle.valeur){ // SEND TO INTER\r\n        //     prochainTour = 1\r\n        //     prochainPomp=0 // A CHANGER AVEC STRATEGIQUE\r\n  \r\n        //     if(prochainCycle==configuration.nbCyclesParSequence.valeur){\r\n        //       prochainCycle=1\r\n        //       prochaineSequence=prochaineSequence+1\r\n        //     }else{\r\n        //       prochainCycle=prochainCycle+1\r\n        //     }\r\n  \r\n  \r\n        //   }else{ // PAS DERNIER TOUR DU CYCLE\r\n        //     console.log(\"pas dernier tour\")\r\n        //     prochainPomp=1\r\n        //     prochainTour=prochainTour+1\r\n  \r\n  \r\n        //   }\r\n  \r\n        // }\r\n        \r\n         PlayAPI.nouveauTour(socket,prochainPomp, carte, mursH, mursV, prochaineSequence, prochainCycle, prochainTour, resultats.Decedes, resultats.Sauves, session, equipe,configuration.chronoTour.valeur).then(()=>{\r\n          console.log(\"nouveau tour\")\r\n          isLoading.current=false\r\n         })\r\n        \r\n         \r\n        \r\n        // }else{\r\n        //   // retourAction()\r\n        // }\r\n      })\r\n      \r\n         \r\n        \r\n      \r\n\r\n     \r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  const checkNouveauTour =  () => {\r\n    console.log(\"check nv tour\")\r\n    if (validated.interventions && validated.equipements && numPompier == currentPomp) {\r\n      if(!isLoading.current){\r\n        nouveauTour()\r\n      }\r\n      \r\n    }\r\n  }\r\n\r\n  // SOCKETS\r\n  const [socket, setSocket] = useState(null)\r\n  useEffect(() => {\r\n    if (socket == null && configuration!==null) {\r\n      const s = io.connect(\"https://www.back.leaders-extreme.fr:4000\")\r\n      setSocket(s)\r\n      s.on('changementTour', (data) => {\r\n\r\n      \r\n      // console.log(currentPomp != data.currentPomp)\r\n      if (currentPomp != data.currentPomp || currentCycle !== data.currentCycle || currentTour !== data.currentTour || currentSequence !== data.currentSequence) {        \r\n\r\n        getPlayState(session, equipe)\r\n      }\r\n\r\n\r\n\r\n    })\r\n\r\n    s.on('startStopPartie', (data) => {\r\n      setPlay(data.start)\r\n    });\r\n\r\n    // socket.on('revealHabitant',(data)=>{\r\n    //   if(carte!==null && carte.length>0){\r\n    //     // console.log(carte[data.y][data.x])\r\n    //     // console.log(carte[data.y])\r\n    //     if(carte[data.y][data.x]==20){\r\n    //       // console.log([data.y,data.x])\r\n    //       updateCarte([data.y,data.x],data.type)\r\n    //       // console.log(\"socket hab\")\r\n    //       // console.log(data)\r\n    //     }\r\n    //   }\r\n    // })\r\n  }\r\n  },[socket,configuration]);\r\n\r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\n  const handleViewChange = (event, newValue) => {\r\n    if (newValue != null) {\r\n      setVue(newValue)\r\n    }\r\n  }\r\n  // useEffect(() => {\r\n  //   console.log(vue)\r\n  // }, [vue])\r\n\r\n\r\n  return (\r\n\r\n    carte.length > 0 && position != null && configuration !== null && configuration !== undefined && budget != null && budget != undefined && couts!==null && couts!=undefined && play?\r\n\r\n      <div style={{ position: \"absolute\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\", flex: 1, width: \"100%\", height: \"100%\" }}>\r\n        <InterBandeauTop\r\n          // stocks={stocks}\r\n          numeroPompier={numPompier}\r\n          numEquipe={equipe}\r\n          numSession={session}\r\n          sequence={currentSequence}\r\n          cycle={currentCycle}\r\n          tour={currentTour}\r\n          pomp={currentPomp}\r\n          configuration={configuration}\r\n          handleViewChange={handleViewChange}\r\n          vue={vue}\r\n          interventionsValidated={validated.interventions}\r\n          equipementsValidated={validated.equipements}\r\n          play={play}\r\n          handleClicValidated={handleClicValidated}\r\n          chronoInit={chrono}\r\n          validated={validated}\r\n        />\r\n        {\r\n          vue == \"operations\" ?\r\n            <Grille\r\n              nbColonnesGrille={nbColonnesGrille}\r\n              nbLignesGrille={nbLignesGrille}\r\n              carte={carte}\r\n              position={position}\r\n              mursH={mursH}\r\n              mursV={mursV}\r\n            />\r\n            : null\r\n        }\r\n\r\n\r\n        {\r\n          vue == \"interventions\" && cycles != null ?\r\n\r\n            <InterInterventions\r\n              budget={{...budget.interventions}}\r\n              cycles={[...cycles.interventions]}\r\n              handleBudgetChange={handleBudgetChange}\r\n              type=\"interventions\"\r\n              currentCycle={currentCycle}\r\n              currentSequence={currentSequence}\r\n              budgetSim={{ ...budgetSim.interventions }}\r\n              couts={couts}\r\n              nbCycleParSeq={configuration !== null ? configuration.nbCyclesParSequence.valeur : 0}\r\n              configuration={configuration}\r\n            // page={page.interventions}\r\n            />\r\n            : null\r\n        }\r\n\r\n        {\r\n          vue == \"equipements\" && cycles != null ?\r\n\r\n            <InterInterventions\r\n              budget={{...budget.equipements}}\r\n              cycles={[...cycles.equipements]}\r\n              handleBudgetChange={handleBudgetChange}\r\n              type=\"equipements\"\r\n              currentCycle={currentCycle}\r\n              currentSequence={currentSequence}\r\n              budgetSim={{ ...budgetSim.equipements }}\r\n              couts={couts}\r\n              nbCycleParSeq={configuration !== null ? configuration.nbCyclesParSequence.valeur : 0}\r\n              configuration={configuration}\r\n            // page={page.equipements}\r\n            />\r\n            : null\r\n        }\r\n\r\n\r\n\r\n\r\n        <InterBandeauBottom\r\n          numeroPompier={numPompier}\r\n          tour={currentTour}\r\n          pomp={currentPomp}\r\n          resultats={resultats}\r\n          vue={vue}\r\n          couts={couts}\r\n          budget={vue === \"interventions\" ? budget.interventions : budget.equipements}\r\n          validated={validated}\r\n          handleClicValidated={handleClicValidated}\r\n          equipe={equipe}\r\n        />\r\n        <InterBandeauDroite\r\n          handleDisconnect={handleDisconnect}\r\n          configuration={configuration}\r\n        />\r\n      </div>\r\n\r\n      : null\r\n\r\n  );\r\n\r\n}\r\n\r\nexport default InterInterface;\r\n\r\n"]},"metadata":{},"sourceType":"module"}