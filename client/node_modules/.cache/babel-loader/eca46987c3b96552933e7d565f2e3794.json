{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hugo Dufr\\xEAne\\\\decitude\\\\client\\\\src\\\\routes\\\\InterfaceInter.js\",\n    _s = $RefreshSig$();\n\nimport \"../styles/App.css\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport PlayAPI from \"../API/PlayAPI\"; // import BandeauTop from \"../components/interfaceJoueur/BandeauTop\"\n// import BandeauBottom from \"../components/interfaceJoueur/BandeauBottom\"\n\nimport Grille from \"../components/interfaceJoueur/Grille\";\nimport { useHistory } from 'react-router-dom';\nimport cookie from 'react-cookies';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst InterfaceInter = () => {\n  _s();\n\n  const history = useHistory();\n  const user = cookie.load(\"user\"); // console.log(user)\n  // if(user==null || user==undefined) history.push(\"/login\");\n\n  const [numPompier, setNumPompier] = useState(0);\n  const [currentTour, setCurrentTour] = useState(null);\n  const [currentCycle, setCurrentCycle] = useState(null);\n  const [session, setSession] = useState(user.session);\n  const [equipe, setEquipe] = useState(user.equipe);\n  const [chrono, setChrono] = useState(null);\n  useEffect(() => {\n    console.log(chrono);\n\n    if (currentTour == numPompier) {\n      if (chrono > 0) {\n        var chronoTimer = setInterval(() => {\n          setChrono(chrono => chrono - 1);\n        }, 1000);\n      }\n\n      return () => {\n        clearInterval(chronoTimer);\n      };\n    }\n  }, [chrono]);\n  const [configuration, setConfiguration] = useState(null);\n  useEffect(() => {\n    console.log(configuration);\n\n    if (configuration != null) {\n      setChrono(configuration.chronoTour.valeur);\n    }\n  }, [configuration]); // const [stocks, setStocks] = useState({\n  //   Interventions: 10,\n  //   Feu: 1,\n  //   FeuFum: 10,\n  //   Fum: 10,\n  //   Marqueur: 10,\n  // })\n\n  const [resultats, setResultats] = useState({\n    Decedes: 0,\n    Sauves: 0,\n    Marqueurs: 0\n  }); // const [interventions, setInterventions] = useState({\n  //   Deplacement: 0,\n  //   Feu: 0,\n  //   FeuFum: 0,\n  //   Fum: 0,\n  //   Marqueur: 0,\n  //   Porte: 0,\n  //   Habitant: 0\n  // })\n  // const [budget, setBudget] = useState(800)\n\n  const [position, setPosition] = useState([-1, -1]);\n  const isLoading = useRef(false); // INITIALISATION DE LA CARTE\n  // const [carte, setCarte] = useState([\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\n  // ])\n\n  const [carte, setCarte] = useState([]);\n  const [nbLignesGrille, setNbLignesGrille] = useState(0);\n  const [nbColonnesGrille, setNbColonnesGrille] = useState(0);\n  const [mursH, setMursH] = useState([[1, 1, 1, 1, 1, 1, 2, 6, 1, 1, 1, 1, 2, 5, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 2, 6, 1, 6, 2, 1, 1, 1, 5, 2, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 6, 2, 1, 1, 1, 1, 1, 1, 1, 1]]);\n  const [mursV, setMursV] = useState([[1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [2, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [5, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 2], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 5]]);\n\n  const getNombreMarqueurs = (mursH, mursV) => {\n    let nbMarqueurs = 0;\n    mursH.forEach(ligne => {\n      ligne.forEach(valeur => {\n        if (valeur == 3) nbMarqueurs = nbMarqueurs + 1;\n        if (valeur == 4) nbMarqueurs = nbMarqueurs + 2;\n      });\n    });\n    mursV.forEach(ligne => {\n      ligne.forEach(valeur => {\n        if (valeur == 3) nbMarqueurs = nbMarqueurs + 1;\n        if (valeur == 4) nbMarqueurs = nbMarqueurs + 2;\n      });\n    });\n    return nbMarqueurs;\n  }; // GET PLAY PARAMETERS \n\n\n  const getPlayState = async (session, equipe) => {\n    if (!isLoading.current) {\n      isLoading.current = true;\n      const currentPlayState = await PlayAPI.getPlayState(session, equipe);\n\n      if (Object.keys(currentPlayState).length > 0) {\n        // console.log(\"Get play state 2\")\n        console.log(parseInt(JSON.parse(currentPlayState.currentTour.valeur)));\n        setCurrentTour(parseInt(JSON.parse(currentPlayState.currentTour.valeur)));\n        setCurrentCycle(parseInt(JSON.parse(currentPlayState.currentCycle.valeur)));\n        const mursH = JSON.parse(currentPlayState.mursH.valeur);\n        const mursV = JSON.parse(currentPlayState.mursV.valeur);\n        setMursH(mursH);\n        setMursV(mursV);\n        setCarte(JSON.parse(currentPlayState.carte.valeur));\n        setResultats({\n          Decedes: parseInt(JSON.parse(currentPlayState.resultatsDecedes.valeur)),\n          Sauves: parseInt(JSON.parse(currentPlayState.resultatsSauves.valeur)),\n          Marqueurs: getNombreMarqueurs(mursH, mursV)\n        });\n      }\n\n      getPositionFromCarte(JSON.parse(currentPlayState.carte.valeur));\n      isLoading.current = false;\n    }\n  };\n\n  useEffect(() => {\n    console.log(carte);\n\n    if (carte.length > 0) {\n      setNbLignesGrille(carte.length);\n      setNbColonnesGrille(carte[0].length);\n    }\n  }, [carte]);\n  useEffect(() => {\n    console.log(currentTour);\n  }, [currentTour]);\n  useEffect(() => {\n    if (session != null && equipe != null && currentTour == null) {\n      // if(!isLoading.current) getPlayState(session,equipe)\n      // getPlayParameters()\n      getPositionFromCarte();\n    }\n  }, [session, equipe, numPompier]);\n\n  const getPlayParameters = async () => {\n    const param = await PlayAPI.getConfiguration(session);\n    setConfiguration(param);\n  };\n\n  const getPositionFromCarte = carte => {\n    console.log(carte);\n\n    if (carte != null && carte.length > 0) {\n      carte.forEach((ligne, indexI) => {\n        ligne.forEach((valeur, indexJ) => {\n          if (Math.floor(valeur / 100) == 1 && valeur % 100 / 10 == numPompier) setPosition([indexI, indexJ]);\n        });\n      });\n    }\n  };\n\n  const onTextChange = e => {\n    setNumPompier(e.target.value);\n    console.log(typeof e.target.value);\n  };\n\n  const onXChange = e => {\n    e.preventDefault();\n\n    if (e.target.value.length > 0) {\n      updateCarte(position, 0);\n      setPosition(position => [position[0], parseInt(e.target.value)]);\n    } else {\n      updateCarte(position, 0);\n      setPosition(position => [position[0], 0]);\n    }\n  };\n\n  const onYChange = e => {\n    e.preventDefault();\n\n    if (e.target.value.length > 0) {\n      updateCarte(position, 0);\n      setPosition(position => [parseInt(e.target.value), position[1]]);\n    } else {\n      updateCarte(position, 0);\n      setPosition(position => [0, position[1]]);\n    }\n  }; // UPDATES\n\n\n  const updateCarte = (coords, value) => {\n    if (coords[0] < nbLignesGrille && coords[1] < nbColonnesGrille) {\n      try {\n        var c = [...carte];\n        c[coords[0]][coords[1]] = value;\n        setCarte(c);\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  };\n\n  const updateMurH = (coords, value) => {\n    if (coords[0] < mursH.length && coords[1] < mursH[0].length) {\n      try {\n        var m = [...mursH];\n        m[coords[0]][coords[1]] = value;\n        setMursH(m);\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  };\n\n  const updateMurV = (coords, value) => {\n    if (coords[0] < mursV.length && coords[1] < mursV[0].length) {\n      try {\n        var m = [...mursV];\n        m[coords[0]][coords[1]] = value;\n        setMursV(m);\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  }; // ACTIONS\n\n\n  const updateBudget = action => {\n    var depenses = 0;\n    if (configuration[\"coutEq\" + action] != null) depenses += configuration[\"coutEq\" + action].valeur;\n    if (configuration[\"coutInter\" + action] != null) depenses += configuration[\"coutInter\" + action].valeur;\n    setBudget(budget => budget - depenses);\n  };\n\n  const doAction = action => {\n    try {\n      if (Object.keys(stocks).includes(action)) {\n        var s = stocks;\n        s[action] = s[action] - 1;\n        setStocks(s);\n      }\n    } catch (error) {}\n\n    try {\n      if (Object.keys(interventions).includes(action)) {\n        var i = interventions;\n        i[action] = i[action] - 1;\n        setInterventions(i);\n      }\n    } catch (error) {}\n\n    updateBudget(action);\n  };\n\n  const updateResultats = sauve => {\n    var res = resultats;\n\n    if (sauve) {\n      res.nbSauves += 1;\n    } else {\n      res.nbDecedes += 1;\n    }\n\n    setResultats(res);\n  };\n\n  useEffect(() => {\n    setBtnClickedBottom(null);\n    revealHabitant();\n  }, [position]);\n  useEffect(() => {\n    if (carte.length > 0) relacherHabitant();\n  }, [position, mursH, mursV]); // useEffect(() => {\n  //   console.log(\"Stocks\")\n  //   console.log(stocks)\n  // }, [stocks])\n\n  useEffect(() => {\n    if (configuration != null) {\n      var inter = interventions;\n      const interKeys = Object.keys(inter);\n      interKeys.forEach(action => {\n        try {\n          if (configuration[\"coutInter\" + action].valeur > 0) {\n            inter[action] = Math.min(configuration[\"coutEq\" + action] != null && configuration[\"coutEq\" + action] != undefined ? Math.floor(budget / (configuration[\"coutInter\" + action].valeur + configuration[\"coutEq\" + action].valeur)) : Math.floor(budget / configuration[\"coutInter\" + action].valeur), stocks[action] != null && stocks[action] != undefined && stocks[action] != \"NaN\" ? stocks[action] : 1000);\n          }\n        } catch (error) {\n          console.log(error, action);\n        }\n      });\n      setInterventions(inter);\n    } else {// getPlayParameters()\n    }\n  }, [budget, configuration, numPompier]); // SOCKETS\n\n  const socket = PlayAPI.getSocket(); // SOCKETS \n\n  const onTourChange = async e => {\n    e.preventDefault();\n    console.log(\"nouveau tour todo\");\n  };\n\n  useEffect(() => {\n    socket.on('changementTour', data => {\n      console.log(\"socket nouveau tour\"); // setCurrentTour(data.numPompier + 1)\n      // getPlayState(session,equipe)\n    });\n  }); // TESTS\n\n  const test = async () => {\n    console.log(\"test function\");\n  };\n\n  const renderTests = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        top: 200\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        style: {\n          flex: 1,\n          flexDirection: \"column\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: e => onTourChange(e),\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"Manual settings\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"name-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"numPompier\",\n              children: \"Num\\xE9ro pompier\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 428,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              name: \"numPompier\",\n              onChange: e => onTextChange(e),\n              value: numPompier,\n              label: \"Num\\xE9ro pompier\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 429,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 13\n          }, this), currentTour == numPompier ? /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"Fin du tour\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: true,\n            children: \"Fin du tour\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          flexDirection: \"column\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"numPompier\",\n          children: \"Position x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"xPompier\",\n          onChange: e => onXChange(e),\n          value: position[1]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 449,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"numPompier\",\n          children: \"Position y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"yPompier\",\n          onChange: e => onYChange(e),\n          value: position[0]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 456,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => test(),\n        children: \"test function\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 7\n    }, this);\n  }; // AUTORISATIONS \n\n\n  const deplacementAutorise = deplacement => {\n    // return true\n    var dpl = [...deplacement];\n    if (dpl[0] == 0 && dpl[1] == 0) return false;\n    if (position[0] + dpl[0] > carte.length - 1 || position[1] + dpl[1] > carte[0].length - 1 || position[0] + dpl[0] < 0 || position[1] + dpl[1] < 0) return false;\n    const dplInterditsCases = [100, 20, 3, 4];\n\n    try {\n      const valeurCaseDeplacement = carte[position[0] + dpl[0]][position[1] + dpl[1]];\n      if (Math.floor(valeurCaseDeplacement / 100) == 1) return false;\n      if (Math.floor(valeurCaseDeplacement / 10) == 2) return false;\n      if (dplInterditsCases.includes(valeurCaseDeplacement)) return false;\n    } catch (error) {}\n\n    const dplInterditsMurs = [1, 2, 3, 5];\n\n    try {\n      if (dpl[0] != 0) {\n        // haut bas\n        if (dpl[0] < 0) {\n          dpl[0] = 0;\n        }\n\n        if (typeof mursH[position[0] + dpl[0]][position[1]] === 'undefined') return false;\n        if (dplInterditsMurs.includes(mursH[position[0] + dpl[0]][position[1]])) return false;\n      } else {\n        // gauche droite\n        if (dpl[1] < 0) {\n          dpl[1] = 0;\n        }\n\n        if (typeof mursV[position[0]][position[1] + dpl[1]] === 'undefined') return false;\n        if (dplInterditsMurs.includes(mursV[position[0]][position[1] + dpl[1]])) return false;\n      }\n    } catch (error) {}\n\n    return true;\n  };\n\n  const testRelacherHabitant = () => {\n    if (carte[position[0]][position[1]] % 10 == 0) return false; // pas de transport d'habitant\n\n    const mursBloquants = [1, 2, 3, 5];\n    if (position[0] == 0 && !mursBloquants.includes(mursH[position[0]][position[1]])) return true; // haut\n\n    if (position[0] == nbLignesGrille - 1 && !mursBloquants.includes(mursH[position[0] + 1][position[1]])) return true; // bas\n\n    if (position[1] == 0 && !mursBloquants.includes(mursV[position[0]][position[1]])) return true; // gauche\n\n    if (position[1] == nbColonnesGrille - 1 && !mursBloquants.includes(mursV[position[0]][position[1] + 1])) return true; // droite\n\n    return false;\n  };\n\n  const relacherHabitant = () => {\n    if (testRelacherHabitant()) {\n      setTimeout(() => {\n        updateResultats(true);\n        updateCarte(position, 100 + numPompier * 10);\n      }, 1000);\n    }\n  };\n\n  const revealHabitant = () => {\n    if (configuration != null) {\n      const casesAutour = getCasesAutour();\n      console.log(configuration);\n      const nouvelHabitant = Math.random() <= configuration.txApparitionHab.valeur;\n\n      try {\n        if (casesAutour.dessus == 20) updateCarte([position[0] - 1, position[1]], nouvelHabitant ? 20 + Math.floor(configuration.nbHabDifferents.valeur * Math.random()) + 1 : 0);\n      } catch (error) {}\n\n      try {\n        if (casesAutour.droite == 20) updateCarte([position[0], position[1] + 1], nouvelHabitant ? 20 + Math.floor(configuration.nbHabDifferents.valeur * Math.random()) + 1 : 0);\n      } catch (error) {}\n\n      try {\n        if (casesAutour.dessous == 20) updateCarte([position[0] + 1, position[1]], nouvelHabitant ? 20 + Math.floor(configuration.nbHabDifferents.valeur * Math.random()) + 1 : 0);\n      } catch (error) {}\n\n      try {\n        if (casesAutour.gauche == 20) updateCarte([position[0], position[1] - 1], nouvelHabitant ? 20 + Math.floor(configuration.nbHabDifferents.valeur * Math.random()) + 1 : 0);\n      } catch (error) {}\n    }\n  };\n\n  const getCasesAutour = () => {\n    var cases = {};\n\n    try {\n      cases[\"dessus\"] = carte[position[0] - 1][position[1]]; // dessus\n    } catch (error) {}\n\n    try {\n      cases[\"droite\"] = carte[position[0]][position[1] + 1]; // droite\n    } catch (error) {}\n\n    try {\n      cases[\"dessous\"] = carte[position[0] + 1][position[1]]; // dessous\n    } catch (error) {}\n\n    try {\n      cases[\"gauche\"] = carte[position[0]][position[1] - 1]; // gauche\n    } catch (error) {}\n\n    return cases;\n  };\n\n  const getMursAutour = () => {\n    var murs = [];\n\n    try {\n      if (mursH[position[0]][position[1]] != 4 || mursH[position[0]][position[1] - 1] < 6 && mursH[position[0]][position[1] + 1] < 6) {\n        murs.push(mursH[position[0]][position[1]]); // dessus\n      } else {\n        murs.push(0);\n      }\n    } catch (error) {}\n\n    try {\n      if (mursV[position[0]][position[1] + 1] != 4 || mursV[position[0] - 1][position[1] + 1] < 6 && mursV[position[0] + 1][position[1] + 1] < 6) {\n        murs.push(mursV[position[0]][position[1] + 1]); // droite\n      } else {\n        murs.push(0);\n      }\n    } catch (error) {}\n\n    try {\n      if (mursH[position[0] + 1][position[1]] != 4 || mursH[position[0] + 1][position[1] - 1] < 6 && mursH[position[0] + 1][position[1] + 1] < 6) {\n        murs.push(mursH[position[0] + 1][position[1]]); // dessous\n      } else {\n        murs.push(0);\n      }\n    } catch (error) {}\n\n    try {\n      if (mursV[position[0]][position[1]] != 4 || mursV[position[0] - 1][position[1]] < 6 && mursV[position[0] + 1][position[1]] < 6) {\n        murs.push(mursV[position[0]][position[1]]); // gauche\n      } else {\n        murs.push(0);\n      }\n    } catch (error) {} // console.log(murs)\n\n\n    return murs;\n  };\n\n  const [btnClickedBottom, setBtnClickedBottom] = useState(null);\n  const [propositionsCase, setPropositionsCase] = useState([]); // Extincteurs\n\n  const [propositionMursDetruire, setPropositionMursDetruire] = useState([[], []]); // Horizontaux  , Verticaux\n\n  useEffect(() => {\n    if (btnClickedBottom != 3 || btnClickedBottom == null) {\n      setPropositionMursDetruire([[], []]);\n    }\n\n    if (btnClickedBottom > 2 && btnClickedBottom < 6 || btnClickedBottom == null) {\n      setPropositionsCase([]);\n    }\n  }, [btnClickedBottom]); // HANDLERS CLIC GRILLE\n\n  const handleClicCase = (valeurAvant, valeurApres, coordX, coordY) => {\n    console.log(valeurAvant, valeurApres, coordX, coordY);\n\n    try {\n      updateCarte([coordY, coordX], valeurApres);\n      setPropositionsCase([]);\n      setBtnClickedBottom(null);\n\n      if (valeurAvant == 4 && valeurApres == 0) {\n        // Extincteur flamme\n        doAction(\"Feu\");\n      }\n\n      if (valeurAvant == 4 && valeurApres == 3) {\n        // Feu Fumée\n        doAction(\"FeuFum\");\n      }\n\n      if (valeurAvant == 3 && valeurApres == 0) {\n        // Fumée\n        doAction(\"Fum\");\n      }\n\n      if (Math.floor(valeurAvant / 10) == 2 && valeurApres == 0) {\n        // Habitant\n        doAction(\"Habitant\");\n        updateCarte(position, 100 + numPompier * 10 + valeurAvant % 10);\n      }\n    } catch (error) {}\n  };\n\n  const handleClicMur = (num, valeurAvant, coordX, coordY) => {\n    // marqueur dégat\n    if (propositionMursDetruire[0].length > 0 || propositionMursDetruire[1].length > 0) {\n      const checkInCoords = index => {\n        // console.log(\"coordx\",coordX,\"coordy\",coordY,\"position\",position)\n        let numClic = null;\n\n        if (coordX == position[1] && (coordY < position[0] || coordY == position[0] && num == 0)) {\n          // top\n          numClic = 0; // case en question\n          // console.log(\"top\",numClic)\n        }\n\n        if (coordX == position[1] && (coordY > position[0] || coordY == position[0] && num == 2)) {\n          // bottom\n          numClic = 2; // case en question\n          // console.log(\"bottom\",numClic)\n        }\n\n        if (coordY == position[0] && (coordX < position[1] || coordX == position[1] && num == 3)) {\n          // left\n          numClic = 3; // case en question\n          // console.log(\"left\",numClic)\n        }\n\n        if (coordY == position[0] && (coordX > position[1] || coordX == position[1] && num == 1)) {\n          // right\n          numClic = 1; // case en question\n          // console.log(\"right\",numClic)\n        }\n\n        return numClic;\n      };\n\n      var cote = checkInCoords(num % 2);\n      let valeurApres = 4;\n      if (valeurAvant == 1) valeurApres = 3;\n\n      if (cote != null) {\n        try {\n          switch (cote) {\n            case 0:\n              updateMurH([position[0], position[1]], valeurApres); // if(valeurAvant==5 ||)\n\n              break;\n\n            case 1:\n              updateMurV([position[0], position[1] + 1], valeurApres);\n              break;\n\n            case 2:\n              updateMurH([position[0] + 1, position[1]], valeurApres);\n              break;\n\n            case 3:\n              updateMurV([position[0], position[1]], valeurApres);\n              break;\n          }\n\n          doAction(\"Marqueur\");\n        } catch (error) {}\n\n        setPropositionMursDetruire([[], []]);\n        setBtnClickedBottom(null);\n      }\n    }\n  }; // HANDLER CLICS BOUTONS\n\n\n  const handleClicFleche = num => {\n    // Position y x\n    let deplacement;\n\n    switch (num) {\n      case 0:\n        // haut\n        console.log(\"haut\");\n        deplacement = [-1, 0];\n        break;\n\n      case 1:\n        // droite\n        console.log(\"droite\");\n        deplacement = [0, 1];\n        break;\n\n      case 2:\n        // bas\n        console.log(\"bas\");\n        deplacement = [1, 0];\n        break;\n\n      case 3:\n        // gauche\n        console.log(\"gauche\");\n        deplacement = [0, -1];\n        break;\n    }\n\n    if (deplacementAutorise(deplacement)) {\n      updateCarte([position[0] + deplacement[0], position[1] + deplacement[1]], carte[position[0]][position[1]]);\n      setPosition(position => [position[0] + deplacement[0], position[1] + deplacement[1]]);\n      doAction(\"Deplacement\");\n      updateCarte(position, 0);\n    }\n  };\n\n  const handleClicDoor = ouvrir => {\n    // position, ouvert/fermé\n    setBtnClickedBottom(ouvrir ? 4 : 5);\n    let valueAvant;\n    let valueApres;\n\n    if (ouvrir) {\n      valueAvant = 5;\n      valueApres = 6;\n    } else {\n      valueAvant = 6;\n      valueApres = 5;\n    }\n\n    doAction(\"Porte\");\n\n    try {\n      if (mursH[position[0]][position[1]] == valueAvant) updateMurH([position[0], position[1]], valueApres);\n      if (mursH[position[0] + 1][position[1]] == valueAvant) updateMurH([position[0] + 1, position[1]], valueApres);\n      if (mursV[position[0]][position[1]] == valueAvant) updateMurV([position[0], position[1]], valueApres);\n      if (mursV[position[0]][position[1] + 1] == valueAvant) updateMurV([position[0], position[1] + 1], valueApres);\n    } catch (error) {}\n  };\n\n  const handleClicExtincteur = num => {\n    // 0 FEU, 1 FEUFUM, 2 FUM\n    if (btnClickedBottom != num) {\n      var listeCasesAction = [];\n      let valeurAvant = 4;\n      let valeurApres = 0;\n      setBtnClickedBottom(num);\n\n      switch (num) {\n        case 0:\n          // ETEINDRE FEU\n          break;\n\n        case 1:\n          // FEU FUM\n          valeurApres = 3;\n          break;\n\n        case 2:\n          // ETEINDRE FUMEE\n          valeurAvant = 3;\n          break;\n      }\n\n      try {\n        if (carte[position[0] - 1][position[1]] == valeurAvant) listeCasesAction.push([position[0] - 1, position[1], valeurAvant, valeurApres]); // TOP\n      } catch (error) {}\n\n      try {\n        if (carte[position[0]][position[1] + 1] == valeurAvant) listeCasesAction.push([position[0], position[1] + 1, valeurAvant, valeurApres]); // RIGHT\n      } catch (error) {}\n\n      try {\n        if (carte[position[0] + 1][position[1]] == valeurAvant) listeCasesAction.push([position[0] + 1, position[1], valeurAvant, valeurApres]); // BOTTOM\n      } catch (error) {}\n\n      try {\n        if (carte[position[0]][position[1] - 1] == valeurAvant) listeCasesAction.push([position[0], position[1] - 1, valeurAvant, valeurApres]); // LEFT\n      } catch (error) {}\n\n      setPropositionsCase(listeCasesAction);\n    } else {\n      setBtnClickedBottom(null);\n    }\n  };\n\n  const handleClicMarqueur = () => {\n    if (btnClickedBottom != 3) {\n      setBtnClickedBottom(3);\n\n      if (propositionMursDetruire[0].length > 0 || propositionMursDetruire[1].length > 0) {\n        setPropositionMursDetruire([[], []]);\n      } else {\n        const mursADetruire = [1, 3, 5, 6];\n        var propositions = [[], []];\n        const mursAutour = getMursAutour();\n\n        try {\n          if (mursADetruire.includes(mursAutour[0])) propositions[0].push([position[1], position[0]]); // top\n\n          if (mursADetruire.includes(mursAutour[1])) propositions[1].push([position[1] + 1, position[0]]); // right\n\n          if (mursADetruire.includes(mursAutour[2])) propositions[0].push([position[1], position[0] + 1]); // bottom\n\n          if (mursADetruire.includes(mursAutour[3])) propositions[1].push([position[1], position[0]]); // left\n        } catch (error) {}\n\n        setPropositionMursDetruire(propositions);\n      }\n    } else {\n      setBtnClickedBottom(null);\n    }\n  };\n\n  const handleClicValidated = async bool => {\n    if (bool) {\n      const response = await PlayAPI.nouveauTour(numPompier, carte, mursH, mursV, currentCycle, currentTour + 1, resultats.Decedes, resultats.Sauves, session, equipe);\n    }\n  };\n\n  const handleNoClicked = () => {\n    setPropositionMursDetruire([[], []]);\n    setPropositionsCase([]);\n  };\n\n  const handleClicHabitant = () => {\n    if (btnClickedBottom != 6) {\n      setBtnClickedBottom(6);\n      const valeurApres = 0;\n      var listeCasesAction = [];\n\n      try {\n        const valeurDessus = carte[position[0] - 1][position[1]];\n        if (Math.floor(valeurDessus / 10) == 2) listeCasesAction.push([position[0] - 1, position[1], valeurDessus, valeurApres]); // TOP\n      } catch (error) {}\n\n      try {\n        const valeurDroite = carte[position[0]][position[1] + 1];\n        if (Math.floor(valeurDroite / 10) == 2) listeCasesAction.push([position[0], position[1] + 1, valeurDroite, valeurApres]); // RIGHT\n      } catch (error) {}\n\n      try {\n        const valeurDessous = carte[position[0] + 1][position[1]];\n        if (Math.floor(valeurDessous / 10) == 2) listeCasesAction.push([position[0] + 1, position[1], valeurDessous, valeurApres]); // BOTTOM\n      } catch (error) {}\n\n      try {\n        const valeurGauche = carte[position[0]][position[1] - 1];\n        if (Math.floor(valeurGauche / 10) == 2) listeCasesAction.push([position[0], position[1] - 1, valeurGauche, valeurApres]); // LEFT\n      } catch (error) {}\n\n      setPropositionsCase(listeCasesAction);\n      console.log(\"handle clic habitant\");\n    } else {\n      setBtnClickedBottom(null);\n    }\n  };\n\n  return carte.length > 0 && position != null ? /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Grille, {\n      nbColonnesGrille: nbColonnesGrille,\n      nbLignesGrille: nbLignesGrille,\n      carte: carte,\n      position: position,\n      mursH: mursH,\n      mursV: mursV,\n      propositionMursDetruire: propositionMursDetruire,\n      propositionsCase: propositionsCase,\n      handleClicMur: handleClicMur,\n      handleClicCase: handleClicCase\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 906,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(BandeauTop, {\n      stocks: stocks,\n      resultats: resultats,\n      numeroPompier: numPompier,\n      cycle: currentCycle,\n      tour: currentTour,\n      configuration: configuration,\n      budget: budget,\n      chrono: chrono\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 921,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(BandeauBottom, {\n      interventions: interventions,\n      stocks: stocks,\n      numeroPompier: numPompier,\n      tour: currentTour,\n      handleClicFleche: handleClicFleche,\n      handleClicValidated: handleClicValidated,\n      handleClicDoor: handleClicDoor,\n      handleClicMarqueur: handleClicMarqueur,\n      handleClicExt: handleClicExtincteur,\n      handleNoClicked: handleNoClicked,\n      handleClicHabitant: handleClicHabitant,\n      btnClickedBottom: btnClickedBottom,\n      mursAutour: getMursAutour(),\n      casesAutour: getCasesAutour(),\n      currentCase: carte[position[0]][position[1]]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 932,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 905,\n    columnNumber: 9\n  }, this) : null;\n};\n\n_s(InterfaceInter, \"GkBuY44nXlSm73n5LqPYEOLv270=\", false, function () {\n  return [useHistory];\n});\n\n_c = InterfaceInter;\nexport default InterfaceInter;\n\nvar _c;\n\n$RefreshReg$(_c, \"InterfaceInter\");","map":{"version":3,"sources":["C:/Users/Hugo Dufrêne/decitude/client/src/routes/InterfaceInter.js"],"names":["React","useState","useEffect","useRef","PlayAPI","Grille","useHistory","cookie","InterfaceInter","history","user","load","numPompier","setNumPompier","currentTour","setCurrentTour","currentCycle","setCurrentCycle","session","setSession","equipe","setEquipe","chrono","setChrono","console","log","chronoTimer","setInterval","clearInterval","configuration","setConfiguration","chronoTour","valeur","resultats","setResultats","Decedes","Sauves","Marqueurs","position","setPosition","isLoading","carte","setCarte","nbLignesGrille","setNbLignesGrille","nbColonnesGrille","setNbColonnesGrille","mursH","setMursH","mursV","setMursV","getNombreMarqueurs","nbMarqueurs","forEach","ligne","getPlayState","current","currentPlayState","Object","keys","length","parseInt","JSON","parse","resultatsDecedes","resultatsSauves","getPositionFromCarte","getPlayParameters","param","getConfiguration","indexI","indexJ","Math","floor","onTextChange","e","target","value","onXChange","preventDefault","updateCarte","onYChange","coords","c","error","updateMurH","m","updateMurV","updateBudget","action","depenses","setBudget","budget","doAction","stocks","includes","s","setStocks","interventions","i","setInterventions","updateResultats","sauve","res","nbSauves","nbDecedes","setBtnClickedBottom","revealHabitant","relacherHabitant","inter","interKeys","min","undefined","socket","getSocket","onTourChange","on","data","test","renderTests","top","flex","flexDirection","deplacementAutorise","deplacement","dpl","dplInterditsCases","valeurCaseDeplacement","dplInterditsMurs","testRelacherHabitant","mursBloquants","setTimeout","casesAutour","getCasesAutour","nouvelHabitant","random","txApparitionHab","dessus","nbHabDifferents","droite","dessous","gauche","cases","getMursAutour","murs","push","btnClickedBottom","propositionsCase","setPropositionsCase","propositionMursDetruire","setPropositionMursDetruire","handleClicCase","valeurAvant","valeurApres","coordX","coordY","handleClicMur","num","checkInCoords","index","numClic","cote","handleClicFleche","handleClicDoor","ouvrir","valueAvant","valueApres","handleClicExtincteur","listeCasesAction","handleClicMarqueur","mursADetruire","propositions","mursAutour","handleClicValidated","bool","response","nouveauTour","handleNoClicked","handleClicHabitant","valeurDessus","valeurDroite","valeurDessous","valeurGauche"],"mappings":"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","sourcesContent":["import \"../styles/App.css\"\r\nimport React, { useState, useEffect,useRef } from 'react'\r\nimport PlayAPI from \"../API/PlayAPI\"\r\n// import BandeauTop from \"../components/interfaceJoueur/BandeauTop\"\r\n// import BandeauBottom from \"../components/interfaceJoueur/BandeauBottom\"\r\nimport Grille from \"../components/interfaceJoueur/Grille\"\r\nimport { useHistory } from 'react-router-dom';\r\n\r\n\r\nimport cookie from 'react-cookies'\r\n\r\n\r\nconst InterfaceInter = () => {\r\n\r\n  const history = useHistory()\r\n\r\n  const user = cookie.load(\"user\")\r\n  // console.log(user)\r\n  // if(user==null || user==undefined) history.push(\"/login\");\r\n\r\n\r\n\r\n  const [numPompier, setNumPompier] = useState(0)\r\n  const [currentTour, setCurrentTour] = useState(null)\r\n  const [currentCycle, setCurrentCycle] = useState(null)\r\n  const [session,setSession]=useState(user.session)\r\n  const [equipe,setEquipe]=useState(user.equipe)\r\n  const [chrono,setChrono]=useState(null)\r\n\r\n  useEffect(() => {\r\n    console.log(chrono)\r\n    if(currentTour==numPompier){\r\n      if (chrono > 0) {\r\n\r\n        var chronoTimer = setInterval(() => {\r\n          setChrono(chrono => chrono - 1)\r\n\r\n        }, 1000)\r\n\r\n      }\r\n    return () => {\r\n      clearInterval(chronoTimer)\r\n    }\r\n  }\r\n  }, [chrono])\r\n\r\n\r\n\r\n  const [configuration, setConfiguration] = useState(null)\r\n  useEffect(()=>{\r\n    console.log(configuration)\r\n    if(configuration!=null){\r\n      setChrono(configuration.chronoTour.valeur)\r\n    }\r\n  },[configuration])\r\n\r\n  // const [stocks, setStocks] = useState({\r\n  //   Interventions: 10,\r\n  //   Feu: 1,\r\n  //   FeuFum: 10,\r\n  //   Fum: 10,\r\n  //   Marqueur: 10,\r\n  // })\r\n\r\n  const [resultats, setResultats] = useState({\r\n    Decedes: 0,\r\n    Sauves: 0,\r\n    Marqueurs:0\r\n  })\r\n\r\n  // const [interventions, setInterventions] = useState({\r\n  //   Deplacement: 0,\r\n  //   Feu: 0,\r\n  //   FeuFum: 0,\r\n  //   Fum: 0,\r\n  //   Marqueur: 0,\r\n  //   Porte: 0,\r\n  //   Habitant: 0\r\n  // })\r\n\r\n  // const [budget, setBudget] = useState(800)\r\n\r\n  \r\n\r\n  const [position, setPosition] = useState([-1,-1])\r\n\r\n  const isLoading=useRef(false)\r\n\r\n  // INITIALISATION DE LA CARTE\r\n\r\n  // const [carte, setCarte] = useState([\r\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\r\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\r\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\r\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\r\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\r\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\r\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\r\n  //   [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],\r\n  // ])\r\n  \r\n  const [carte, setCarte] = useState([])\r\n\r\n  const [nbLignesGrille,setNbLignesGrille] = useState(0)\r\n  const [nbColonnesGrille,setNbColonnesGrille ]= useState(0)\r\n\r\n  const [mursH, setMursH] = useState([\r\n    [1, 1, 1, 1, 1, 1, 2, 6, 1, 1, 1, 1, 2, 5, 1, 1],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [1, 1, 1, 1, 2, 6, 1, 6, 2, 1, 1, 1, 5, 2, 1, 1],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n    [1, 1, 1, 1, 1, 1, 6, 2, 1, 1, 1, 1, 1, 1, 1, 1]\r\n  ])\r\n\r\n  const [mursV, setMursV] = useState([\r\n    [1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    [2, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    [5, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 0, 0, 1],\r\n    [1, 0, 0, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 2],\r\n    [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 5]\r\n  ])\r\n\r\n\r\n  const getNombreMarqueurs=(mursH,mursV)=>{\r\n    let nbMarqueurs = 0\r\n    mursH.forEach(ligne=>{\r\n      ligne.forEach(valeur=>{\r\n        if(valeur == 3) nbMarqueurs=nbMarqueurs+1\r\n        if(valeur == 4) nbMarqueurs=nbMarqueurs+2\r\n      })\r\n    })\r\n    mursV.forEach(ligne=>{\r\n      ligne.forEach(valeur=>{\r\n        if(valeur == 3) nbMarqueurs=nbMarqueurs+1\r\n        if(valeur == 4) nbMarqueurs=nbMarqueurs+2\r\n      })\r\n    })\r\n    return nbMarqueurs\r\n  }\r\n\r\n  // GET PLAY PARAMETERS \r\n  const getPlayState=async(session,equipe)=>{\r\n    if(!isLoading.current){\r\n      isLoading.current=true\r\n      const currentPlayState = await PlayAPI.getPlayState(session,equipe)\r\n    \r\n      if(Object.keys(currentPlayState).length>0 ){\r\n        // console.log(\"Get play state 2\")\r\n        console.log(parseInt(JSON.parse(currentPlayState.currentTour.valeur)))\r\n\r\n        setCurrentTour(parseInt(JSON.parse(currentPlayState.currentTour.valeur)))\r\n        setCurrentCycle(parseInt(JSON.parse(currentPlayState.currentCycle.valeur)))\r\n        const mursH=JSON.parse(currentPlayState.mursH.valeur)\r\n        const mursV=JSON.parse(currentPlayState.mursV.valeur)\r\n        setMursH(mursH)\r\n        setMursV(mursV)\r\n        setCarte(JSON.parse(currentPlayState.carte.valeur))\r\n        setResultats({\r\n          Decedes:parseInt(JSON.parse(currentPlayState.resultatsDecedes.valeur)),\r\n          Sauves:parseInt(JSON.parse(currentPlayState.resultatsSauves.valeur)),\r\n          Marqueurs:getNombreMarqueurs(mursH,mursV)\r\n        })\r\n      }\r\n      getPositionFromCarte(JSON.parse(currentPlayState.carte.valeur))\r\n      isLoading.current=false\r\n    }\r\n    \r\n  }\r\n\r\n\r\n  useEffect(()=>{\r\n    console.log(carte)\r\n    if(carte.length>0){\r\n      setNbLignesGrille(carte.length)\r\n      setNbColonnesGrille(carte[0].length)\r\n    }\r\n\r\n  },[carte])\r\n\r\n  useEffect(()=>{\r\n    console.log(currentTour)\r\n  },[currentTour])\r\n\r\n\r\n  useEffect(()=>{\r\n    if(session!=null && equipe!=null && currentTour==null){\r\n      // if(!isLoading.current) getPlayState(session,equipe)\r\n      // getPlayParameters()\r\n      getPositionFromCarte()\r\n    }\r\n  },[session,equipe,numPompier])\r\n\r\n  const getPlayParameters = async () => {\r\n    const param = await PlayAPI.getConfiguration(session)\r\n    setConfiguration(param)\r\n\r\n  }\r\n\r\n  const getPositionFromCarte=(carte)=>{\r\n    console.log(carte)\r\n    if(carte!=null && carte.length>0){\r\n      carte.forEach((ligne,indexI) => {\r\n        ligne.forEach((valeur,indexJ) => {\r\n  \r\n          if( Math.floor(valeur / 100) == 1 && valeur%100/10==numPompier) setPosition([indexI,indexJ])\r\n          \r\n        })\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const onTextChange = (e) => {\r\n    setNumPompier(e.target.value)\r\n    console.log(typeof (e.target.value))\r\n  }\r\n\r\n  const onXChange = (e) => {\r\n    e.preventDefault()\r\n    if (e.target.value.length > 0) {\r\n      updateCarte(position, 0)\r\n      setPosition(position => [position[0], parseInt(e.target.value)])\r\n    } else {\r\n      updateCarte(position, 0)\r\n      setPosition(position => [position[0], 0])\r\n    }\r\n\r\n  }\r\n  const onYChange = (e) => {\r\n    e.preventDefault()\r\n    if (e.target.value.length > 0) {\r\n      updateCarte(position, 0)\r\n      setPosition(position => [parseInt(e.target.value), position[1]])\r\n    } else {\r\n      updateCarte(position, 0)\r\n      setPosition(position => [0, position[1]])\r\n    }\r\n  }\r\n\r\n\r\n  // UPDATES\r\n  const updateCarte = (coords, value) => {\r\n    if (coords[0] < nbLignesGrille && coords[1] < nbColonnesGrille) {\r\n      try {\r\n        var c = [...carte]\r\n        c[coords[0]][coords[1]] = value\r\n        setCarte(c)\r\n      } catch (error) {\r\n        console.log(error)\r\n      }\r\n    }\r\n\r\n\r\n  }\r\n  const updateMurH = (coords, value) => {\r\n    if (coords[0] < mursH.length && coords[1] < mursH[0].length) {\r\n      try {\r\n        var m = [...mursH]\r\n        m[coords[0]][coords[1]] = value\r\n        setMursH(m)\r\n\r\n      } catch (error) {\r\n        console.log(error)\r\n      }\r\n    }\r\n  }\r\n  const updateMurV = (coords, value) => {\r\n    if (coords[0] < mursV.length && coords[1] < mursV[0].length) {\r\n      try {\r\n        var m = [...mursV]\r\n        m[coords[0]][coords[1]] = value\r\n        setMursV(m)\r\n      } catch (error) {\r\n        console.log(error)\r\n      }\r\n    }\r\n  }\r\n\r\n  // ACTIONS\r\n\r\n  const updateBudget = (action) => {\r\n    var depenses = 0\r\n    if (configuration[\"coutEq\" + action] != null) depenses += configuration[\"coutEq\" + action].valeur\r\n    if (configuration[\"coutInter\" + action] != null) depenses += configuration[\"coutInter\" + action].valeur\r\n    setBudget(budget => budget - depenses)\r\n  }\r\n\r\n\r\n  const doAction = (action) => {\r\n    try {\r\n      if(Object.keys(stocks).includes(action)){\r\n        var s = stocks\r\n        s[action] = s[action] - 1\r\n        setStocks(s)\r\n      }\r\n      \r\n    } catch (error) { }\r\n\r\n    try {\r\n      if(Object.keys(interventions).includes(action)){\r\n        var i = interventions\r\n      i[action] = i[action] - 1\r\n      setInterventions(i)\r\n      }      \r\n    } catch (error) { }\r\n\r\n    updateBudget(action)\r\n  }\r\n\r\n  const updateResultats = (sauve) => {\r\n    var res = resultats\r\n    if (sauve) {\r\n      res.nbSauves += 1\r\n    } else {\r\n      res.nbDecedes += 1\r\n    }\r\n    setResultats(res)\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    setBtnClickedBottom(null)\r\n    revealHabitant()\r\n  }, [position])\r\n\r\n\r\n  useEffect(() => {\r\n    if(carte.length>0) relacherHabitant()\r\n\r\n  }, [position, mursH, mursV])\r\n\r\n  \r\n\r\n\r\n  // useEffect(() => {\r\n  //   console.log(\"Stocks\")\r\n  //   console.log(stocks)\r\n  // }, [stocks])\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    if (configuration != null) {\r\n      var inter = interventions\r\n      const interKeys = Object.keys(inter)\r\n      interKeys.forEach(action => {\r\n        try {\r\n          if (configuration[\"coutInter\" + action].valeur > 0) {\r\n            inter[action] = Math.min(\r\n              configuration[\"coutEq\" + action] != null && configuration[\"coutEq\" + action] != undefined ? Math.floor(budget / (configuration[\"coutInter\" + action].valeur + configuration[\"coutEq\" + action].valeur)) : Math.floor(budget / configuration[\"coutInter\" + action].valeur),\r\n              stocks[action] != null && stocks[action] != undefined && stocks[action] !=\"NaN\" ? stocks[action] : 1000\r\n            )\r\n          }\r\n        } catch (error) {\r\n          console.log(error,action)\r\n        }\r\n\r\n      })\r\n      setInterventions(inter)\r\n      \r\n    } else {\r\n      // getPlayParameters()\r\n    }\r\n  }, [budget, configuration, numPompier])\r\n\r\n  // SOCKETS\r\n  const socket = PlayAPI.getSocket()\r\n\r\n  // SOCKETS \r\n  const onTourChange = async (e) => {\r\n    e.preventDefault()\r\n    console.log(\"nouveau tour todo\")\r\n  }\r\n\r\n\r\n  useEffect(() => {\r\n    socket.on('changementTour', (data) => {\r\n      console.log(\"socket nouveau tour\")\r\n      // setCurrentTour(data.numPompier + 1)\r\n      // getPlayState(session,equipe)\r\n    })\r\n  });\r\n\r\n\r\n\r\n  // TESTS\r\n\r\n  const test = async () => {\r\n\r\n    console.log(\"test function\")\r\n  }\r\n\r\n  const renderTests = () => {\r\n    return (\r\n      <div style={{ position: \"absolute\", top: 200 }}>\r\n        <div className=\"card\" style={{ flex: 1, flexDirection: \"column\" }}>\r\n          <form onSubmit={e => onTourChange(e)}>\r\n            <h1>Manual settings</h1>\r\n            <div className=\"name-field\">\r\n              <label htmlFor=\"numPompier\">Numéro pompier</label>\r\n              <input\r\n                type=\"number\"\r\n                name=\"numPompier\"\r\n                onChange={e => onTextChange(e)}\r\n                value={numPompier}\r\n                label=\"Numéro pompier\"\r\n              />\r\n            </div>\r\n            {currentTour == numPompier ?\r\n              <button>Fin du tour</button>\r\n              :\r\n              <button disabled>Fin du tour</button>\r\n\r\n            }\r\n\r\n          </form>\r\n\r\n        </div>\r\n        <div style={{ flex: 1, flexDirection: \"column\" }}>\r\n          <label htmlFor=\"numPompier\">Position x</label>\r\n          <input\r\n            type=\"number\"\r\n            name=\"xPompier\"\r\n            onChange={e => onXChange(e)}\r\n            value={position[1]}\r\n          />\r\n          <label htmlFor=\"numPompier\">Position y</label>\r\n          <input\r\n            type=\"number\"\r\n            name=\"yPompier\"\r\n            onChange={e => onYChange(e)}\r\n            value={position[0]}\r\n          />\r\n        </div>\r\n        <button onClick={() => test()} >test function</button>\r\n      </div>\r\n    )\r\n  }\r\n\r\n\r\n\r\n\r\n  // AUTORISATIONS \r\n  const deplacementAutorise = (deplacement) => {\r\n    // return true\r\n    var dpl = [...deplacement]\r\n    if (dpl[0] == 0 && dpl[1] == 0) return false\r\n    if (position[0] + dpl[0] > carte.length - 1 || position[1] + dpl[1] > carte[0].length - 1 || position[0] + dpl[0] < 0 || position[1] + dpl[1] < 0) return false\r\n\r\n\r\n    const dplInterditsCases = [100, 20, 3, 4]\r\n    \r\n    try {\r\n      const valeurCaseDeplacement = carte[position[0] + dpl[0]][position[1] + dpl[1]]\r\n      if (Math.floor(valeurCaseDeplacement/100)==1) return false\r\n      if (Math.floor(valeurCaseDeplacement/10)==2) return false\r\n      if (dplInterditsCases.includes(valeurCaseDeplacement)) return false\r\n    } catch (error) { }\r\n\r\n    const dplInterditsMurs = [1, 2, 3, 5]\r\n    try {\r\n      if (dpl[0] != 0) { // haut bas\r\n        if (dpl[0] < 0) {\r\n          dpl[0] = 0\r\n        }\r\n        if (typeof (mursH[position[0] + dpl[0]][position[1]]) === 'undefined') return false\r\n        if (dplInterditsMurs.includes(mursH[position[0] + dpl[0]][position[1]])) return false\r\n      } else { // gauche droite\r\n        if (dpl[1] < 0) {\r\n          dpl[1] = 0\r\n        }\r\n        if (typeof (mursV[position[0]][position[1] + dpl[1]]) === 'undefined') return false\r\n        if (dplInterditsMurs.includes(mursV[position[0]][position[1] + dpl[1]])) return false\r\n      }\r\n    } catch (error) { }\r\n\r\n\r\n\r\n\r\n    return true\r\n  }\r\n  const testRelacherHabitant = () => {\r\n    if (carte[position[0]][position[1]]%10==0) return false // pas de transport d'habitant\r\n\r\n    const mursBloquants = [1, 2, 3, 5]\r\n\r\n    if (position[0] == 0 && !mursBloquants.includes(mursH[position[0]][position[1]])) return true // haut\r\n    if (position[0] == nbLignesGrille - 1 && !mursBloquants.includes(mursH[position[0] + 1][position[1]])) return true // bas\r\n\r\n    if (position[1] == 0 && !mursBloquants.includes(mursV[position[0]][position[1]])) return true // gauche\r\n    if (position[1] == nbColonnesGrille - 1 && !mursBloquants.includes(mursV[position[0]][position[1] + 1])) return true // droite\r\n\r\n    return false\r\n  }\r\n  const relacherHabitant = () => {\r\n    if (testRelacherHabitant()) {\r\n      setTimeout(() => {\r\n        updateResultats(true)\r\n        updateCarte(position, 100+numPompier*10)\r\n      }, 1000);\r\n    }\r\n  }\r\n\r\n  const revealHabitant=()=>{\r\n    if(configuration!=null){\r\n      const casesAutour = getCasesAutour()\r\n      console.log(configuration)\r\n      const nouvelHabitant = Math.random() <= configuration.txApparitionHab.valeur\r\n  \r\n      try {\r\n        if(casesAutour.dessus==20) updateCarte([position[0]-1,position[1]], nouvelHabitant ? 20+Math.floor(configuration.nbHabDifferents.valeur*Math.random())+1 : 0)\r\n      } catch (error) {}\r\n      try {\r\n        if(casesAutour.droite==20) updateCarte([position[0],position[1]+1], nouvelHabitant ? 20+Math.floor(configuration.nbHabDifferents.valeur*Math.random())+1 : 0)\r\n      } catch (error) {}\r\n      try {\r\n        if(casesAutour.dessous==20) updateCarte([position[0]+1,position[1]], nouvelHabitant ? 20+Math.floor(configuration.nbHabDifferents.valeur*Math.random())+1 : 0)\r\n      } catch (error) {}\r\n      try {\r\n        if(casesAutour.gauche==20) updateCarte([position[0],position[1]-1], nouvelHabitant ? 20+Math.floor(configuration.nbHabDifferents.valeur*Math.random())+1 : 0)\r\n      } catch (error) {}\r\n      \r\n    }\r\n    \r\n  }\r\n\r\n  const getCasesAutour = () => {\r\n    var cases = {}\r\n\r\n    try {\r\n      cases[\"dessus\"]=(carte[position[0] - 1][position[1]]) // dessus\r\n    } catch (error) { }\r\n    try {\r\n      cases[\"droite\"]=(carte[position[0]][position[1] + 1]) // droite\r\n    } catch (error) { }\r\n    try {\r\n      cases[\"dessous\"]=(carte[position[0] + 1][position[1]]) // dessous\r\n    } catch (error) { }\r\n    try {\r\n      cases[\"gauche\"]=(carte[position[0]][position[1] - 1]) // gauche\r\n    } catch (error) { }\r\n    return cases\r\n  }\r\n  const getMursAutour = () => {\r\n    var murs = []\r\n\r\n    try {\r\n      if (mursH[position[0]][position[1]] != 4 || (mursH[position[0]][position[1] - 1] < 6 && mursH[position[0]][position[1] + 1] < 6)) {\r\n        murs.push(mursH[position[0]][position[1]]) // dessus\r\n      } else {\r\n        murs.push(0)\r\n      }\r\n    } catch (error) { }\r\n\r\n    try {\r\n      if (mursV[position[0]][position[1] + 1] != 4 || (mursV[position[0] - 1][position[1] + 1] < 6 && mursV[position[0] + 1][position[1] + 1] < 6)) {\r\n        murs.push(mursV[position[0]][position[1] + 1])  // droite\r\n      } else {\r\n        murs.push(0)\r\n      }\r\n    } catch (error) { }\r\n\r\n    try {\r\n      if (mursH[position[0] + 1][position[1]] != 4 || (mursH[position[0] + 1][position[1] - 1] < 6 && mursH[position[0] + 1][position[1] + 1] < 6)) {\r\n        murs.push(mursH[position[0] + 1][position[1]]) // dessous\r\n      } else {\r\n        murs.push(0)\r\n      }\r\n\r\n    } catch (error) { }\r\n    try {\r\n      if (mursV[position[0]][position[1]] != 4 || (mursV[position[0] - 1][position[1]] < 6 && mursV[position[0] + 1][position[1]] < 6)) {\r\n        murs.push(mursV[position[0]][position[1]])  // gauche\r\n      } else {\r\n        murs.push(0)\r\n      }\r\n    } catch (error) { }\r\n    // console.log(murs)\r\n    return murs\r\n  }\r\n\r\n\r\n\r\n\r\n  const [btnClickedBottom, setBtnClickedBottom] = useState(null)\r\n  const [propositionsCase, setPropositionsCase] = useState([]) // Extincteurs\r\n  const [propositionMursDetruire, setPropositionMursDetruire] = useState([[], []]) // Horizontaux  , Verticaux\r\n  useEffect(() => {\r\n    if (btnClickedBottom != 3 || btnClickedBottom == null) {\r\n      setPropositionMursDetruire([[], []])\r\n    }\r\n    if ((btnClickedBottom > 2 && btnClickedBottom < 6) || btnClickedBottom == null) {\r\n      setPropositionsCase([])\r\n    }\r\n  }, [btnClickedBottom])\r\n\r\n\r\n\r\n\r\n  // HANDLERS CLIC GRILLE\r\n\r\n  const handleClicCase = (valeurAvant, valeurApres, coordX, coordY) => {\r\n\r\n    console.log(valeurAvant, valeurApres, coordX, coordY)\r\n    try {\r\n      updateCarte([coordY, coordX], valeurApres)\r\n      setPropositionsCase([])\r\n      setBtnClickedBottom(null)\r\n\r\n      if (valeurAvant == 4 && valeurApres == 0) { // Extincteur flamme\r\n        doAction(\"Feu\")\r\n      }\r\n      if (valeurAvant == 4 && valeurApres == 3) { // Feu Fumée\r\n        doAction(\"FeuFum\")\r\n      }\r\n      if (valeurAvant == 3 && valeurApres == 0) { // Fumée\r\n        doAction(\"Fum\")\r\n      }\r\n      if (Math.floor(valeurAvant/10)==2 && valeurApres == 0) { // Habitant\r\n        doAction(\"Habitant\")\r\n        updateCarte(position, 100+numPompier*10+valeurAvant%10)\r\n      }\r\n    } catch (error) { }\r\n  }\r\n\r\n  const handleClicMur = (num, valeurAvant, coordX, coordY) => { // marqueur dégat\r\n    if (propositionMursDetruire[0].length > 0 || propositionMursDetruire[1].length > 0) {\r\n\r\n      const checkInCoords = (index) => {\r\n        // console.log(\"coordx\",coordX,\"coordy\",coordY,\"position\",position)\r\n\r\n        let numClic = null\r\n\r\n        if (coordX == position[1] && (coordY < position[0] || (coordY == position[0] && num == 0))) { // top\r\n          numClic = 0  // case en question\r\n          // console.log(\"top\",numClic)\r\n        }\r\n        if (coordX == position[1] && (coordY > position[0] || (coordY == position[0] && num == 2))) { // bottom\r\n          numClic = 2  // case en question\r\n          // console.log(\"bottom\",numClic)\r\n        }\r\n        if (coordY == position[0] && (coordX < position[1] || (coordX == position[1] && num == 3))) { // left\r\n          numClic = 3  // case en question\r\n          // console.log(\"left\",numClic)\r\n        }\r\n        if (coordY == position[0] && (coordX > position[1] || (coordX == position[1] && num == 1))) { // right\r\n          numClic = 1  // case en question\r\n          // console.log(\"right\",numClic)\r\n        }\r\n\r\n        return numClic\r\n      }\r\n\r\n      var cote = checkInCoords(num % 2)\r\n      let valeurApres = 4\r\n      if (valeurAvant == 1) valeurApres = 3\r\n\r\n      if (cote != null) {\r\n        try {\r\n          switch (cote) {\r\n            case 0:\r\n              updateMurH([position[0], position[1]], valeurApres)\r\n              // if(valeurAvant==5 ||)\r\n              break;\r\n            case 1:\r\n              updateMurV([position[0], position[1] + 1], valeurApres)\r\n              break;\r\n            case 2:\r\n              updateMurH([position[0] + 1, position[1]], valeurApres)\r\n              break;\r\n            case 3:\r\n              updateMurV([position[0], position[1]], valeurApres)\r\n              break;\r\n          }\r\n\r\n          doAction(\"Marqueur\")\r\n\r\n\r\n        } catch (error) {\r\n        }\r\n\r\n\r\n\r\n        setPropositionMursDetruire([[], []])\r\n        setBtnClickedBottom(null)\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  // HANDLER CLICS BOUTONS\r\n\r\n\r\n  const handleClicFleche = (num) => {\r\n    // Position y x\r\n    let deplacement\r\n    switch (num) {\r\n      case 0: // haut\r\n        console.log(\"haut\")\r\n        deplacement = [-1, 0]\r\n        break;\r\n\r\n      case 1: // droite\r\n        console.log(\"droite\")\r\n        deplacement = [0, 1]\r\n        break;\r\n\r\n      case 2: // bas\r\n        console.log(\"bas\")\r\n        deplacement = [1, 0]\r\n        break;\r\n\r\n      case 3: // gauche\r\n        console.log(\"gauche\")\r\n        deplacement = [0, -1]\r\n\r\n        break;\r\n    }\r\n    if (deplacementAutorise(deplacement)) {\r\n      updateCarte([position[0] + deplacement[0], position[1] + deplacement[1]], carte[position[0]][position[1]])\r\n      setPosition(position => [position[0] + deplacement[0], position[1] + deplacement[1]])\r\n      doAction(\"Deplacement\")\r\n      updateCarte(position, 0)\r\n    }\r\n  }\r\n\r\n\r\n  const handleClicDoor = (ouvrir) => { // position, ouvert/fermé\r\n    setBtnClickedBottom(ouvrir ? 4 : 5)\r\n    let valueAvant\r\n    let valueApres\r\n\r\n    if (ouvrir) {\r\n      valueAvant = 5\r\n      valueApres = 6\r\n\r\n    } else {\r\n      valueAvant = 6\r\n      valueApres = 5\r\n    }\r\n    doAction(\"Porte\")\r\n    try {\r\n      if (mursH[position[0]][position[1]] == valueAvant) updateMurH([position[0], position[1]], valueApres)\r\n      if (mursH[position[0] + 1][position[1]] == valueAvant) updateMurH([position[0] + 1, position[1]], valueApres)\r\n      if (mursV[position[0]][position[1]] == valueAvant) updateMurV([position[0], position[1]], valueApres)\r\n      if (mursV[position[0]][position[1] + 1] == valueAvant) updateMurV([position[0], position[1] + 1], valueApres)\r\n    } catch (error) {\r\n\r\n    }\r\n  }\r\n\r\n  const handleClicExtincteur = (num) => {\r\n    // 0 FEU, 1 FEUFUM, 2 FUM\r\n    if (btnClickedBottom != num) {\r\n      var listeCasesAction = []\r\n      let valeurAvant = 4\r\n      let valeurApres = 0\r\n      setBtnClickedBottom(num)\r\n      switch (num) {\r\n        case 0: // ETEINDRE FEU\r\n          break;\r\n\r\n        case 1: // FEU FUM\r\n          valeurApres = 3\r\n          break;\r\n        case 2: // ETEINDRE FUMEE\r\n          valeurAvant = 3\r\n          break;\r\n      }\r\n\r\n      try {\r\n        if (carte[position[0] - 1][position[1]] == valeurAvant) listeCasesAction.push([position[0] - 1, position[1], valeurAvant, valeurApres]) // TOP\r\n      } catch (error) { }\r\n      try {\r\n        if (carte[position[0]][position[1] + 1] == valeurAvant) listeCasesAction.push([position[0], position[1] + 1, valeurAvant, valeurApres]) // RIGHT\r\n      } catch (error) { }\r\n      try {\r\n        if (carte[position[0] + 1][position[1]] == valeurAvant) listeCasesAction.push([position[0] + 1, position[1], valeurAvant, valeurApres]) // BOTTOM\r\n      } catch (error) { }\r\n      try {\r\n        if (carte[position[0]][position[1] - 1] == valeurAvant) listeCasesAction.push([position[0], position[1] - 1, valeurAvant, valeurApres]) // LEFT\r\n      } catch (error) { }\r\n\r\n      setPropositionsCase(listeCasesAction)\r\n    } else {\r\n      setBtnClickedBottom(null)\r\n    }\r\n\r\n  }\r\n\r\n  const handleClicMarqueur = () => {\r\n    if (btnClickedBottom != 3) {\r\n      setBtnClickedBottom(3)\r\n      if (propositionMursDetruire[0].length > 0 || propositionMursDetruire[1].length > 0) {\r\n        setPropositionMursDetruire([[], []])\r\n      } else {\r\n        const mursADetruire = [1, 3, 5, 6]\r\n        var propositions = [\r\n          [],\r\n          []\r\n        ]\r\n        const mursAutour = getMursAutour()\r\n\r\n        try {\r\n          if (mursADetruire.includes(mursAutour[0])) propositions[0].push([position[1], position[0]]) // top\r\n          if (mursADetruire.includes(mursAutour[1])) propositions[1].push([position[1] + 1, position[0]]) // right\r\n          if (mursADetruire.includes(mursAutour[2])) propositions[0].push([position[1], position[0] + 1]) // bottom\r\n          if (mursADetruire.includes(mursAutour[3])) propositions[1].push([position[1], position[0]]) // left\r\n\r\n        } catch (error) {\r\n\r\n        }\r\n        setPropositionMursDetruire(propositions)\r\n\r\n      }\r\n    } else {\r\n      setBtnClickedBottom(null)\r\n    }\r\n\r\n\r\n  }\r\n\r\n  const handleClicValidated =async (bool) => {\r\n    if(bool){\r\n      const response =  await PlayAPI.nouveauTour(numPompier,carte,mursH,mursV,currentCycle,currentTour+1,resultats.Decedes,resultats.Sauves,session,equipe)      \r\n    }\r\n  }\r\n\r\n  const handleNoClicked = () => {\r\n    setPropositionMursDetruire([[], []])\r\n    setPropositionsCase([])\r\n  }\r\n\r\n  const handleClicHabitant = () => {\r\n    if (btnClickedBottom != 6) {\r\n      setBtnClickedBottom(6)\r\n      const valeurApres = 0\r\n      var listeCasesAction = []\r\n      try {\r\n        const valeurDessus =  carte[position[0] - 1][position[1]]\r\n        if (Math.floor(valeurDessus/10)==2) listeCasesAction.push([position[0] - 1, position[1], valeurDessus, valeurApres]) // TOP\r\n      } catch (error) { }\r\n      try {\r\n        const valeurDroite =  carte[position[0]][position[1] + 1]\r\n        if (Math.floor(valeurDroite/10)==2) listeCasesAction.push([position[0], position[1] + 1, valeurDroite, valeurApres]) // RIGHT\r\n      } catch (error) { }\r\n      try {\r\n        const valeurDessous =  carte[position[0] + 1][position[1]] \r\n        if (Math.floor(valeurDessous/10)==2)  listeCasesAction.push([position[0] + 1, position[1], valeurDessous, valeurApres]) // BOTTOM\r\n      } catch (error) { }\r\n      try {\r\n        const valeurGauche = carte[position[0]][position[1] - 1]\r\n        if (Math.floor(valeurGauche/10)==2) listeCasesAction.push([position[0], position[1] - 1, valeurGauche, valeurApres]) // LEFT\r\n      } catch (error) { }\r\n\r\n      setPropositionsCase(listeCasesAction)\r\n\r\n\r\n      console.log(\"handle clic habitant\")\r\n    } else {\r\n      setBtnClickedBottom(null)\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  return (\r\n    \r\n      carte.length>0 && position!=null ?\r\n      \r\n        <div>\r\n            <Grille\r\n            nbColonnesGrille={nbColonnesGrille}\r\n            nbLignesGrille={nbLignesGrille}\r\n            carte={carte}\r\n            position={position}\r\n            mursH={mursH}\r\n            mursV={mursV}\r\n            propositionMursDetruire={propositionMursDetruire}\r\n            propositionsCase={propositionsCase}\r\n            handleClicMur={handleClicMur}\r\n            handleClicCase={handleClicCase}\r\n            \r\n\r\n          />\r\n\r\n          <BandeauTop\r\n            stocks={stocks}\r\n            resultats={resultats}\r\n            numeroPompier={numPompier}\r\n            cycle={currentCycle}\r\n            tour={currentTour}\r\n            configuration={configuration}\r\n            budget={budget}\r\n            chrono={chrono}\r\n          />\r\n\r\n          <BandeauBottom\r\n            interventions={interventions}\r\n            stocks={stocks}\r\n            numeroPompier={numPompier}\r\n            tour={currentTour}\r\n            handleClicFleche={handleClicFleche}\r\n            handleClicValidated={handleClicValidated}\r\n            handleClicDoor={handleClicDoor}\r\n            handleClicMarqueur={handleClicMarqueur}\r\n            handleClicExt={handleClicExtincteur}\r\n            handleNoClicked={handleNoClicked}\r\n            handleClicHabitant={handleClicHabitant}\r\n            btnClickedBottom={btnClickedBottom}\r\n            mursAutour={getMursAutour()}\r\n            casesAutour={getCasesAutour()}\r\n            currentCase={carte[position[0]][position[1]]}\r\n          />\r\n        </div>\r\n      : null\r\n      \r\n      \r\n     \r\n    \r\n  );\r\n\r\n}\r\n\r\nexport default InterfaceInter;\r\n\r\n"]},"metadata":{},"sourceType":"module"}