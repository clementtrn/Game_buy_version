(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{110:function(e,t,n){},127:function(e,t,n){},152:function(e,t,n){},160:function(e,t,n){},162:function(e,t,n){},199:function(e,t,n){},201:function(e,t,n){},202:function(e,t,n){},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(15),s=n.n(c),u=(n(152),n(4)),i=n(34),o=n(17),l=n(38),p=n(133),b=n.p+"static/media/Agency FB.a28a90a7.ttf",d=("\n    local('Agency FB'),\n    local('Agency FB-Regular'),\n    url(".concat(b,") format('ttf')\n  "),Object(p.a)({palette:{primary:{main:"#F02000"}},typography:{fontFamily:" Agency FB, Arial",fontSize:20}}));d.typography.h1=Object(l.a)({fontSize:"3em",fontFamily:"Agency FB, Arial","@media (min-width:600px)":{fontSize:"3rem"}},d.breakpoints.up("md"),{fontSize:"4rem"}),d.typography.h2=Object(l.a)({fontSize:"1.2rem","@media (min-width:600px)":{fontSize:"1.5rem"}},d.breakpoints.up("md"),{fontSize:"2.4rem"}),d.typography.h5=Object(l.a)({fontSize:"1.4em",fontWeight:"bold",fontFamily:"Agency FB,sans-serif","@media (min-width:600px)":{fontSize:"1rem"}},d.breakpoints.up("md"),{fontSize:"1.4rem"}),d.typography.h6=Object(l.a)({fontSize:"0.9em",fontWeight:"normal",lineHeight:"1em",fontFamily:"Arial,sans-serif","@media (min-width:600px)":{fontSize:"0.7rem"}},d.breakpoints.up("md"),{fontSize:"0.9rem"}),d.typography.subtitle1=Object(l.a)({fontSize:"1.3em",fontFamily:"Arial,sans-serif","@media (min-width:600px)":{fontSize:"1rem"}},d.breakpoints.up("md"),{fontSize:"1.5rem"}),d.typography.subtitle2=Object(l.a)({fontSize:"1em",lineHeight:"1em",fontFamily:"Arial,sans-serif","@media (min-width:600px)":{fontSize:"0.5rem"}},d.breakpoints.up("md"),{fontSize:"1rem"}),d.typography.caption=Object(l.a)({fontSize:"3em",fontFamily:"Agency FB, Arial","@media (min-width:600px)":{fontSize:"3rem"}},d.breakpoints.up("md"),{fontSize:"4rem"});var f=d,h=n(267),j=n(14),m=n(16),v=n(5),O=n.n(v),g=n(9),x=(n(60),"https://www.back.leaders-extreme.fr"),y={disconnectUsers:function(){var e=Object(g.a)(O.a.mark((function e(t,n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("disconnect users"),r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:n,start:!1})},fetch(x+"/startStopPartie",r).then((function(){t.emit("disconnectUsers",{start:!1})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),startStopPartie:function(){var e=Object(g.a)(O.a.mark((function e(t,n,r){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("start/stop partie"),a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:n,start:r})},fetch(x+"/startStopPartie",a).then((function(){t.emit("startStopPartie",{start:r})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),nouveauTour:function(){var e=Object(g.a)(O.a.mark((function e(t,n,r,a,c,s,u,i,o,l,p,b,d){var f;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({carte:r,mursH:a,mursV:c,currentPomp:n,currentSequence:s,currentCycle:u,currentTour:i,resultatsDecedes:o,resultatsSauves:l,session:p,equipe:b,currrentChrono:d})},fetch(x+"/nouveauTour",f).then((function(){t.emit("changementTour",JSON.stringify({currentSequence:s,currentPomp:n,currentTour:i,currentCycle:u,equipe:b,session:p}))}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,r,a,c,s,u,i,o,l,p,b,d){return e.apply(this,arguments)}}(),getConfiguration:function(){var e=Object(g.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:t})},e.next=3,fetch(x+"/configuration",n);case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getPlayState:function(){var e=Object(g.a)(O.a.mark((function e(t,n){var r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:t,equipe:n})},e.next=3,fetch(x+"/playstate",r);case 3:return a=e.sent,e.next=6,a.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),revealHabitant:function(){var e=Object(g.a)(O.a.mark((function e(t,n,r){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.emit("revealHabitant",{y:parseInt(n[0]),x:parseInt(n[1]),type:parseInt(r)}),console.log("socket emit");case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),saveBudgetsPompInit:function(){var e=Object(g.a)(O.a.mark((function e(t,n,r){var a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cycles:t,session:n,equipe:r})},e.next=3,fetch(x+"/saveBudgetsPompInit",a);case 3:return c=e.sent,e.next=6,c.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),saveBudgetsPompFin:function(){var e=Object(g.a)(O.a.mark((function e(t,n,r){var a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({budgetsFin:t,session:n,equipe:r})},e.next=3,fetch(x+"/saveBudgetsPompFin",a);case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),getBudgetsPompInit:function(){var e=Object(g.a)(O.a.mark((function e(t,n,r,a,c){var s,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:t,equipe:n,numPompier:r,cycle:a,sequence:c})},e.next=3,fetch(x+"/getBudgetsPompInit",s);case 3:return u=e.sent,e.next=6,u.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r,a,c){return e.apply(this,arguments)}}(),getBudgetsPompFin:function(){var e=Object(g.a)(O.a.mark((function e(t,n){var r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:t,equipe:n})},e.next=3,fetch(x+"/getBudgetsPompFin",r);case 3:return a=e.sent,e.next=6,a.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),updateCurrentChrono:function(){var e=Object(g.a)(O.a.mark((function e(t,n,r){var a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chrono:t,session:n,equipe:r})},e.next=3,fetch(x+"/updateChrono",a);case 3:return c=e.sent,e.next=6,c.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),updateConfig:function(){var e=Object(g.a)(O.a.mark((function e(t,n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({manualConfig:t,session:n})},e.abrupt("return",fetch(x+"/updateConfig",r));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),resetPartie:function(){var e=Object(g.a)(O.a.mark((function e(t,n,r,a){var c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nbEquipes:t,session:n,etats:r,chronoInit:a})},e.abrupt("return",fetch(x+"/resetPartie",c));case 2:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),getGeneralStats:function(){var e=Object(g.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:t})},e.next=3,fetch(x+"/getGeneralStats",n);case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S=(n(110),n(1)),C=function(e){var t=e.name,n=e.value,r=e.primary,a=e.flexFactor,c=e.textes,s=e.data,u=function(e){try{return null==c?e:c["label"+e.charAt(0).toUpperCase()+e.slice(1)].contenu}catch(t){console.log(e)}};return Object(S.jsx)("div",{className:"case-panel",style:{flexDirection:r?"column":"row",flex:a},children:"budgetRestant"==t&&s?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("label",{className:"label-title",style:{fontSize:r?null:15,color:"red"},children:u("budgetMaxAtteint")}),Object(S.jsx)("span",{className:"case-value",children:n})]}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("label",{className:"label-title",style:{fontSize:r?null:15},children:u(t)}),"cycle"==t||"sequence"==t||"tour"==t?Object(S.jsxs)("span",{className:"case-value",children:[n+" ",Object(S.jsx)("span",{style:{color:"red"},children:" / "+s})]}):Object(S.jsxs)("span",{className:"case-value",children:[" ",n]})]})})},q=n(87),N=n.n(q),k={getTexts:function(){var e=Object(g.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nomView:t})},e.next=3,fetch("https://www.back.leaders-extreme.fr/contents",n);case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w=function(e){var t=e.numeroPompier,n=e.sequence,a=e.numEquipe,c=e.numSession,s=e.cycle,i=e.tour,o=e.pomp,l=e.stocks,p=e.resultats,b=e.configuration,d=e.budget,f=e.equipe,h=e.handleClicValidated,j=e.play,m=e.chronoInit,v=e.budgetDepense,x=Object(r.useState)(null),q=Object(u.a)(x,2),w=q[0],F=q[1],E=Object(r.useState)(null),P=Object(u.a)(E,2),I=P[0],T=P[1];Object(r.useEffect)((function(){if(o==t&&null!==I&&j&&I>=0)if(I>0)var e=setInterval((function(){I%30==0&&I>10&&y.updateCurrentChrono(I,c,a),T((function(e){return e-1}))}),1e3);else 0==I&&(h(!0),T(-1));else null!==b&&T(null==m||-1==I?-1:m);return function(){clearInterval(e)}}),[I]),Object(r.useEffect)((function(){null!==m&&(I>=m||-1==I)&&null!==b&&T(m)})),Object(r.useEffect)((function(){null==w&&function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.getTexts("jeuTactBandeauTop").then((function(e){F(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[w]);var M=function(e){if(null==w)return e;try{return w["label"+e.charAt(0).toUpperCase()+e.slice(1)].contenu}catch(t){return console.log("label"+e.charAt(0).toUpperCase()+e.slice(1)),e}};return null!=b?Object(S.jsx)("div",{className:"bandeau-top",children:Object(S.jsxs)("div",{className:"cases-container",children:[Object(S.jsx)(C,{name:"sequence",value:n,primary:!0,flexFactor:1,textes:w,data:b.nbSequences.valeur}),Object(S.jsx)(C,{name:"cycle",value:s,primary:!0,flexFactor:1,textes:w,data:b.nbCyclesParSequence.valeur}),Object(S.jsx)(C,{name:"tour",value:i,primary:!0,flexFactor:1,textes:w,data:b.nbToursParCycle.valeur}),Object(S.jsx)(C,{name:"budgetRestant",value:d+" \u20ac",primary:!0,flexFactor:1,textes:w,data:v>=b.budgetTourMax.valeur}),Object(S.jsxs)("div",{className:"case-panel donnees-container",style:{flex:3},children:[Object(S.jsx)("label",{className:"label-title",children:M("stockEquipements")}),Object(S.jsxs)("div",{className:"sous-donnees-container",children:[Object(S.jsx)(C,{name:"nbExtFeu",value:l.Feu,primary:!1,flexFactor:1,textes:w},0),Object(S.jsx)(C,{name:"nbExtFum",value:l.Fum,primary:!1,flexFactor:1,textes:w},1)]}),Object(S.jsxs)("div",{className:"sous-donnees-container",children:[Object(S.jsx)(C,{name:"nbExtFeuFum",value:l.FeuFum,primary:!1,flexFactor:2,textes:w},2),Object(S.jsx)(C,{name:"nbMarqueurs",value:l.Marqueur,primary:!1,flexFactor:2,textes:w},3)]})]}),Object(S.jsxs)("div",{className:"case-panel donnees-container",style:{flex:2},children:[Object(S.jsx)("label",{className:"label-title",children:M("resultats")+" "+f}),Object(S.jsx)(C,{name:M("nbDecedes"),value:p.Decedes,primary:!1,flexFactor:0},4),Object(S.jsx)(C,{name:M("nbSauves"),value:p.Sauves,primary:!1,flexFactor:0},5)]}),function(){var e=b.nbPompEquipe.valeur,t=360/e;return Object(S.jsxs)("div",{className:"case-panel",style:{flex:1},children:[Object(S.jsx)("label",{className:"label-title",children:M("tourParTour")}),Object(S.jsx)("ul",{children:function(){var n=[];n.push(Object(S.jsx)("li",{style:{transform:"translate(24px,-24px)",backgroundColor:0==o?"#BF0000":null},children:"S"},"s"));for(var r=0;r<e;r++){var a=t*r-90,c=-1*a;n.push(Object(S.jsx)("li",{style:{transform:"rotate("+a+"deg) translate(20px) rotate("+c+"deg) translate("+"-10px) translateY(10px)",backgroundColor:r+1==o?"#BF0000":null},children:r+1},r))}return n}()})]})}(),Object(S.jsxs)("div",{className:"case-panel",style:{flex:1},children:[Object(S.jsx)("label",{className:"label-title",children:M("numPompier")}),Object(S.jsxs)("div",{className:"donnees-container",children:[Object(S.jsx)("label",{className:"label-title label-num-pompier",children:t}),Object(S.jsx)(N.a,{className:"icone-num-pompier",fontSize:"large",stroke:"white",strokeWidth:1})]})]}),Object(S.jsxs)("div",{className:"case-panel",style:{flex:1},children:[Object(S.jsx)("label",{className:"label-title",children:M("play")}),Object(S.jsxs)("div",{className:"donnees-container",children:[Object(S.jsxs)("div",{className:"feu",children:[Object(S.jsx)("div",{className:I<30&&I>0?"clignotant animation-reverted":"",style:{backgroundColor:t!=o?"#ff0000":I>=0&&I<30?"#E26F00":"#9F9F9F"}}),Object(S.jsx)("div",{className:I<30&&I>0?"clignotant":"",style:{backgroundColor:t==o?I>=0&&I<30?"#E26F00":"#4dff4d":"#9F9F9F"}})]}),Object(S.jsxs)("span",{className:"case-value",style:{marginTop:"10%",width:"100%",maxWidth:"100%"},children:[Math.floor((I>=0?I:b.chronoTourTact.valeur)/60).toString().padStart(2,"0")+" : ",Object(S.jsxs)("span",{style:{color:I<=30&&I>0?"red":"inherit",marginLeft:5},children:[" "," "+((I>=0?I:b.chronoTourTact.valeur)%60).toString().padStart(2,"0")," "]})]})]})]})]})}):null},F=(n(97),n(254)),E=n(253),P=n(272),I=n(252),T=n(250),M=n(251),J=n(248);function D(e){var t=e.open,n=e.handleClose,r=e.texte,c=e.sourceImage,s=e.action,u=e.coutInter,i=e.coutEq,o=a.a.forwardRef((function(e,t){return Object(S.jsx)("div",{style:{position:"absolute"},children:Object(S.jsx)(J.a,Object(j.a)({direction:"up",ref:t},e))})}));return Object(S.jsxs)(P.a,{open:null!=t&&t,TransitionComponent:o,keepMounted:!0,onClose:function(){return n()},style:{display:t?null:"none"},children:[Object(S.jsxs)(T.a,{children:[Object(S.jsx)("img",{src:c}),Object(S.jsxs)(M.a,{children:[Object(S.jsx)("label",{className:"title-action",style:{marginBottom:5},children:s}),Object(S.jsx)("span",{style:{textAlign:"justify"},children:r}),Object(S.jsx)("span",{style:{fontWeight:"bold",fontStyle:"italic",marginTop:5},children:null!==u?"Co\xfbt Intervention : "+u+" \u20ac":null}),Object(S.jsxs)("span",{style:{fontWeight:"bold",fontStyle:"italic"},children:[" ",null!==u?"Co\xfbt Equipement : "+i+" \u20ac":null]})]})]}),Object(S.jsx)(I.a,{disableSpacing:!0,children:Object(S.jsx)(E.a,{onClick:function(){return n()},color:"primary",children:"Fermer"})})]})}var z=function(e){var t,n=e.action,a=e.nbIntervention,c=e.nbStock,s=e.sourceImage,i=e.handleClicAction,o=e.selected,l=e.num,p=e.disabled,b=e.texteBulle,d=e.coutInter,f=e.coutEq,h=Object(r.useState)(null),j=Object(u.a)(h,2),m=j[0],v=j[1],O=function(e){t=setTimeout((function(){v(!0)}),e)};return Object(S.jsxs)("div",{onMouseEnter:function(){O(null===m?4e3:5e3)},onMouseLeave:function(){clearTimeout(t)},children:[Object(S.jsxs)(F.a,{disabled:p||a<=0||c<=0,selected:o&&![4,5].includes(l),className:"bouton-action",variant:"contained",value:l,onClick:function(){clearTimeout(t),i(l)},children:[Object(S.jsx)("label",{className:"title-action",children:n+"\n"}),Object(S.jsx)("img",{src:s,alt:"image"}),a>1?Object(S.jsx)("label",{className:"count-action",children:a+" interventions"}):Object(S.jsx)("label",{className:"count-action",children:a+" intervention"})]}),Object(S.jsx)(D,{open:m,handleClose:function(){v(!1),clearTimeout(t)},texte:b,sourceImage:s,action:n,coutInter:d,coutEq:f})]})},A=n(68),L=n.n(A),B=n(255),H=function(e){var t=e.interventions,n=e.stocks,a=e.numeroPompier,c=e.handleClicFleche,s=e.handleClicValidated,i=e.handleClicDoor,o=e.handleClicMarqueur,l=e.handleClicExt,p=e.handleNoClicked,b=e.handleClicHabitant,d=e.btnClickedBottom,f=e.mursAutour,h=e.casesAutour,j=e.currentCase,m=e.histActions,v=e.configuration,x=e.pomp,y=e.deplacementEnCours,C=e.budgetMaxAtteint,q=e.isLoading,N=Object(r.useState)(null),w=Object(u.a)(N,2),F=w[0],P=w[1],I=[1,2,3,5];Object(r.useEffect)((function(){null==F&&function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.getTexts("jeuTactBandeauBottom").then((function(e){P(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[F]);var T=function(e){null==e?p():(4!=e&&5!=e||i(4==e),3==e&&o(),e<3&&l(e),6==e&&b())},M=Object(r.useState)(!1),J=Object(u.a)(M,2),A=J[0],H=J[1],V=Object(r.useState)(null),R=Object(u.a)(V,2),G=R[0],U=R[1],W=Object(r.useState)(null),Y=Object(u.a)(W,2),X=Y[0],_=Y[1];return Object(S.jsxs)("div",{className:"bandeau-bottom-tact",children:[function(){var e,n=function(t){e=setTimeout((function(){H(!0)}),t)},r=t.Deplacement<=0||C||q||a!=x,s="#4A4848",u="#BFBFBF";if(null!==v)return Object(S.jsxs)("div",{className:"fleches-container",onMouseEnter:function(){n(null===A?1500:3e3)},onMouseLeave:function(){clearTimeout(e)},children:[Object(S.jsx)(B.a,{className:"fleche-up fleche",onClick:function(){c(0),clearTimeout(e)},disabled:r||I.includes(f[0])||h.dessus>0||void 0===h.dessus||y.type>0,children:Object(S.jsx)(L.a,{style:{color:r||I.includes(f[0])||h.dessus>0||void 0===h.dessus?u:s},stroke:"white",strokeWidth:1})},0),Object(S.jsx)(B.a,{className:"fleche-droite fleche",onClick:function(){c(1),clearTimeout(e)},disabled:r||I.includes(f[1])||h.droite>0||void 0===h.droite||y.type>0,children:Object(S.jsx)(L.a,{style:{color:r||I.includes(f[1])||h.droite>0||void 0===h.droite?u:s},stroke:"white",strokeWidth:1})},1),Object(S.jsx)("div",{className:"fleche-center fleche",children:Object(S.jsx)("div",{className:"circle-fleche"})}),Object(S.jsx)(B.a,{className:"fleche-bottom fleche",onClick:function(){c(2),clearTimeout(e)},disabled:r||I.includes(f[2])||h.dessous>0||void 0===h.dessous||y.type>0,children:Object(S.jsx)(L.a,{style:{color:r||I.includes(f[2])||h.dessous>0||void 0===h.dessous?u:s},stroke:"white",strokeWidth:1})},2),Object(S.jsx)(B.a,{className:"fleche-gauche fleche",onClick:function(){c(3),clearTimeout(e)},disabled:r||I.includes(f[3])||h.gauche>0||void 0===h.gauche||y.type>0,children:Object(S.jsx)(L.a,{style:{color:r||I.includes(f[3])||h.gauche>0||void 0===h.gauche?u:s},stroke:"white",strokeWidth:1})},3),Object(S.jsx)(D,{open:A,handleClose:function(){H(!1),clearTimeout(e)},texte:null!==F?F.bulleFleches.contenu:"",sourceImage:"assets/fleches.png",action:"Se d\xe9placer",coutInter:void 0!==v.coutInterDeplacement?v.coutInterDeplacement.valeur:0,coutEq:void 0!==v.coutEqDeplacement?v.coutInterDeplacement.valeur:0})]})}(),function(){var e=[],r=["dessus","droite","dessous","gauche"];return null!=F&&null!==v&&Object.keys(F).forEach((function(c,s){if(c.includes("label")){var u=!0;s<2&&f.some((function(e,t){return null!==h[r[t]]&&void 0!==h[r[t]]&&4==h[r[t]]&&!I.includes(e)}))&&(u=!1),2==s&&f.some((function(e,t){return null!==h[r[t]]&&void 0!==h[r[t]]&&3==h[r[t]]&&!I.includes(e)}))&&(u=!1),6==s&&f.some((function(e,t){return null!==h[r[t]]&&void 0!==h[r[t]]&&2==Math.floor(h[r[t]]/10)&&!I.includes(e)}))&&1==Math.floor(j/1e3)&&j%100-j%10==0&&(u=!1),3==s&&f.some((function(e){return e>0&&4!=e&&2!=e}))&&(u=!1),4==s&&f.includes(5)&&(u=!1),5==s&&f.includes(6)&&(u=!1),(4!=s&&5!=s||4==s&&f.includes(5)||5==s&&f.includes(6))&&e.push(Object(S.jsx)(z,{action:F[c].contenu,nbIntervention:t[c.replace("labelAction","").replace("Ouvrir","").replace("Fermer","")],nbStock:n[c.replace("labelAction","nb").replace("Ouvrir","").replace("Fermer","")],sourceImage:"assets/"+c.replace("label","")+".png",handleClicAction:T,selected:d==s,num:s,disabled:u||y.type>0||C||q||a!=x,texteBulle:void 0!==F[c.replace("label","bulle").replace("Ouvrir","").replace("Fermer","")]?F[c.replace("label","bulle").replace("Ouvrir","").replace("Fermer","")].contenu:c.replace("label","bulle"),coutInter:void 0!==v[c.replace("labelAction","coutInter").replace("Ouvrir","").replace("Fermer","")]?v[c.replace("labelAction","coutInter").replace("Ouvrir","").replace("Fermer","")].valeur:0,coutEq:void 0!==v[c.replace("labelAction","coutEq").replace("Ouvrir","").replace("Fermer","")]?v[c.replace("labelAction","coutEq").replace("Ouvrir","").replace("Fermer","")].valeur:0},c))}})),Object(S.jsx)("div",{className:"boutons-container",children:e})}(),function(){var e,t,n=function(t){e=setTimeout((function(){U(!0)}),t)},r=function(e){t=setTimeout((function(){_(!0)}),e)};return Object(S.jsxs)("div",{className:"boutons-valider-container",children:[Object(S.jsxs)("div",{onMouseEnter:function(){n(null===G?1500:3e3)},onMouseLeave:function(){clearTimeout(e)},children:[Object(S.jsx)(E.a,{disabled:a!=x||y.type>0||q,className:"bouton-valider vert",variant:"contained",disableElevation:!0,onClick:function(){clearTimeout(e),s(!0)},children:Object(S.jsx)("img",{src:"assets/validate.png",alt:"image"})},0),Object(S.jsx)(D,{open:G,handleClose:function(){U(!1),clearTimeout(e)},texte:null!==F?F.bulleValider.contenu:"",sourceImage:"assets/validate-vert.png",action:"Valider vos actions",coutInter:null,coutEq:null})]}),Object(S.jsxs)("div",{onMouseEnter:function(){r(null===X?1500:3e3)},onMouseLeave:function(){clearTimeout(t)},children:[Object(S.jsx)(E.a,{disabled:m.length<=1||y.type>0||q||a!=x,className:"bouton-valider rouge",variant:"contained",disableElevation:!0,onClick:function(){s(!1),clearTimeout(t)},children:Object(S.jsx)("img",{src:"assets/return.png",alt:"image"})},1),Object(S.jsx)(D,{open:X,handleClose:function(){_(!1),clearTimeout(t)},texte:null!==F?F.bulleRetour.contenu:"",sourceImage:"assets/return-rouge.png",action:"Annuler une action",coutInter:null,coutEq:null})]})]})}()]})},V=(n(160),function(e){var t=e.num,n=e.height,a=e.width,c=e.type,s=e.coordX,i=e.coordY,o=e.nbColonnesPiece,l=e.nbLignesPiece,p=(e.nbColonnesGrille,e.nbLignesGrille,e.anchor),b=e.propositionMursDetruire,d=e.handleClicMur,f=e.mursH,h=e.mursV,j=c>0?c>4?8:4:1,m=Object(r.useState)(!1),v=Object(u.a)(m,2),O=v[0],g=v[1],x=Object(r.useState)([0,0]),y=Object(u.a)(x,2),C=y[0],q=y[1],N=Object(r.useState)(!1),k=Object(u.a)(N,2),w=k[0],F=k[1],E=["","#313131","black","green","green","#490000","#490000"],P=function(e,r){if(0==t||2==t){var c=1,s=1;try{2==f[r][e-1]&&(c=-1)}catch(b){}try{2==f[r+1][e-1]&&(c=-1)}catch(b){}return r-p[0]>l-2&&(s=-1),[c*a*.9,s*j/1.5]}if(1==t||3==t){var u=1,i=1;try{2==h[r-1][e]&&(i=-1)}catch(b){}try{2==h[r-1][e+1]&&(i=-1)}catch(b){}return(e-p[1]>o-2||5==e)&&(u=-1),[u*j/1.5,i*n*.9]}};Object(r.useEffect)((function(){g(!0);var e=P(s,i);C[0]===e[0]&&C[1]===e[1]||q(e)}));Object(r.useEffect)((function(){F(function(e){var n=!1;if(null!==b&&void 0!==b){var r=[1,2,3,5,6];switch(b[e].forEach((function(e){e[0]==s&&e[1]==i&&r.includes(c)&&(n=!0),e[0]==s&&e[1]==i+1&&2==t&&r.includes(c)&&(n=!0),e[0]==s&&e[1]==i-1&&0==t&&r.includes(c)&&(n=!0),e[0]==s+1&&e[1]==i&&1==t&&r.includes(c)&&(n=!0),e[0]==s-1&&e[1]==i&&3==t&&r.includes(c)&&(n=!0)})),t){case 0:try{P(s+1,i)[0]<0&&(5==f[i][s+1]||6==f[i][s+1])&&(n=!1)}catch(a){}try{P(s+1,i+1)[0]<0&&(5==f[i+1][s+1]||6==f[i+1][s+1])&&(n=!1)}catch(a){}try{P(s-1,i)[0]>0&&(5==f[i][s-1]||6==f[i][s-1])&&(n=!1)}catch(a){}try{P(s-1,i-1)[0]>0&&(5==f[i-1][s-1]||6==f[i-1][s-1])&&(n=!1)}catch(a){}break;case 2:try{P(s+1,i)[0]<0&&(5==f[i][s+1]||6==f[i][s+1])&&(n=!1)}catch(a){}try{P(s+1,i+1)[0]<0&&(5==f[i+1][s+1]||6==f[i+1][s+1])&&(n=!1)}catch(a){}try{P(s-1,i)[0]>0&&(5==f[i][s-1]||6==f[i][s-1])&&(n=!1)}catch(a){}try{P(s-1,i+1)[0]>0&&(5==f[i+1][s-1]||6==f[i+1][s-1])&&(n=!1)}catch(a){}break;case 1:try{P(s,i+1)[1]<0&&(5==h[i+1][s]||6==h[i+1][s])&&(n=!1)}catch(a){}try{P(s+1,i+1)[1]<0&&(5==h[i+1][s+1]||6==h[i+1][s+1])&&(n=!1)}catch(a){}try{P(s,i-1)[1]>0&&(5==h[i-1][s]||6==h[i-1][s])&&(n=!1)}catch(a){}try{P(s+1,i-1)[1]>0&&(5==h[i-1][s+1]||6==h[i-1][s+1])&&(n=!1)}catch(a){}break;case 3:try{P(s,i+1)[1]<0&&(5==h[i+1][s]||6==h[i+1][s])&&(n=!1)}catch(a){}try{P(s-1,i+1)[1]<0&&(5==h[i+1][s-1]||6==h[i-1][s-1])&&(n=!1)}catch(a){}try{P(s,i-1)[1]>0&&(5==h[i-1][s]||6==h[i-1][s])&&(n=!1)}catch(a){}try{P(s-1,i-1)[1]>0&&(5==h[i-1][s-1]||6==h[i-1][s-1])&&(n=!1)}catch(a){}}}return n}(t%2))}));var I=function(e,n,r,a,c,s,u){return t%2==0?Object(S.jsx)("div",{className:w?"triangle clignotant":"triangle",style:{borderTop:e+"px solid transparent",borderBottom:n+"px solid transparent",borderLeft:r+"px solid "+(w?"#E26F00":u),top:0==t?s:null,bottom:2==t?s:null,left:0==t?c:null,right:2==t?c:null,transform:"rotate("+(a+90*t)+"deg)"}}):Object(S.jsx)("div",{className:w?"triangle clignotant":"triangle",style:{borderTop:.8*r+"px solid "+(w?"#E26F00":u),borderLeft:n+"px solid transparent",borderRight:e+"px solid transparent",top:1==t?-1:null,bottom:3==t?-1:null,left:3==t?s-1:null,right:1==t?s-1:null,transform:"rotate("+(a+0+90*(t-1))+"deg) ",zIndex:10}})};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("div",{className:w?"clignotant":"",onClick:w?function(){d(t,c,s,i)}:null,style:{position:"absolute",width:t%2==0?a+2:j,height:t%2==1?n+1:j,right:1==t?-1:null,left:t%2==0||3==t?-1:null,top:0==t||t%2==1?-1:null,bottom:2==t?0:null,zIndex:c>2?w?1:3:4,transform:6==c?"translate("+C[0]+"px,"+C[1]+"px)":5==c?t%2==0?"translate(0px,"+C[1]+"px)":"translate("+C[0]+"px,0px)":"",opacity:5==c||6==c?0==t&&i-p[0]>l-2?0:(2!=t||i-p[0]>l-2)&&(1!=t||s-p[1]>o-2||5==s)?3==t&&(s-p[1]>o-2||6==s)?0:1:0:1,transition:c>4&&O?"1s":"",borderRadius:c>4?3:0,border:c>4?"1px solid black":"",boxShadow:c>4?"-1px 1px 1px 1px #9F9F9F":"",backgroundColor:c>0&&3!=c&&4!=c?w?"#E26F00":E[c]:"transparent",cursor:w?"pointer":""},children:[5==c||6==c?function(){var e=[];switch(t){case 0:e.push(Object(S.jsx)("div",{style:{position:"absolute",top:j,height:j/3,backgroundColor:"#9F9F9F",width:j/2,left:C[0]>0?.2*a:null,right:C[0]<0?.2*a:null,border:"1px solid black"}},0)),e.push(Object(S.jsx)("div",{style:{position:"absolute",top:1.3*j,height:j,background:"linear-gradient(20deg, rgba(100,100,100,1) 0%, rgba(194,194,194,1) 68%, rgba(236,236,236,1) 100%)",width:j,left:C[0]>0?.2*a-j/2+j/4:null,right:C[0]<0?.2*a-j/2+j/4:null,borderRadius:"100%",border:"1px solid black",boxShadow:"-1px 1px 1px 1px #9F9F9F"}},1));break;case 2:e.push(Object(S.jsx)("div",{style:{position:"absolute",top:.3*-j-3,height:j/3,backgroundColor:"#9F9F9F",width:j/2,left:C[0]>0?.2*a:null,right:C[0]<0?.2*a:null,border:"1px solid black"}},2)),e.push(Object(S.jsx)("div",{style:{position:"absolute",top:1.3*-j-3,height:j,background:"linear-gradient(20deg, rgba(100,100,100,1) 0%, rgba(194,194,194,1) 68%, rgba(236,236,236,1) 100%)",width:j,left:C[0]>0?.2*a-j/2+j/4:null,right:C[0]<0?.2*a-j/2+j/4:null,borderRadius:"100%",border:"1px solid black",boxShadow:"-1px 1px 1px 1px #9F9F9F"}},3));break;case 1:e.push(Object(S.jsx)("div",{style:{position:"absolute",top:C[1]>0?.2*n:null,bottom:C[1]<0?.2*n:null,height:j/3,backgroundColor:"#9F9F9F",width:j/3,right:j,border:"1px solid black"}},4)),e.push(Object(S.jsx)("div",{style:{position:"absolute",top:C[1]>0?.2*n-j/6-1:null,bottom:C[1]<0?.2*n-j/6-1:null,height:j,background:"linear-gradient(20deg, rgba(100,100,100,1) 0%, rgba(194,194,194,1) 68%, rgba(236,236,236,1) 100%)",width:j,right:1.3*j,borderRadius:"100%",border:"1px solid black",boxShadow:"-1px 1px 1px 1px #9F9F9F"}},5));break;case 3:e.push(Object(S.jsx)("div",{style:{position:"absolute",top:C[1]>0?.2*n:null,bottom:C[1]<0?.2*n:null,height:j/3,backgroundColor:"#9F9F9F",width:j/3,left:j,border:"1px solid black"}},6)),e.push(Object(S.jsx)("div",{style:{position:"absolute",top:C[1]>0?.2*n-j/6-1:null,bottom:C[1]<0?.2*n-j/6-1:null,height:j,background:"linear-gradient(20deg, rgba(100,100,100,1) 0%, rgba(194,194,194,1) 68%, rgba(236,236,236,1) 100%)",width:j,left:1.3*j,borderRadius:"100%",border:"1px solid black",boxShadow:"-1px 1px 1px 1px #9F9F9F"}},7))}return e}():null,3==c||4==c?t%2==0?Object(S.jsxs)("div",{style:{width:"50%",height:2*j-1,top:2==t?0:null,bottom:0==t?0:null,left:0==t?-1:null,right:2==t?-1:null,position:"absolute"},children:[Object(S.jsx)("div",{style:{position:"absolute",right:2==t?0:null,top:0,backgroundColor:t%2==1?"transparent":"black",width:j,height:j}}),Object(S.jsx)("div",{style:{position:"absolute",right:2==t?0:null,left:t%2==1?0:null,bottom:0,backgroundColor:t%2==1?"transparent":"black",width:j,height:j}}),3==c?Object(S.jsxs)(S.Fragment,{children:[I(0,j,.49*a,0,3,t%2==1?-3:-j/2+2,"black"),I(3,3,.48*a,0,3,j/4,"black"),I(4,0,.49*a,0,3,t%2==1?1:j-1,"black")]}):Object(S.jsxs)(S.Fragment,{children:[I(0,j,.22*a,0,3,t%2==1?-3:-j/2+2,"black"),I(3,3,.23*a,0,3,j/4,"black"),I(4,0,.25*a,0,3,t%2==1?1:j-1,"black")]})]}):Object(S.jsxs)("div",{style:{width:2*j-1,height:n/2,top:1==t?-1:null,bottom:3==t?-1:null,left:3==t?1-j:null,right:1==t?-j:null,position:"absolute"},children:[Object(S.jsx)("div",{style:{position:"absolute",right:2==t?0:null,top:1==t?-1:null,bottom:3==t?-1:null,backgroundColor:t%2==1?"transparent":"green",width:j,height:j}}),Object(S.jsx)("div",{style:{position:"absolute",right:2==t?0:null,left:t%2==1?0:null,top:1==t?-1:null,bottom:3==t?-1:null,backgroundColor:t%2==1?"transparent":"red",width:j,height:j}}),3==c?Object(S.jsxs)(S.Fragment,{children:[I(0,j,.7*n,0,3,1,"black"),I(3,3,.7*n,0,j/4,j/4,"black"),I(4,0,.7*n,0,3,j,"black")]}):Object(S.jsxs)(S.Fragment,{children:[I(0,j,.3*n,0,3,1,"black"),I(3,3,.3*n,0,j/4,j/4,"black"),I(4,0,.3*n,0,3,j,"black")]})]}):null]},8),0==c||5==c||6==c?function(){var e=[1,2];switch(t){case 1:try{if(e.includes(f[i+1][s+1])&&e.includes(h[i+1][s+1]))return Object(S.jsx)("div",{style:{position:"absolute",backgroundColor:E[1],width:8,height:8,bottom:-4,right:-5}})}catch(n){}try{if(e.includes(f[i][s+1])&&e.includes(h[i-1][s+1]))return Object(S.jsx)("div",{style:{position:"absolute",backgroundColor:E[1],width:8,height:8,top:-5,right:-5}})}catch(n){}break;case 3:try{if(e.includes(f[i+1][s-1])&&e.includes(h[i+1][s]))return Object(S.jsx)("div",{style:{position:"absolute",backgroundColor:E[1],width:8,height:8,bottom:-4,left:-5}})}catch(n){}try{if(e.includes(f[i][s-1])&&e.includes(h[i-1][s]))return Object(S.jsx)("div",{style:{position:"absolute",backgroundColor:E[1],width:8,height:8,top:-5,left:-5}})}catch(n){}}}():null]})}),R=function(e){var t=e.murs,n=e.type,a=e.coordX,c=e.coordY,s=e.nbColonnesPiece,i=e.nbLignesPiece,o=e.nbColonnesGrille,l=e.nbLignesGrille,p=e.anchor,b=e.propositionMursDetruire,d=e.propositionsCase,f=e.handleClicMur,h=e.handleClicCase,j=e.mursH,m=e.mursV,v=e.position,O=e.idPiece,g=e.deplacementEnCours,x=Object(r.useState)(0),y=Object(u.a)(x,2),C=y[0],q=y[1],N=Object(r.useState)(0),k=Object(u.a)(N,2),w=k[0],F=k[1],E=Object(r.useRef)(),P=Object(r.useState)(!1),I=Object(u.a)(P,2),T=I[0],M=I[1];Object(r.useLayoutEffect)((function(){function e(){q(E.current.clientHeight),F(E.current.clientWidth)}return M(!0),window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]);var J=function(){var e=0,t="",r="",u=-90,o="center",l="center";if(1==Math.floor(n/1e3))if(r="assets/Casque"+(n%1e3-n%100)/100+".png",n%100<10?(e=1,t=v[0]==c&&v[1]==a?"assets/Pompier0"+(null!==g&&void 0!==g?g.type:"0")+".png":"assets/Pompier00.png"):(e=1,t="assets/PompierHabitant"+(n%100-n%10)/10+".png"),null!==g&&void 0!==g&&v[0]==c&&v[1]==a)switch(g.rotation){case 1:switch(u=-90,g.type){case 1:o="flex-start";break;case 2:o="flex-end"}break;case 2:switch(u=0,g.type){case 1:l="flex-end";break;case 2:l="flex-start"}break;case 3:switch(u=90,g.type){case 1:o="flex-end";break;case 2:o="flex-start"}break;case 4:switch(u=180,g.type){case 1:l="flex-start";break;case 2:l="flex-end"}break;default:u=0}else switch(n%10){case 1:u=-90;break;case 2:u=0;break;case 3:u=90;break;case 4:u=180;break;default:u=-90}else v[0]<i+p[0]&&v[1]<s+p[1]&&(2==Math.floor(n/10)?(t="assets/Habitant0.png",null!==v&&v[0]-1==c&&v[1]==a&&n>20&&(t="assets/Habitant"+n%10+".png"),null!==v&&v[0]==c&&v[1]+1==a&&n>20&&(t="assets/Habitant"+n%10+".png"),null!==v&&v[0]+1==c&&v[1]==a&&n>20&&(t="assets/Habitant"+n%10+".png"),null!==v&&v[0]==c&&v[1]-1==a&&n>20&&(t="assets/Habitant"+n%10+".png"),e=1,u=0):3==n?(e=1,t="assets/Fumee.png",u=360*Math.random()):4==n?(e=1,t="assets/Flamme2.png",u=360*Math.random()):(null!==v&&v[0]-1==c&&v[1]==a&&1==g.type&&1==g.rotation&&(o="flex-end"),null!==v&&v[0]==c&&v[1]+1==a&&1==g.type&&2==g.rotation&&(o="flex-start"),null!==v&&v[0]+1==c&&v[1]==a&&1==g.type&&3==g.rotation&&(o="flex-start"),null!==v&&v[0]==c&&v[1]-1==a&&1==g.type&&4==g.rotation&&(o="flex-end"),u=0));return Object(S.jsxs)("div",{style:{position:"absolute",display:"flex",opacity:v[0]==c&&v[1]==a?e:1,width:"100%",height:"100%",alignItems:o,justifyContent:l},children:[Object(S.jsx)("img",{style:{position:"absolute",display:T||v[0]!=c||v[1]!=a?"":"none",maxWidth:1==Math.floor(n/1e3)&&n%100>=10?"85%":"90%",height:1==Math.floor(n/1e3)&&n%100>=10?"80%":"90%",objectFit:"contain",transform:void 0!==u?"rotate("+u+"deg)":"",zIndex:4},src:t}),""!==r?Object(S.jsx)("img",{style:{position:"absolute",display:T||v[0]!=c||v[1]!=a?"":"none",maxWidth:1==Math.floor(n/1e3)&&n%100>=10?"85%":"90%",height:1==Math.floor(n/1e3)&&n%100>=10?"80%":"90%",objectFit:"contain",transform:void 0!==u?"rotate("+u+"deg)":"",zIndex:10},src:r}):null]})},D=Object(r.useState)(!1),z=Object(u.a)(D,2),A=z[0],L=z[1],B=Object(r.useState)(null),H=Object(u.a)(B,2),R=H[0],G=H[1],U=Object(r.useState)(null),W=Object(u.a)(U,2),Y=W[0],X=W[1];return Object(r.useEffect)((function(){L(function(){var e=!1;if(null!==d&&void 0!==d){var t=null,n=null;d.forEach((function(r){r[0]==c&&r[1]==a&&(e=!0,n=r[2],t=r[3])})),e&&null!=t&&(X(n),G(t))}return e}())})),Object(S.jsxs)("div",{ref:E,className:A?"clignotant case-piece":"case-piece",style:{backgroundColor:A?"#E26F00":n>=0?v[0]==c&&v[1]==a?"white":"#EEEEEE":"#D1D1D1",transition:"2s",filter:v[0]==c&&v[1]==a?"brightness(1.2)":""},onClick:A?function(){return h(Y,R,a,c)}:null,children:[function(){for(var e=[],n=0;n<4;n++)e.push(Object(S.jsx)(V,{num:n,height:C,width:w,type:t[n],coordX:a,coordY:c,anchor:p,nbColonnesPiece:s,nbLignesPiece:i,nbColonnesGrille:o,nbLignesGrille:l,propositionMursDetruire:b,handleClicMur:f,mursH:j,mursV:m},n));return Object(S.jsx)(S.Fragment,{children:e})}(),function(){var e=null!==O&&void 0!==O?"assets/Sol_0"+(O%6+1)+".png":null;return Object(S.jsxs)("div",{style:{display:"flex",flex:1,width:"100%",justifyContent:"center",alignItems:"center"},children:[null!==e?Object(S.jsx)("img",{style:{position:"absolute",width:"100%",height:"100%",objectFit:"cover",filter:"brightness(0.90) grayscale(5%) contrast(95%)"},src:e}):null,J()]})}()]})},G=function(e){var t=e.carte,n=e.position,a=e.nbLignesGrille,c=e.nbColonnesGrille,s=e.nbLignesPiece,i=e.nbColonnesPiece,o=e.mursV,l=e.mursH,p=e.anchor,b=e.maxLignesPiece,d=e.maxColonnesPiece,f=e.propositionMursDetruire,h=e.handleClicMur,j=e.handleClicCase,m=e.propositionsCase,v=e.anchors,O=e.deplacementEnCours,g=e.getAnchor,x=[1,2,3,5],y=Object(r.useState)(n[0]>=a&&n[1]>=c),C=Object(u.a)(y,2),q=C[0],N=(C[1],function(e,r){if(!q){if(e<0||r<0)return-1;var a=[l[n[0]][n[1]],o[n[0]][n[1]+1],l[n[0]+1][n[1]],o[n[0]][n[1]]];if(e<t.length&&r<t[0].length){if(e==n[0]+1&&r==n[1]&&!x.includes(a[2]))return t[e][r];if(e==n[0]-1&&r==n[1]&&!x.includes(a[0]))return t[e][r];if(e==n[0]&&r==n[1]-1&&!x.includes(a[3]))return t[e][r];if(e==n[0]&&r==n[1]+1&&!x.includes(a[1]))return t[e][r]}}return-1}),k=function(e,n){var r=!1;return v.forEach((function(a,c){var s=Object(u.a)(a,2),i=s[0],o=s[1];if(e>=i[0]&&e<=o[0]&&n>=i[1]&&n<=o[1])for(var l=i[0];l<=o[0];l++)for(var p=i[1];p<=o[1];p++)t[l][p]>=100&&(r=!0)})),r},w=function(e){for(var r=[],u=0;u<i+2;u++){var b=e+p[0]-1,d=u+p[1]-1;if(b<s+p[0]&&b>=p[0]&&d<i+p[1]&&d>=p[1])r.push(Object(S.jsx)(R,{coordX:d,coordY:b,anchor:p,nbColonnesGrille:c,nbLignesGrille:a,nbColonnesPiece:i,nbLignesPiece:s,murs:[l[b][d],o[b][d+1],l[b+1][d],o[b][d]],type:u>c||e>a||!k(b,d)?-1:t[b][d],propositionMursDetruire:f,propositionsCase:m,handleClicMur:h,handleClicCase:j,mursH:l,mursV:o,position:n,idPiece:g(v,[b,d])[1],deplacementEnCours:O},e+","+u));else{var x=[0,0,0,0];if(b<p[0]){b-1,d;try{x[1]=o[b][d+1]>0?o[b][d+1]:0}catch(C){}try{x[3]=o[b][d]>0?o[b][d]:0}catch(C){}try{x[2]=l[b+1][d]>0?l[b+1][d]:0}catch(C){}}if(b>=s+p[0]){b+1,d;try{x[0]=l[b][d]>0?l[b][d]:0}catch(C){}try{x[1]=o[b][d+1]>0?o[b][d+1]:0}catch(C){}try{x[3]=o[b][d]>0?o[b][d]:0}catch(C){}}if(d<p[1]){b,d-1;try{x[0]=l[b][d]>0?l[b][d]:0}catch(C){}try{x[2]=l[b+1][d]>0?l[b+1][d]:0}catch(C){}try{x[1]=o[b][d+1]>0?o[b][d+1]:0}catch(C){}}if(d>=i+p[1]){b,d+1;try{x[0]=l[b][d]>0?l[b][d]:0}catch(C){}try{x[2]=l[b+1][d]>0?l[b+1][d]:0}catch(C){}try{x[3]=o[b][d]>0?o[b][d]:0}catch(C){}}var y=N(b,d);r.push(Object(S.jsx)(R,{coordX:d,coordY:b,anchor:p,nbColonnesGrille:c,nbLignesGrille:a,nbColonnesPiece:i,nbLignesPiece:s,murs:x,propositionMursDetruire:f,propositionsCase:m,handleClicMur:h,handleClicCase:j,type:y,mursH:l,mursV:o,position:n,idPiece:y>=0?g(v,[b,d])[1]:null,deplacementEnCours:O},e+","+u))}}return r};return Object(S.jsx)("div",{className:"piece",style:{position:"absolute",width:(i+2)/((i!=c?d:c)+2)*80+"%",height:(s+2)/((s!=a?b:a)+2)*100+"%"},children:function(){for(var e=[],t=0;t<s+2;t++)e.push(Object(S.jsx)("div",{className:"row-piece",children:w(t)},"row"+t));return e}()})},U=function(e){var t=e.nbColonnesGrille,n=e.nbLignesGrille,a=e.carte,c=e.position,s=e.mursH,i=e.mursV,o=e.propositionMursDetruire,l=e.propositionsCase,p=e.handleClicMur,b=e.handleClicCase,d=e.handleChangePiece,f=e.deplacementEnCours,h=Object(r.useState)(0),j=Object(u.a)(h,2),m=j[0],v=j[1],O=Object(r.useState)(0),g=Object(u.a)(O,2),x=g[0],y=g[1],C=Object(r.useRef)(null),q=function(){for(var e=[],r=[],a=0;a<i.length;a++)for(var c=0;c<s[a].length;c++)i[a][c]>0&&s[a][c]>0&&e.push([a,c]),i[a][c+1]>0&&s[a+1][c]>0&&r.push([a,c]);return function(e,r){var a=[],c=[],s=0,u=0;return e.forEach((function(e,i){var o=[n,t];r.forEach((function(t){t[0]>=e[0]&&t[1]>=e[1]&&t[0]<=o[0]&&t[1]<=o[1]&&(e[0]<t[0]||e[1]<t[1])&&!c.includes(t)&&(o=t)})),c.push(o),a.push([e,o]),s<o[1]-e[1]&&(s=o[1]-e[1]+1),u<o[0]-e[0]&&(u=o[0]-e[0]+1)})),0==x&&y(s),0==m&&v(u),a}(e,r)},N=function(e,t){var n=[-1,-1],r=-1;return e.forEach((function(e,a){var c=e[0],s=e[1];t[0]>=c[0]&&t[1]>=c[1]&&t[0]<=s[0]&&t[1]<=s[1]&&(n=c,r=a)})),[n,r]};return Object(S.jsx)("div",{className:"piece-container",children:function(){var e,r,h=[],j=[-1,-1],v=0;try{var O=q();if(c[0]<n&&c[1]<t){var g=N(O,c),y=Object(u.a)(g,2);if(j=y[0],v=y[1],j[0]<0&&j[1]<0)e=n,r=t;else{var k=O[v];e=k[1][0]-k[0][0]+1,r=k[1][1]-k[0][1]+1}}else e=n,r=t}catch(w){e=n,r=t}return v!==C.current&&(null!==C.current&&d(),C.current=v),h.push(Object(S.jsx)(G,{mursH:s,mursV:i,carte:a,position:c,nbLignesPiece:e,nbColonnesPiece:r,nbLignesGrille:n,nbColonnesGrille:t,maxLignesPiece:m,maxColonnesPiece:x,propositionMursDetruire:o,propositionsCase:l,handleClicMur:p,handleClicCase:b,anchor:j[0]<0&&j[1]<0?[0,0]:j,anchors:q(),deplacementEnCours:f,getAnchor:N},v)),h}()})},W=n(18),Y=n.n(W),X=(n(162),n(55)),_=n.n(X),K=n(56),Q=n.n(K),Z=function(e){var t=e.configuration,n=e.handleDisconnect,a=Object(r.useState)(!1),c=Object(u.a)(a,2),s=c[0],i=c[1];return null!=t?Object(S.jsxs)("div",{className:"bandeau-droite-tact",onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},children:[Object(S.jsx)("div",{className:"btn-panel-droite",style:{flex:1},children:s?Object(S.jsx)(E.a,{variant:"contained",color:"primary",onClick:function(){i(!1),n()},startIcon:Object(S.jsx)(_.a,{fontSize:"large"}),children:"Se d\xe9connecter"}):Object(S.jsx)("div",{children:Object(S.jsx)(_.a,{fontSize:"small"})})}),Object(S.jsx)("div",{className:"btn-panel-droite",style:{flex:1},children:s?Object(S.jsx)(E.a,{variant:"contained",color:"primary",disabled:!0,startIcon:Object(S.jsx)(Q.a,{fontSize:"large"}),children:"Messagerie"}):Object(S.jsx)("div",{children:Object(S.jsx)(Q.a,{fontSize:"small"})})})]}):null},$=n(206),ee=n(52),te=n.n(ee),ne=function(){var e=Object(o.g)(),t=Y.a.load("user"),n=Object(r.useState)(null),a=Object(u.a)(n,2),c=a[0],s=a[1],i=function(){null!==c&&c.disconnect(),Y.a.save("user","disconnected",{path:"/",maxAge:5400}),e.push("/login")};null!==t&&void 0!==t&&"disconnected"!=t||e.push("/login"),null===t||void 0===t||void 0===t.role||t.role.includes("TACT")||i();var l=Object(r.useState)(!1),p=Object(u.a)(l,2),b=p[0],d=p[1],f=Object(r.useState)(null!==t&&void 0!==t&&void 0!==t.role?t.role.replace("TACT",""):null),h=Object(u.a)(f,2),v=h[0],x=(h[1],Object(r.useState)(null)),C=Object(u.a)(x,2),q=C[0],N=C[1],F=Object(r.useState)(null),E=Object(u.a)(F,2),P=E[0],I=E[1],T=Object(r.useState)(null),M=Object(u.a)(T,2),J=M[0],D=M[1],z=Object(r.useState)(null),A=Object(u.a)(z,2),L=A[0],B=A[1],V=Object(r.useState)(null!=t?t.session:null),R=Object(u.a)(V,2),G=R[0],W=(R[1],Object(r.useState)(null!=t?t.equipe:null)),X=Object(u.a)(W,2),_=X[0],K=(X[1],Object(r.useState)(null)),Q=Object(u.a)(K,2),ee=Q[0],ne=Q[1],re=Object(r.useState)({type:0,rotation:1}),ae=Object(u.a)(re,2),ce=ae[0],se=ae[1],ue=Object(r.useState)([]),ie=Object(u.a)(ue,2),oe=ie[0],le=ie[1],pe=Object(r.useState)(null),be=Object(u.a)(pe,2),de=be[0],fe=be[1];Object(r.useEffect)((function(){null==v&&i()}),[v]);var he=Object(r.useState)(null),je=Object(u.a)(he,2),me=je[0],ve=je[1],Oe=Object(r.useState)(null),ge=Object(u.a)(Oe,2),xe=ge[0],ye=ge[1],Se=Object(r.useState)({Decedes:0,Sauves:0}),Ce=Object(u.a)(Se,2),qe=Ce[0],Ne=Ce[1],ke=Object(r.useState)({Deplacement:0,Feu:0,FeuFum:0,Fum:0,Marqueur:0,Porte:0,Habitant:0}),we=Object(u.a)(ke,2),Fe=we[0],Ee=we[1],Pe=Object(r.useState)(0),Ie=Object(u.a)(Pe,2),Te=Ie[0],Me=Ie[1],Je=Object(r.useState)(0),De=Object(u.a)(Je,2),ze=De[0],Ae=De[1],Le=Object(r.useRef)(!1),Be=Object(r.useState)([]),He=Object(u.a)(Be,2),Ve=He[0],Re=He[1],Ge=Object(r.useState)(0),Ue=Object(u.a)(Ge,2),We=Ue[0],Ye=Ue[1],Xe=Object(r.useState)(0),_e=Object(u.a)(Xe,2),Ke=_e[0],Qe=_e[1],Ze=Object(r.useState)([[1,1,1,1,1,1,2,6,1,1,1,1,2,5,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,2,6,1,6,2,1,1,1,5,2,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,6,2,1,1,1,1,1,1,1,1]]),$e=Object(u.a)(Ze,2),et=$e[0],tt=$e[1],nt=Object(r.useState)([[1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1],[2,0,0,5,0,0,0,0,0,0,0,1,0,0,0,0,1],[5,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1],[1,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,1],[1,0,0,0,0,0,2,0,0,0,5,0,0,0,0,0,1],[1,0,0,0,0,0,5,0,0,0,5,0,0,0,0,0,2],[1,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,5]]),rt=Object(u.a)(nt,2),at=rt[0],ct=rt[1],st=function(){var e=Object(g.a)(O.a.mark((function e(t,n){var r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Le.current){e.next=8;break}return Le.current=!0,e.next=4,y.getPlayState(t,n);case 4:r=e.sent,Object.keys(r).length>0&&(N(parseInt(JSON.parse(r.currentPomp.valeur))),I(parseInt(JSON.parse(r.currentTour.valeur))),D(parseInt(JSON.parse(r.currentCycle.valeur))),B(parseInt(JSON.parse(r.currentSequence.valeur))),tt(JSON.parse(r.mursH.valeur)),ct(JSON.parse(r.mursV.valeur)),Re(JSON.parse(r.carte.valeur)),Ne({Decedes:parseInt(JSON.parse(r.resultatsDecedes.valeur)),Sauves:parseInt(JSON.parse(r.resultatsSauves.valeur))}),d(JSON.parse(r.play.valeur)),ht(parseInt(JSON.parse(r.currentCycle.valeur)),parseInt(JSON.parse(r.currentSequence.valeur))),a=parseInt(JSON.parse(r.currrentChrono.valeur)),null!==me&&a<=me.chronoTourTact.valeur&&parseInt(JSON.parse(r.currentPomp.valeur))==v?fe(0==a?me.chronoTourTact.valeur:a):fe(null)),it(JSON.parse(r.carte.valeur)),Le.current=!1;case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){Ve.length>0&&(Ye(Ve.length),Qe(Ve[0].length),it(Ve))}),[Ve]),Object(r.useEffect)((function(){null!=G&&null!=_&&null==P&&(Le.current||null===me||st(G,_),ut(),it(Ve))}),[G,_,v,me]);var ut=function(){var e=Object(g.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getConfiguration(G);case 2:t=e.sent,ve(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),it=function(e){null!=e&&e.length>0&&e.forEach((function(e,t){e.forEach((function(e,n){1==Math.floor(e/1e3)&&Math.floor(e%1e3/100)==v&&(ne([t,n]),se({type:0,rotation:e%10}))}))}))},ot=function(e,t){if(e[0]<We&&e[1]<Ke)try{var n=Object(m.a)(Ve);n[e[0]][e[1]]=t,Re(n)}catch(r){}},lt=function(e,t){if(e[0]<et.length&&e[1]<et[0].length)try{var n=Object(m.a)(et);n[e[0]][e[1]]=t,tt(n)}catch(r){}},pt=function(e,t){if(e[0]<at.length&&e[1]<at[0].length)try{var n=Object(m.a)(at);n[e[0]][e[1]]=t,ct(n)}catch(r){}},bt=function(){var e=Object(m.a)(oe);e.pop();var t=e[e.length-1];Re(JSON.parse(t.carte)),tt(JSON.parse(t.mursH)),ct(JSON.parse(t.mursV)),ye(JSON.parse(t.stocks)),Ee(JSON.parse(t.interventions)),Ne(JSON.parse(t.resultats)),Me(JSON.parse(t.budget)),Ae(JSON.parse(t.budgetDepense)),se(JSON.parse(t.deplacementEnCours)),le(e)};Object(r.useEffect)((function(){null!==ee&&null!==xe&&Te>0&&0==ce.type&&(void 0==oe[oe.length-1]||Te<oe[oe.length-1].budget)&&function(e,t){var n=[].concat(Object(m.a)(oe),[{carte:JSON.stringify(Ve),budget:JSON.stringify(e),budgetDepense:JSON.stringify(t),mursH:JSON.stringify(et),mursV:JSON.stringify(at),stocks:JSON.stringify(xe),resultats:JSON.stringify(qe),interventions:JSON.stringify(Fe),deplacementEnCours:JSON.stringify({type:0,rotation:ce.rotation})}]);le(n)}(Te,ze)}),[ce,ze,xe]);var dt=function(e){try{if(Object.keys(xe).includes(e)){var t=xe;t[e]=t[e]-1,ye(t)}}catch(r){}try{if(Object.keys(Fe).includes(e)){var n=Fe;n[e]=n[e]-1,Ee(n)}}catch(r){}!function(e){var t=0;null!=me["coutEq"+e]&&(t+=me["coutEq"+e].valeur),null!=me["coutInter"+e]&&(t+=me["coutInter"+e].valeur),Me((function(e){return e-t})),Ae((function(e){return e+t}))}(e)};Object(r.useEffect)((function(){Ct(null),mt()}),[ee]),Object(r.useEffect)((function(){Ve.length>0&&jt()}),[ee,et,at]),Object(r.useEffect)((function(){if(null!=me){var e=Object(j.a)({},Fe);Object.keys(e).forEach((function(t){try{me["coutInter"+t].valeur>0&&(e[t]=Math.min(null!=me["coutEq"+t]&&void 0!=me["coutEq"+t]?Math.floor(Te/(me["coutInter"+t].valeur+me["coutEq"+t].valeur)):Math.floor(Te/me["coutInter"+t].valeur),null!==xe&&null!=xe[t]&&void 0!=xe[t]&&"NaN"!=xe[t]?xe[t]:1e3))}catch(n){}})),Ee(e)}}),[Te,me,v,xe]);var ft=function(){var e=Object(g.a)(O.a.mark((function e(t,n,r,a,s,u,i){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y.getBudgetsPompFin(G,_).then((function(e){var o=JSON.parse(e.valeur);try{o.interventions.forEach((function(e,r){e.numCycle==t&&e.numSeq==n&&(o.interventions[r]["pomp"+v]=Te)}))}catch(l){}try{o.equipements.forEach((function(e,r){e.numCycle==t&&e.numSeq==n&&(o.equipements[r].Feu["pomp"+v]=xe.Feu,o.equipements[r].FeuFum["pomp"+v]=xe.FeuFum,o.equipements[r].Fum["pomp"+v]=xe.Fum,o.equipements[r].Marqueur["pomp"+v]=xe.Marqueur)}))}catch(l){}y.saveBudgetsPompFin(o,G,_).then((function(){var e=Lt();y.nouveauTour(c,r,e,et,at,u,s,a,qe.Decedes,qe.Sauves,G,_,i)}))}));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,a,c,s,u){return e.apply(this,arguments)}}(),ht=function(){var e=Object(g.a)(O.a.mark((function e(t,n){var r,a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getBudgetsPompFin(G,_);case 2:r=(r=e.sent).valeur,r=JSON.parse(r),a=0,c=null!==xe&&void 0!==xe?Object(j.a)({},xe):{Feu:0,FeuFum:0,Fum:0,Marqueur:0};try{r.interventions.forEach((function(e){e.numCycle==t&&e.numSeq==n&&(a=e["pomp"+v])}))}catch(s){}try{r.equipements.forEach((function(e){e.numCycle==t&&e.numSeq==n&&(c.Feu+=e.Feu["pomp"+v],c.FeuFum+=e.FeuFum["pomp"+v],c.Fum+=e.Fum["pomp"+v],c.Marqueur+=e.Marqueur["pomp"+v])}))}catch(s){}a!==Te&&(Me(a),Ae(0)),ye(c);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){if(null===c&&null!==me){var e=te()("https://www.back.leaders-extreme.fr");e.emit("connecti",JSON.stringify({session:G,equipe:_})),e.on("changementTour",(function(e){var t=e;console.log(t),q==t.currentPomp&&J===t.currentCycle&&P===t.currentTour&&L===t.currentSequence||(console.log("changement tour"),st(G,_))})),e.on("startStopPartie",(function(e){d(e.start)})),e.on("disconnectUsers",(function(e){d(!1),i()})),s(e)}}),[c,me]);var jt=function(){(function(){if(Ve[ee[0]][ee[1]]%100<10)return!1;var e=[1,2,3,5];return 0==ee[0]&&!e.includes(et[ee[0]][ee[1]])||ee[0]==We-1&&!e.includes(et[ee[0]+1][ee[1]])||0==ee[1]&&!e.includes(at[ee[0]][ee[1]])||ee[1]==Ke-1&&!e.includes(at[ee[0]][ee[1]+1])})()&&setTimeout((function(){!function(e){var t=Object(j.a)({},qe);e?t.Sauves+=1:t.Decedes+=1,Ne(t)}(!0),ot(ee,Ve[ee[0]][ee[1]]-(Ve[ee[0]][ee[1]]%100-Ve[ee[0]][ee[1]]%10))}),1e3)},mt=function(){var e=Object(g.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=me){t=vt();try{20==t.dessus&&(ot([ee[0]-1,ee[1]],0),gt())}catch(n){}try{20==t.droite&&(ot([ee[0],ee[1]+1],0),gt())}catch(n){}try{20==t.dessous&&(ot([ee[0]+1,ee[1]],0),gt())}catch(n){}try{20==t.gauche&&(ot([ee[0],ee[1]-1],0),gt())}catch(n){}}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vt=function(){var e={};try{e.dessus=Ve[ee[0]-1][ee[1]]}catch(t){}try{e.droite=Ve[ee[0]][ee[1]+1]}catch(t){}try{e.dessous=Ve[ee[0]+1][ee[1]]}catch(t){}try{e.gauche=Ve[ee[0]][ee[1]-1]}catch(t){}return e},Ot=function(e){var t=[];try{4!=et[e[0]][e[1]]||et[e[0]][e[1]-1]<6&&et[e[0]][e[1]+1]<6?t.push(et[e[0]][e[1]]):t.push(0)}catch(n){}try{4!=at[e[0]][e[1]+1]||at[e[0]-1][e[1]+1]<6&&at[e[0]+1][e[1]+1]<6?t.push(at[e[0]][e[1]+1]):t.push(0)}catch(n){}try{4!=et[e[0]+1][e[1]]||et[e[0]+1][e[1]-1]<6&&et[e[0]+1][e[1]+1]<6?t.push(et[e[0]+1][e[1]]):t.push(0)}catch(n){}try{4!=at[e[0]][e[1]]||at[e[0]-1][e[1]]<6&&at[e[0]+1][e[1]]<6?t.push(at[e[0]][e[1]]):t.push(0)}catch(n){}return t},gt=function(){setTimeout((function(){le([{carte:JSON.stringify(Ve),budget:JSON.stringify(Te),budgetDepense:JSON.stringify(ze),mursH:JSON.stringify(et),mursV:JSON.stringify(at),stocks:JSON.stringify(xe),resultats:JSON.stringify(qe),interventions:JSON.stringify(Fe),deplacementEnCours:JSON.stringify({type:0,rotation:ce.rotation})}])}),300)},xt=Object(r.useState)(null),yt=Object(u.a)(xt,2),St=yt[0],Ct=yt[1],qt=Object(r.useState)([]),Nt=Object(u.a)(qt,2),kt=Nt[0],wt=Nt[1],Ft=Object(r.useState)([[],[]]),Et=Object(u.a)(Ft,2),Pt=Et[0],It=Et[1];Object(r.useEffect)((function(){3==St&&null!=St||It([[],[]]),(St>2&&St<6||null==St)&&wt([])}),[St]);var Tt=function(){var e=Object(g.a)(O.a.mark((function e(t){var n,r,a,c,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=me&&(t?(n=q+1,r=P,a=J,c=L,s=me.chronoTourTact.valeur,v==me.nbPompEquipe.valeur&&(P==me.nbToursParCycle.valeur?(r=1,n=0,s=me.chronoTourInter.valeur,a==me.nbCyclesParSequence.valeur?(a=1,c+=1):a+=1):(n=1,r+=1)),ft(J,L,n,r,a,c,s),gt()):bt());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Mt=function(e,t){if(null!==Ve&&void 0!==Ve&&Ve.length>0){for(var n=Math.floor(Math.random()*(t[0]-e[0]))+e[0],r=Math.floor(Math.random()*(t[1]-e[1]))+e[1],a=Ve[n][r];1==Math.floor(a/1e3)||2==Math.floor(a/10);)n=Math.floor(Math.random()*(t[0]-e[0]))+e[0],r=Math.floor(Math.random()*(t[1]-e[1]))+e[1],a=Ve[n][r];return[n,r]}return null},Jt=function(){var e=Object(j.a)({},qe);e.Decedes=e.Decedes+1,Ne(e)},Dt=function(e){var t=Object(m.a)(Ve);if(null!==Ve&&void 0!==Ve&&Ve.length>0&&null!==e)switch(t[e[0]][e[1]]){case 0:t[e[0]][e[1]]=3;break;case 3:t[e[0]][e[1]]=4;break;case 4:t=function(e,t){Ot(e).forEach((function(t,n){var r=t;if([3,5].includes(t)&&(r=4),1==r&&(r=3),3==r||4==r)switch(n){case 0:try{lt([e[0],e[1]],r)}catch(a){}break;case 1:try{pt([e[0],e[1]+1],r)}catch(c){}break;case 2:try{lt([e[0]+1,e[1]],r)}catch(s){}break;case 3:try{pt([e[0],e[1]],r)}catch(u){}}}));var n=[1,2,3,5];if(e[1]<Ke-1&&4==t[e[0]][e[1]+1])for(var r=1;e[1]+1+r<Ke;){var a=t[e[0]][e[1]+1+r];if(2==Math.floor(a/10)&&(t[e[0]][e[1]+1+r]=4,Jt()),1==Math.floor(a/1e3)&&a%100<10&&(t[e[0]][e[1]+1+r]=a-(a%100-a%10),Jt()),3==t[e[0]][e[1]+1+r]||0==t[e[0]][e[1]+1+r]){t[e[0]][e[1]+1+r]=4;break}var c=Ot([e[0],e[1]+1+r])[1];if(n.includes(c))try{pt([e[0],e[1]+2+r],4);break}catch(h){}r+=1}if(e[1]>0&&4==t[e[0]][e[1]-1])for(var s=1;e[1]-1-s>=0;){var u=t[e[0]][e[1]-1-s];if(2==Math.floor(u/10)&&(t[e[0]][e[1]-1-s]=4,Jt()),1==Math.floor(u/1e3)&&u%100<10&&(t[e[0]][e[1]-1-s]=u-(u%100-u%10),Jt()),3==t[e[0]][e[1]-1-s]||0==t[e[0]][e[1]-1-s]){t[e[0]][e[1]-1-s]=4;break}var i=Ot([e[0],e[1]-1-s])[3];if(n.includes(i))try{pt([e[0],e[1]-s-1],4);break}catch(j){}s-=1}if(e[0]>0&&4==t[e[0]-1][e[1]])for(var o=1;e[0]-1-o>=0;){var l=t[e[0]-1-o][e[1]];if(2==Math.floor(l/10)&&(t[e[0]-1-o][e[1]]=4,Jt()),1==Math.floor(l/1e3)&&l%100<10&&(t[e[0]-1-o][e[1]]=l-(l%100-l%10),Jt()),3==t[e[0]-1-o][e[1]]||0==t[e[0]-1-o][e[1]]){t[e[0]-1-o][e[1]]=4;break}var p=Ot([e[0]-1-o,e[1]])[0];if(n.includes(p))try{lt([e[0]-1-o,e[1]],4);break}catch(m){}o-=1}if(e[0]<We-1&&4==t[e[0]+1][e[1]])for(var b=0;e[0]+1+b>=0;){var d=t[e[0]+1+b][e[1]];if(2==Math.floor(d/10)&&(t[e[0]+1+b][e[1]]=4,Jt()),1==Math.floor(d/1e3)&&d%100<10&&(t[e[0]+1+b][e[1]]=d-(d%100-d%10),Jt()),3==t[e[0]+1+b][e[1]]||0==t[e[0]+1+b][e[1]]){t[e[0]+1+b][e[1]]=4;break}var f=Ot([e[0]+1+b,e[1]])[2];if(n.includes(f))try{lt([e[0]+2+b,e[1]],4);break}catch(v){}b+=1}return t}(e,t)}return t},zt=function e(t){var n=!1;if(null!==t&&void 0!==t&&t.length>0){for(var r=[1,2,3,5],a=-1,c=-1;a<We-1;){for(a+=1;c<Ke-1;){c+=1;var s=[et[a][c],at[a][c+1],et[a+1][c],at[a][c]];a<t.length&&c<t[0].length&&4==t[a][c]&&(a>0&&3==t[a-1][c]&&!r.includes(s[0])&&(t[a-1][c]=4,n=!0),c<Ke-1&&3==t[a][c+1]&&!r.includes(s[1])&&(t[a][c+1]=4,n=!0),a<We-1&&3==t[a+1][c]&&!r.includes(s[2])&&(t[a+1][c]=4,n=!0),c>0&&3==t[a][c-1]&&!r.includes(s[3])&&(t[a][c-1]=4,n=!0))}c=-1}n&&(e(t),n=!1)}return t},At=function(e){for(var t=function(e){if(null!=e&&e.length>0){var t=0;return e.forEach((function(e,n){e.forEach((function(e,n){2==Math.floor(e/10)&&(t+=1)}))})),t}}(e),n=0;n<me.nbHabitantsASauver.valeur-t;n++){var r=Mt([0,0],[We,Ke]);e[r[0]][r[1]]=20+Math.round(Math.random())}return e},Lt=function(){var e=Mt([0,0],[We,Ke]),t=Dt(e);return t=zt(t),t=At(t)},Bt=Object(r.useState)(null),Ht=Object(u.a)(Bt,2),Vt=Ht[0],Rt=Ht[1];Object(r.useEffect)((function(){null==Vt&&function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.getTexts("jeuTactInterface").then((function(e){Rt(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[Vt]);var Gt=function(e){if(null==Vt)return e;try{return Vt[e].contenu}catch(t){return e}};return Object(S.jsx)("div",{style:{position:"absolute",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",flex:1,width:"100%",height:"100%"},children:Ve.length>0&&null!=ee&&null!==xe&&null!==v&&b?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(U,{nbColonnesGrille:Ke,nbLignesGrille:We,carte:Ve,position:ee,mursH:et,mursV:at,propositionMursDetruire:Pt,propositionsCase:kt,handleClicMur:function(e,t,n,r){if(Pt[0].length>0||Pt[1].length>0){var a=function(t){var a=null;return n==ee[1]&&(r<ee[0]||r==ee[0]&&0==e)&&(a=0),n==ee[1]&&(r>ee[0]||r==ee[0]&&2==e)&&(a=2),r==ee[0]&&(n<ee[1]||n==ee[1]&&3==e)&&(a=3),r==ee[0]&&(n>ee[1]||n==ee[1]&&1==e)&&(a=1),a}(),c=4;if(1==t&&(c=3),null!=a){try{switch(a){case 0:lt([ee[0],ee[1]],c);break;case 1:pt([ee[0],ee[1]+1],c);break;case 2:lt([ee[0]+1,ee[1]],c);break;case 3:pt([ee[0],ee[1]],c)}dt("Marqueur")}catch(s){}It([[],[]]),Ct(null)}}},handleClicCase:function(e,t,n,r){try{ot([r,n],t),wt([]),Ct(null),4==e&&0==t&&dt("Feu"),4==e&&3==t&&dt("FeuFum"),3==e&&0==t&&dt("Fum"),2==Math.floor(e/10)&&0==t&&(dt("Habitant"),ot(ee,Ve[ee[0]][ee[1]]+e%10*10))}catch(a){}},handleChangePiece:function(){gt()},deplacementEnCours:ce}),Object(S.jsx)(w,{stocks:xe,resultats:qe,numeroPompier:v,sequence:L,cycle:J,tour:P,pomp:q,configuration:me,budget:Te,budgetDepense:ze,equipe:_,handleClicValidated:Tt,play:b,chronoInit:de,numEquipe:_,numSession:G}),Object(S.jsx)(H,{interventions:Fe,stocks:xe,numeroPompier:v,tour:P,pomp:q,handleClicFleche:function(e){var t,n;switch(e){case 0:t=[-1,0],n=1;break;case 1:t=[0,1],n=2;break;case 2:t=[1,0],n=3;break;case 3:t=[0,-1],n=4}(function(e){var t=Object(m.a)(e);if(0==t[0]&&0==t[1])return!1;if(ee[0]+t[0]>Ve.length-1||ee[1]+t[1]>Ve[0].length-1||ee[0]+t[0]<0||ee[1]+t[1]<0)return!1;try{var n=Ve[ee[0]+t[0]][ee[1]+t[1]];if(1==Math.floor(n/1e3))return!1;if(2==Math.floor(n/10))return!1;if([1e3,20,3,4].includes(n))return!1}catch(a){}var r=[1,2,3,5];try{if(0!=t[0]){if(t[0]<0&&(t[0]=0),"undefined"===typeof et[ee[0]+t[0]][ee[1]])return!1;if(r.includes(et[ee[0]+t[0]][ee[1]]))return!1}else{if(t[1]<0&&(t[1]=0),"undefined"===typeof at[ee[0]][ee[1]+t[1]])return!1;if(r.includes(at[ee[0]][ee[1]+t[1]]))return!1}}catch(a){}return!0})(t)&&(se({type:1,rotation:n}),setTimeout((function(){ot([ee[0]+t[0],ee[1]+t[1]],Ve[ee[0]][ee[1]]-Ve[ee[0]][ee[1]]%10+n),(Ve[ee[0]][ee[1]]%100-Ve[ee[0]][ee[1]]%10)/10>0?dt("DeplacementHab"):dt("Deplacement"),ot(ee,0),se({type:2,rotation:n}),setTimeout((function(){se({type:0,rotation:n})}),500)}),500))},handleClicValidated:Tt,handleClicDoor:function(e){var t,n;Ct(e?4:5),e?(t=5,n=6):(t=6,n=5),dt("Porte");try{et[ee[0]][ee[1]]==t&&lt([ee[0],ee[1]],n),et[ee[0]+1][ee[1]]==t&&lt([ee[0]+1,ee[1]],n),at[ee[0]][ee[1]]==t&&pt([ee[0],ee[1]],n),at[ee[0]][ee[1]+1]==t&&pt([ee[0],ee[1]+1],n)}catch(r){}},handleClicMarqueur:function(){if(3!=St)if(Ct(3),Pt[0].length>0||Pt[1].length>0)It([[],[]]);else{var e=[1,3,5,6],t=[[],[]],n=Ot(ee);try{e.includes(n[0])&&t[0].push([ee[1],ee[0]]),e.includes(n[1])&&t[1].push([ee[1]+1,ee[0]]),e.includes(n[2])&&t[0].push([ee[1],ee[0]+1]),e.includes(n[3])&&t[1].push([ee[1],ee[0]])}catch(r){}It(t)}else Ct(null)},handleClicExt:function(e){var t=[1,2,3,5],n=Ot(ee);if(St!=e){var r=[],a=4,c=0;switch(Ct(e),e){case 0:break;case 1:c=3;break;case 2:a=3}try{Ve[ee[0]-1][ee[1]]!=a||t.includes(n[0])||r.push([ee[0]-1,ee[1],a,c])}catch(s){}try{Ve[ee[0]][ee[1]+1]!=a||t.includes(n[1])||r.push([ee[0],ee[1]+1,a,c])}catch(s){}try{Ve[ee[0]+1][ee[1]]!=a||t.includes(n[2])||r.push([ee[0]+1,ee[1],a,c])}catch(s){}try{Ve[ee[0]][ee[1]-1]!=a||t.includes(n[3])||(r.push([ee[0],ee[1]-1,a,c]),console.log("test"))}catch(s){}wt(r)}else Ct(null)},handleNoClicked:function(){It([[],[]]),wt([])},handleClicHabitant:function(){if(6!=St){Ct(6);var e=[];try{var t=Ve[ee[0]-1][ee[1]];2==Math.floor(t/10)&&e.push([ee[0]-1,ee[1],t,0])}catch(c){}try{var n=Ve[ee[0]][ee[1]+1];2==Math.floor(n/10)&&e.push([ee[0],ee[1]+1,n,0])}catch(c){}try{var r=Ve[ee[0]+1][ee[1]];2==Math.floor(r/10)&&e.push([ee[0]+1,ee[1],r,0])}catch(c){}try{var a=Ve[ee[0]][ee[1]-1];2==Math.floor(a/10)&&e.push([ee[0],ee[1]-1,a,0])}catch(c){}wt(e)}else Ct(null)},btnClickedBottom:St,mursAutour:Ot(ee),casesAutour:vt(),currentCase:Ve[ee[0]][ee[1]],histActions:oe,configuration:me,deplacementEnCours:ce,budgetMaxAtteint:ze>=me.budgetTourMax.valeur,isLoading:!1}),Object(S.jsx)(Z,{handleDisconnect:i,configuration:me})]}):Object(S.jsxs)("div",{style:{color:"gray",textAlign:"center",fontSize:20},children:[Object(S.jsx)($.a,{children:Gt("attenteLancement")}),Object(S.jsx)($.a,{children:Gt("infoLancement")})]})})},re=(n(199),n(273)),ae=function(e){var t=e.numeroPompier,n=e.numEquipe,a=e.numSession,c=e.sequence,s=e.cycle,i=e.tour,o=e.configuration,l=e.handleViewChange,p=e.vue,b=e.interventionsValidated,d=e.equipementsValidated,f=e.pomp,h=e.play,j=e.handleClicValidated,m=e.chronoInit,v=e.validated,x=Object(r.useState)(null),q=Object(u.a)(x,2),w=q[0],E=q[1];Object(r.useEffect)((function(){null==w&&function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.getTexts("jeuInterBandeauTop").then((function(e){E(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[w]);var P=function(e){if(null==w)return e;try{return w["label"+e.charAt(0).toUpperCase()+e.slice(1)].contenu}catch(t){return e}},I=Object(r.useState)(null),T=Object(u.a)(I,2),M=T[0],J=T[1];Object(r.useEffect)((function(){if(f==t&&null!==M&&h)if(M>0)var e=setInterval((function(){M%30==0&&M>10&&y.updateCurrentChrono(M,a,n),J((function(e){return e-1}))}),1e3);else v.interventions||j("interventions",!0),v.equipements||j("equipements",!0),J(null);else null!==o&&J(null==m?o.chronoTourInter.valeur:m);return function(){clearInterval(e)}}),[M]),Object(r.useEffect)((function(){null!==m&&M>=m&&null!==o&&J(m)}));return null!=o?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"bandeau-top-right",children:Object(S.jsxs)("div",{className:"cases-container",children:[Object(S.jsx)(C,{name:"sequence",value:c,primary:!0,flexFactor:1,textes:w,data:o.nbSequences.valeur}),Object(S.jsx)(C,{name:"cycle",value:s,primary:!0,flexFactor:1,textes:w,data:o.nbCyclesParSequence.valeur}),Object(S.jsx)(C,{name:"tour",value:i,primary:!0,flexFactor:1,textes:w,data:o.nbToursParCycle.valeur}),function(){var e=o.nbPompEquipe.valeur,t=360/e;return Object(S.jsxs)("div",{className:"case-panel",style:{flex:1},children:[Object(S.jsx)("label",{className:"label-title",children:P("tourParTour")}),Object(S.jsx)("ul",{children:function(){var n=[];n.push(Object(S.jsx)("li",{style:{transform:"translate(24px,-24px)",backgroundColor:0==f?"#BF0000":null},children:"S"},"s"));for(var r=0;r<e;r++){var a=t*r-90,c=-1*a;n.push(Object(S.jsx)("li",{style:{transform:"rotate("+a+"deg) translate(20px) rotate("+c+"deg) translate("+"-10px) translateY(10px)",backgroundColor:r+1==f?"#BF0000":null},children:r+1},r))}return n}()})]})}(),Object(S.jsxs)("div",{className:"case-panel",style:{flex:1},children:[Object(S.jsx)("label",{className:"label-title",children:P("numEquipe")}),Object(S.jsxs)("div",{className:"donnees-container",children:[Object(S.jsx)("label",{className:"label-title label-num-pompier",children:n}),Object(S.jsx)(N.a,{className:"icone-num-pompier",fontSize:"large",stroke:"white",strokeWidth:1})]})]}),Object(S.jsxs)("div",{className:"case-panel",style:{flex:1},children:[Object(S.jsx)("label",{className:"label-title",children:P("play")}),Object(S.jsxs)("div",{className:"donnees-container",children:[Object(S.jsxs)("div",{className:"feu",children:[Object(S.jsx)("div",{className:M<30?"clignotant animation-reverted":"",style:{backgroundColor:t!=f||M<30?M<30?"#E26F00":"#ff0000":"#9F9F9F"}}),Object(S.jsx)("div",{className:M<30?"clignotant":"",style:{backgroundColor:t==f?M<30?"#E26F00":"#4dff4d":"#9F9F9F"}})]}),Object(S.jsxs)("span",{className:"case-value",style:{marginTop:"10%",width:"100%",maxWidth:"100%"},children:[Math.floor(M/60).toString().padStart(2,"0")+" : ",Object(S.jsxs)("span",{style:{color:M<=30?"red":"inherit",marginLeft:5},children:[" "," "+(M%60).toString().padStart(2,"0")," "]})]})]})]})]})}),Object(S.jsx)("div",{className:"bandeau-top-left",children:Object(S.jsxs)(re.a,{value:p,exclusive:!0,onChange:l,"aria-label":"text alignment",className:"bouton-vue-container",children:[Object(S.jsxs)(F.a,{value:"operations","aria-label":"operations",className:"bouton-vue",children:[Object(S.jsx)($.a,{className:"label-vue",variant:"h5",children:null!==w?w.labelOperations.titre:""}),Object(S.jsx)($.a,{variant:"h6",children:null!==w?w.labelOperations.contenu:""})]}),Object(S.jsxs)(F.a,{value:"interventions","aria-label":"interventions",className:"bouton-vue",children:[Object(S.jsx)($.a,{className:"label-vue",variant:"h5",children:null!==w?w.labelInterventions.titre:""}),Object(S.jsx)($.a,{variant:"h6",children:null!==w?w.labelInterventions.contenu:""}),Object(S.jsx)("div",{className:b?"indicateur vert":"indicateur rouge",children:Object(S.jsx)("img",{src:b?"assets/validate.png":"assets/cancel.png",alt:"image"})})]}),Object(S.jsxs)(F.a,{value:"equipements","aria-label":"equipements",className:"bouton-vue",children:[Object(S.jsx)($.a,{className:"label-vue",variant:"h5",children:null!==w?w.labelEquipements.titre:""}),Object(S.jsx)($.a,{variant:"h6",children:null!==w?w.labelEquipements.contenu:""}),Object(S.jsx)("div",{className:d?"indicateur vert":"indicateur rouge",children:Object(S.jsx)("img",{src:d?"assets/validate.png":"assets/cancel.png",alt:"image"})})]})]})})]}):null},ce=(n(201),function(e){var t=e.numeroPompier,n=e.vue,a=e.resultats,c=e.budget,s=e.validated,i=e.handleClicValidated,o=(e.tour,e.currentCycle,e.couts),l=e.equipe,p=e.pomp,b=Object(r.useState)(null),d=Object(u.a)(b,2),f=d[0],h=d[1];Object(r.useEffect)((function(){null==f&&function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.getTexts("jeuInterBandeauBottom").then((function(e){h(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[f]);var j=function(e){if(null==f)return e;try{return f["label"+e.charAt(0).toUpperCase()+e.slice(1)].contenu}catch(t){return e}},m=function(e){if(null!==o){var t=[],r=[];return e?Object.keys(o.interventions).forEach((function(e,n){n<Object.keys(o.interventions).length/2?t.push(Object(S.jsxs)("span",{className:"label-cout-inter",children:[j(e)+" : ",Object(S.jsx)("span",{className:"label-cout-inter-eur",children:o.interventions[e]+" \u20ac"})]},n)):r.push(Object(S.jsxs)("span",{className:"label-cout-inter",children:[j(e)+" : ",Object(S.jsx)("span",{className:"label-cout-inter-eur",children:o.interventions[e]+" \u20ac"})]},n))})):Object.keys(o.equipements).forEach((function(e,n){n<Object.keys(o.equipements).length/2?t.push(Object(S.jsxs)("span",{className:"label-cout-inter",children:[j(e)+" : ",Object(S.jsx)("span",{className:"label-cout-inter-eur",children:o.equipements[e]+" \u20ac"})]},n)):r.push(Object(S.jsxs)("span",{className:"label-cout-inter",children:[j(e)+" : ",Object(S.jsx)("span",{className:"label-cout-inter-eur",children:o.equipements[e]+" \u20ac"})]},n))})),Object(S.jsxs)("div",{className:"case-panel",children:[Object(S.jsx)("label",{className:"label-title",children:"Co\xfbts "+n.charAt(0).toUpperCase()+n.slice(1)}),Object(S.jsxs)("div",{className:"couts-container",children:[Object(S.jsx)("div",{children:t}),Object(S.jsx)("div",{children:r})]})]})}},v=function(){return Object(S.jsx)("div",{className:"budgets-container",children:Object(S.jsxs)("div",{className:"case-panel donnees-container ",style:{flex:1},children:[Object(S.jsx)("label",{className:"label-title",children:j("interventions"==n?"sequenceInter":"sequenceEq")}),Object(S.jsx)(C,{name:"budgetSeqTot",value:void 0!=c?c.sequence:"0 \u20ac",primary:!1,textes:f,flexFactor:0},1),Object(S.jsx)(C,{name:"budgetSeqDep",value:void 0!=c?c.depense:"0 \u20ac",primary:!1,textes:f,flexFactor:0},2),Object(S.jsx)(C,{name:"budgetSeqDispo",value:void 0!=c?c.sequence-c.depense:"0 \u20ac",primary:!1,textes:f,flexFactor:0},3)]})})},x=function(){return Object(S.jsxs)("div",{className:"boutons-valider-container",children:[Object(S.jsx)(E.a,{disabled:t!==p||("interventions"==n?s.interventions:s.equipements),className:"bouton-valider vert",variant:"contained",disableElevation:!0,onClick:function(){return i(n,!0)},children:Object(S.jsx)("img",{src:"assets/validate.png",alt:"image"})},0),Object(S.jsx)(E.a,{disabled:t!==p||("interventions"==n?!(s.interventions&&!s.equipements):!(!s.interventions&&s.equipements)),className:"bouton-valider rouge",variant:"contained",disableElevation:!0,onClick:function(){return i(n,!1)},children:Object(S.jsx)("img",{src:"assets/return.png",alt:"image"})},1)]})};return Object(S.jsxs)(S.Fragment,{children:["operations"==n?Object(S.jsx)("div",{className:"bandeau-bottom-inter left",children:Object(S.jsxs)("div",{className:"case-panel donnees-container",style:{flex:2},children:[Object(S.jsx)("label",{className:"label-title",children:j("resultats")+" N\xb0"+l}),Object(S.jsx)(C,{name:j("nbDecedes"),value:a.Decedes,primary:!1,flexFactor:0},1),Object(S.jsx)(C,{name:j("nbSauves"),value:a.Sauves,primary:!1,flexFactor:0},2),Object(S.jsx)(C,{name:j("nbMarqueurs"),value:a.Marqueur,primary:!1,flexFactor:0},3)]})}):null,"interventions"==n?Object(S.jsxs)("div",{className:"bandeau-bottom-inter",children:[m(!0),v(),x()]}):null,"equipements"==n?Object(S.jsxs)("div",{className:"bandeau-bottom-inter",children:[m(!1),v(),x()]}):null]})}),se=n(249),ue=n(262),ie=n(264),oe=n(256),le=n(261),pe=n(263),be=n(257),de=n(265),fe=n(270),he=n(274),je=n(258),me=n(268),ve=n(271),Oe=(n(202),function(e){var t=e.budget,n=e.cycles,a=e.handleBudgetChange,c=e.type,s=e.currentCycle,i=e.currentSequence,o=e.budgetSim,l=e.couts,p=(e.page,e.nbCycleParSeq),b=e.configuration,d=Object(r.useRef)(null),f=b.nbPompEquipe.valeur,h=Object(r.useState)(o.numCycle),v=Object(u.a)(h,2),x=(v[0],v[1],Object(r.useState)(o)),y=Object(u.a)(x,2),C=y[0],q=y[1],N=Object(r.useState)((console.log("init local page"),p>0&&o.numSeq>0?"interventions"==c?n.length>0?Math.floor(n[n.length-1].numSeq/p):0:n.length>0?Math.floor((n[n.length-1].numSeq-1)*p+n[n.length-1].numCycle-1):0:0)),w=Object(u.a)(N,2),F=w[0],E=w[1],P=Object(r.useState)(null),I=Object(u.a)(P,2),T=I[0],M=I[1];Object(r.useEffect)((function(){null==T&&function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.getTexts("jeuInterInterventions").then((function(e){M(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[T]);var J=function(e){if(null==T)return e;try{return T["label"+e.charAt(0).toUpperCase()+e.slice(1)].contenu}catch(t){return console.log("label"+e.charAt(0).toUpperCase()+e.slice(1)),e}},D=function(){q(o)},z=function(e,t,n){var r=Object(j.a)({},C);"interventions"==c?r["pomp"+e]=t.target.value:r[n]["pomp"+e]=t.target.value,q(r),a(c,r)},A=function(e,r,a,c){var s=Object(m.a)(n).sort((function(e,t){return e.numCycle-t.numCycle})).sort((function(e,t){return e.numSeq-t.numSeq}))[(e-1)*p+r-1];null==s&&(s=Object(j.a)({},C));var u=0;null!=s&&Object.keys(s).forEach((function(t,n){"numCycle"!=t&&"numSeq"!==t&&(a!==n-1||r<C.numCycle||e<C.numSeq)&&(u+=s[t])}));for(var i=[],o=null!=s&&(r<C.numCycle||e<C.numSeq)?u:t.sequence-t.depense-u,l=0;l<=Math.floor(o/100);l++)i.push(Object(S.jsx)(he.a,{value:100*l,align:"right",children:100*l+"\u20ac"},"item"+r+":"+a+":"+l));return i},L=function(e,t,n,r,a){return Object(S.jsx)(je.a,{disabled:n,variant:"outlined",children:Object(S.jsxs)(me.a,{value:a,onChange:function(e){return z(r,e)},displayEmpty:!0,color:"secondary",className:0==a||n?"empty":"",children:[Object(S.jsxs)(he.a,{value:"",disabled:!0,align:"center",children:["Budget ",r]}),A(e,t,r)]})},"select"+e+":"+t+" : "+r)},B=function(e){var n=[],r=0;e.numCycle%p==1&&n.push(Object(S.jsxs)(oe.a,{scope:"row",align:"center",component:"th",rowSpan:p,children:["S\xe9quence n\xb0",e.numSeq]},"row"+e+":0")),n.push(Object(S.jsxs)(oe.a,{scope:"row",align:"center",component:"th",children:["Cycle n\xb0",e.numCycle]},"row"+e+":1"));var a=e.numSeq<C.numSeq||e.numCycle<C.numCycle;return Object.keys(e).forEach((function(t,c){"numCycle"!=t&&"numSeq"!=t&&(n.push(Object(S.jsx)(oe.a,{scope:"row",align:"center",children:L(e.numSeq,e.numCycle,a,c-1,e[t])},"row"+e+":pomp"+c)),r+=e[t])})),n.push(Object(S.jsx)(oe.a,{scope:"row",align:"center",children:Object(S.jsx)(ve.a,{variant:"outlined",disabled:!0,value:r+" \u20ac",inputProps:{style:{color:a?null:r>t.sequence-t.depense?"red":"green",fontWeight:a?null:"bold",fontStyle:a?"italic":null,textAlign:"center",backgroundColor:"#f1f1f1",borderRadius:5}}})},1e3)),Object(S.jsx)(be.a,{hover:!0,ref:e.numCycle>=s?d:null,children:n},"row"+e.numSeq+" : "+e.numCycle+Math.random())},H=function(e,r,a,c){var s=Object(m.a)(n).sort((function(e,t){return e.numCycle-t.numCycle})).sort((function(e,t){return e.numSeq-t.numSeq}))[(e-1)*p+r-1];null==s&&(s=Object(j.a)({},C));var u=0;null!=s&&Object.keys(s).forEach((function(t){"numCycle"!=t&&"numSeq"!==t&&"type"!==t&&Object.values(s[t]).forEach((function(n,s){(c!==t||a!==s+1||r<C.numCycle||e<C.numSeq)&&(u+=n*l.equipements["coutEq"+t])}))}));for(var i=[],o=null!=s&&(r<C.numCycle||e<C.numSeq)?Math.floor(u/l.equipements["coutEq"+c]):Math.floor((t.sequence-t.depense-u)/l.equipements["coutEq"+c]),b=0;b<=Math.max(0,o);b++)i.push(Object(S.jsx)(he.a,{value:b,align:"right",children:b},r+":"+a+":"+b));return i},V=function(e,t,n,r,a,c){return Object(S.jsx)(je.a,{disabled:n,variant:"outlined",children:Object(S.jsxs)(me.a,{value:a,onChange:function(e){return z(r,e,c)},displayEmpty:!0,color:"secondary",className:0==a||n?"empty":"",children:[Object(S.jsxs)(he.a,{value:"",disabled:!0,align:"center",children:["Stock ",r]}),H(e,t,r,c)]})},e+":"+t+" :"+r+":"+c+Math.random())},R=function(e,n,r){if(e.numCycle<s+2){var a=[],c=0;Object.keys(C).length;"Feu"==n&&(a.push(Object(S.jsxs)(oe.a,{scope:"row",align:"center",component:"th",rowSpan:p*(Object.keys(C).length-2),children:["S\xe9quence n\xb0",e.numSeq]},"row"+e+":0")),a.push(Object(S.jsxs)(oe.a,{scope:"row",align:"center",component:"th",rowSpan:Object.keys(C).length-2,children:["Cycle n\xb0",e.numCycle]},"row"+e+":1"))),a.push(Object(S.jsx)(oe.a,{scope:"row",align:"center",children:J("Marqueur"!==n?"Ext"+n:n)},"row"+e+":2"));var u=e.numSeq<C.numSeq||e.numCycle<C.numCycle;return null!==r&&void 0!==r&&Object.keys(r).forEach((function(t,s){"numCycle"!=t&&"numSeq"!=t&&"type"!==t&&(a.push(Object(S.jsx)(oe.a,{align:"center",scope:"row",children:V(e.numSeq,e.numCycle,u,s+1,r[t],n)},"row"+e+":pomp"+s+3)),c+=r[t]*l.equipements["coutEq"+n])})),a.push(Object(S.jsx)(oe.a,{scope:"row",align:"center",children:Object(S.jsx)(ve.a,{id:"outlined-basic",variant:"outlined",disabled:!0,value:c+" \u20ac",inputProps:{style:{color:u?null:c>t.sequence-t.depense?"red":"green",fontWeight:u?null:"bold",fontStyle:u?"italic":null,textAlign:"center",backgroundColor:"#f1f1f1",borderRadius:5}}})},20)),Object(S.jsx)(be.a,{hover:!0,ref:e.numCycle>=s?d:null,children:a},e.numSeq+" : "+e.numCycle+" : "+n+Math.random())}return null};return Object(S.jsx)("div",{className:"container",children:Object(S.jsx)(le.a,{component:se.a,className:"tableau",children:Object(S.jsxs)(ue.a,{stickyHeader:!0,size:"small",children:[Object(S.jsx)(pe.a,{children:function(){var e=[];e.push(Object(S.jsx)(oe.a,{align:"center",component:"th",children:"S\xe9quence"},"head0")),e.push(Object(S.jsx)(oe.a,{align:"center",component:"th",children:"Cycle"},"head1")),"equipements"==c&&e.push(Object(S.jsx)(oe.a,{align:"center",component:"th",children:"Type"},"head2"));for(var t=1;t<=f;t++)e.push(Object(S.jsxs)(oe.a,{align:"center",component:"th",children:["Pompier ",t]},"head"+t+3));return e.push(Object(S.jsx)(oe.a,{align:"center",component:"th",children:"Total"},1e3)),Object(S.jsx)(be.a,{children:e},"header")}()}),Object(S.jsxs)(ie.a,{children:["interventions"==c?function(){o.numCycle!==C.numCycle&&D();var e=Object(m.a)(n).sort((function(e,t){return e.numCycle-t.numCycle})).sort((function(e,t){return e.numSeq-t.numSeq})),t=[];return e.forEach((function(e,n){(e.numSeq<i||e.numSeq==i&&e.numCycle<s+1)&&e.numSeq==F+1&&t.push(B(e))})),C.numSeq==F+1&&t.push(B(C)),t}():null,"equipements"==c?function(){o.numCycle!==C.numCycle&&D();var e=Object(m.a)(n).sort((function(e,t){return 100*(e.numSeq-t.numSeq)+e.numCycle-t.numCycle})),t=[];return e.forEach((function(e,n){n==F&&Object.keys(e).forEach((function(n){"numSeq"!==n&&"numCycle"!==n&&t.push(R(e,n,e[n]))}))})),F==(C.numSeq-1)*p+C.numCycle-1&&Object.keys(C).forEach((function(e){"numSeq"!==e&&"numCycle"!==e&&t.push(R(C,e,C[e]))})),t}():null]}),Object(S.jsx)(de.a,{children:Object(S.jsx)(be.a,{children:Object(S.jsx)(fe.a,{rowsPerPageOptions:[Object.keys(C).length-2],count:"interventions"==c?C.numSeq*p:(C.numSeq-1)*p+C.numCycle,rowsPerPage:"interventions"==c?p:1,page:F,labelDisplayedRows:function(e){var t=e.from;e.to,e.count;return"interventions"==c?"S\xe9quence n\xb0 "+Math.ceil(t/p)+" | Cycles 1 - "+p:"S\xe9quence n\xb0 "+Math.ceil(t/p)+"    |    Cycle n\xb0 "+(F%p+1)},onChangePage:function(e,t){E(t)}})},"footer-row")})]})})})}),ge=(n(203),function(e){var t=e.configuration,n=e.handleDisconnect,a=Object(r.useState)(!1),c=Object(u.a)(a,2),s=c[0],i=c[1];return null!=t?Object(S.jsxs)("div",{className:"bandeau-droite-inter",onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},children:[Object(S.jsx)("div",{className:"btn-panel-droite",style:{flex:1},children:s?Object(S.jsx)(E.a,{variant:"contained",color:"primary",onClick:function(){i(!1),n()},startIcon:Object(S.jsx)(_.a,{fontSize:"large"}),children:"Se d\xe9connecter"}):Object(S.jsx)("div",{children:Object(S.jsx)(_.a,{fontSize:"small"})})}),Object(S.jsx)("div",{className:"btn-panel-droite",style:{flex:1},children:s?Object(S.jsx)(E.a,{variant:"contained",color:"primary",disabled:!0,startIcon:Object(S.jsx)(Q.a,{fontSize:"large"}),children:"Messagerie"}):Object(S.jsx)("div",{children:Object(S.jsx)(Q.a,{fontSize:"small"})})})]}):null}),xe=function(){var e=Object(o.g)(),t=Y.a.load("user"),n=function(){Y.a.save("user","disconnected",{path:"/",maxAge:5400}),e.push("/login")};null!==t&&void 0!==t&&"disconnected"!=t||e.push("/login"),null===t||void 0===t||void 0===t.role||t.role.includes("INTER")||n();var a=Object(r.useState)(!1),c=Object(u.a)(a,2),s=c[0],i=c[1],l=Object(r.useState)(0),p=Object(u.a)(l,2),b=p[0],d=(p[1],Object(r.useState)(null)),f=Object(u.a)(d,2),h=f[0],v=f[1],x=Object(r.useState)(null),C=Object(u.a)(x,2),q=C[0],N=C[1],w=Object(r.useState)(null),F=Object(u.a)(w,2),E=F[0],P=F[1],I=Object(r.useState)(null),T=Object(u.a)(I,2),M=T[0],J=T[1],D=Object(r.useState)(null!==t&&void 0!==t?t.session:null),z=Object(u.a)(D,2),A=z[0],L=(z[1],Object(r.useState)(null!==t&&void 0!==t?t.equipe:null)),B=Object(u.a)(L,2),H=B[0],V=(B[1],Object(r.useState)(null)),R=Object(u.a)(V,2),G=R[0],W=R[1],X=Object(r.useState)("operations"),_=Object(u.a)(X,2),K=_[0],Q=_[1],Z=Object(r.useState)(null),ee=Object(u.a)(Z,2),ne=ee[0],re=ee[1],se=Object(r.useState)(null),ue=Object(u.a)(se,2),ie=ue[0],oe=ue[1],le=Object(r.useState)({Decedes:0,Sauves:0,Marqueur:0}),pe=Object(u.a)(le,2),be=pe[0],de=pe[1],fe=Object(r.useState)({sequence:0,depense:0}),he=Object(u.a)(fe,2),je=he[0],me=he[1],ve=Object(r.useState)(null),xe=Object(u.a)(ve,2),ye=xe[0],Se=xe[1];Object(r.useEffect)((function(){null!=ne&&(oe({interventions:{coutInterDeplacement:ne.coutInterDeplacement.valeur,coutInterDeplacementHab:ne.coutInterDeplacementHab.valeur,coutInterFeu:ne.coutInterFeu.valeur,coutInterFeuFum:ne.coutInterFeuFum.valeur,coutInterFum:ne.coutInterFum.valeur,coutInterMarqueur:ne.coutInterMarqueur.valeur,coutInterPorte:ne.coutInterPorte.valeur,coutInterHab:ne.coutInterHabitant.valeur},equipements:{coutEqFeu:ne.coutEqFeu.valeur,coutEqFeuFum:ne.coutEqFeuFum.valeur,coutEqFum:ne.coutEqFum.valeur,coutEqMarqueur:ne.coutEqMarqueur.valeur}}),me({interventions:{sequence:ne.budgetDefaultInter.valeur,depense:0},equipements:{sequence:ne.budgetDefaultInter.valeur,depense:0}}),null!=ye&&at(ye))}),[ne]);var Ce=Object(r.useState)(null),qe=Object(u.a)(Ce,2),Ne=qe[0],ke=qe[1];Object(r.useEffect)((function(){null!=ye&&y.saveBudgetsPompInit(ye,A,H).then((function(){null!=ne&&at(ye),null!=Ne&&void 0!=Ne.interventions&&Ne.interventions.numCycle===ye.interventions.length%2+1&&Ne.equipements.numCycle===ye.equipements.length%2+1||ke({interventions:{numSeq:ye.interventions.length>1?ye.interventions.length%2==0?ye.interventions[ye.interventions.length-1].numSeq+1:ye.interventions[ye.interventions.length-1].numSeq:1,numCycle:ye.interventions.length%2+1,pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0},equipements:{numSeq:ye.equipements.length>1?ye.equipements.length%2==0?ye.equipements[ye.equipements.length-1].numSeq+1:ye.equipements[ye.equipements.length-1].numSeq:1,numCycle:ye.equipements.length%2+1,Feu:{pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0},FeuFum:{pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0},Fum:{pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0},Marqueur:{pomp1:0,pomp2:0,pomp3:0,pomp4:0,pomp5:0,pomp6:0}}})}))}),[ye]);var we=Object(r.useState)({interventions:!1,equipements:!1}),Fe=Object(u.a)(we,2),Ee=Fe[0],Pe=Fe[1],Ie=Object(r.useRef)(!1),Te=Object(r.useState)([[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),Me=Object(u.a)(Te,2),Je=Me[0],De=Me[1],ze=Object(r.useState)(0),Ae=Object(u.a)(ze,2),Le=Ae[0],Be=Ae[1],He=Object(r.useState)(0),Ve=Object(u.a)(He,2),Re=Ve[0],Ge=Ve[1],Ue=Object(r.useState)(null),We=Object(u.a)(Ue,2),Ye=We[0],Xe=We[1],_e=Object(r.useState)([[1,1,1,1,1,1,2,6,1,1,1,1,2,5,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,2,6,1,6,2,1,1,1,5,2,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,6,2,1,1,1,1,1,1,1,1]]),Ke=Object(u.a)(_e,2),Qe=Ke[0],Ze=Ke[1],$e=Object(r.useState)([[1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1],[2,0,0,5,0,0,0,0,0,0,0,1,0,0,0,0,1],[5,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1],[1,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,1],[1,0,0,0,0,0,2,0,0,0,5,0,0,0,0,0,1],[1,0,0,0,0,0,5,0,0,0,5,0,0,0,0,0,2],[1,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,5]]),et=Object(u.a)($e,2),tt=et[0],nt=et[1],rt=function(e,t){var n=0;return e.forEach((function(e){e.forEach((function(e){3==e&&(n+=1),4==e&&(n+=2)}))})),t.forEach((function(e){e.forEach((function(e){3==e&&(n+=1),4==e&&(n+=2)}))})),n},at=function(e){if(null!==e&&null!==ne){console.log("init infos");var t=Object(m.a)(e.equipements).sort((function(e,t){return 100*(e.numSeq-t.numSeq)+e.numCycle-t.numCycle}))[Object(m.a)(e.equipements).length-1],n=Object(m.a)(e.interventions).sort((function(e,t){return 100*(e.numSeq-t.numSeq)+e.numCycle-t.numCycle}))[Object(m.a)(e.interventions).length-1],r={interventions:!1,equipements:!1};null!==n&&void 0!==n&&n.numSeq==M&&n.numCycle==E&&(r.interventions=!0),null!==t&&void 0!==t&&t.numSeq==M&&t.numCycle==E&&(r.equipements=!0),Pe(r);var a={interventions:{sequence:ne.budgetDefaultInter.valeur,depense:ut(Ne,"interventions")},equipements:{sequence:ne.budgetDefaultInter.valeur,depense:ut(Ne,"equipements")}};me(a)}};Object(r.useEffect)((function(){at(ye)}),[ie]);var ct=function(){var e=Object(g.a)(O.a.mark((function e(t,n){var r,a,c,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ie.current||null==ne){e.next=11;break}return Ie.current=!0,console.log("getplaystate"),e.next=5,y.getPlayState(t,n);case 5:r=e.sent,console.log(r),Object.keys(r).length>0?(v(parseInt(JSON.parse(r.currentPomp.valeur))),N(parseInt(JSON.parse(r.currentTour.valeur))),P(parseInt(JSON.parse(r.currentCycle.valeur))),J(parseInt(JSON.parse(r.currentSequence.valeur))),a=JSON.parse(r.mursH.valeur),c=JSON.parse(r.mursV.valeur),i(JSON.parse(r.play.valeur)),Ze(a),nt(c),De(JSON.parse(r.carte.valeur)),de({Decedes:parseInt(JSON.parse(r.resultatsDecedes.valeur)),Sauves:parseInt(JSON.parse(r.resultatsSauves.valeur)),Marqueur:rt(a,c)}),Se(JSON.parse(r.budgetsPompInit.valeur)),s=parseInt(JSON.parse(r.currrentChrono.valeur)),null!==ne&&s<=ne.chronoTourInter.valeur&&parseInt(JSON.parse(r.currentPomp.valeur))==b?W(s):W(null),i(JSON.parse(r.play.valeur))):console.log("error"),Ie.current=!1,e.next=12;break;case 11:console.log(ne);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){Je.length>0&&(Be(Je.length),Ge(Je[0].length),Xe([Je.length+1,Je[0].length+1]))}),[Je]),Object(r.useEffect)((function(){console.log(ne)}),[ne]),Object(r.useEffect)((function(){null===ne&&st(),null!=A&&null!=H&&null==q&&(Ie.current||null===ne||ct(A,H))}),[A,H,b,ne]);var st=function(){var e=Object(g.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getPlay Parameters"),e.next=3,y.getConfiguration(A);case 3:t=e.sent,re(t),console.log(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ut=function(e,t){var n=0;if(null!==ie)if("interventions"==t)ye.interventions.forEach((function(e){e.numSeq==M&&Object.keys(e).forEach((function(t){"numCycle"!=t&&"numSeq"!=t&&(n+=e[t])}))}));else{Object(m.a)(ye.equipements).sort((function(e,t){return 100*(e.numSeq-t.numSeq)+e.numCycle-t.numCycle}))[Object(m.a)(ye.equipements).length-1];ye.equipements.forEach((function(e){e.numSeq==M&&Object.keys(e).forEach((function(t){"numCycle"!=t&&"numSeq"!=t&&Object.values(e[t]).forEach((function(e){n+=ie.equipements["coutEq"+t]*e}))}))}))}return n},it=function(e,t){var n=Object(j.a)({},Ne);n[e]=t,ke(n)};Object(r.useEffect)((function(){Ee.interventions&&Ee.equipements&&b==h&&lt()}),[Ee,K]);var ot=function(e,t){var n;if(t)(r=Object(j.a)({},Ee))[e]=!0,Pe(r),(n=Object(j.a)({},ye))[e].push(Ne[e]),Se(n),W(null);else if(console.log("clic retour vue ",e),void 0!==(n=Object(j.a)({},ye))[e]){var r,a=Object(j.a)({},Ne);a[e]=n[e][n[e].length-1],console.log(a),ke(a),n[e].pop(),Se(n),(r=Object(j.a)({},Ee))[e]=!1,Pe(r)}},lt=function(){console.log("check nv tour"),Ee.interventions&&Ee.equipements&&b==h&&(Ie.current||(Ie.current=!0,null!=ne&&(console.log("save bdg fin"),y.saveBudgetsPompFin(ye,A,H).then((function(e){var t=q,n=E,r=M,a=ne.chronoTourTact.valeur;y.nouveauTour(dt,1,Je,Qe,tt,r,n,t,be.Decedes,be.Sauves,A,H,a).then((function(){console.log("nouveau tour"),Ie.current=!1}))})))))},pt=Object(r.useState)(null),bt=Object(u.a)(pt,2),dt=bt[0],ft=bt[1];Object(r.useEffect)((function(){if(null==dt&&null!==ne){var e=te()("https://www.back.leaders-extreme.fr");e.emit("connecti",JSON.stringify({session:A,equipe:H})),e.on("changementTour",(function(e){h==e.currentPomp&&E===e.currentCycle&&q===e.currentTour&&M===e.currentSequence||ct(A,H)})),e.on("startStopPartie",(function(e){i(e.start)})),ft(e)}}),[dt,ne]);var ht=Object(r.useState)(null),jt=Object(u.a)(ht,2),mt=jt[0],vt=jt[1];Object(r.useEffect)((function(){null==mt&&function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.getTexts("jeuInterInterface").then((function(e){vt(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[mt]);var Ot=function(e){if(null==mt)return e;try{return mt[e].contenu}catch(t){return e}};return console.log(s),Je.length>0&&null!=Ye&&null!==ne&&void 0!==ne&&null!=je&&void 0!=je&&null!==ie&&void 0!=ie&&s?Object(S.jsxs)("div",{style:{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",flex:1,width:"100%",height:"100%"},children:[Object(S.jsx)(ae,{numeroPompier:b,numEquipe:H,numSession:A,sequence:M,cycle:E,tour:q,pomp:h,configuration:ne,handleViewChange:function(e,t){null!=t&&Q(t)},vue:K,interventionsValidated:Ee.interventions,equipementsValidated:Ee.equipements,play:s,handleClicValidated:ot,chronoInit:G,validated:Ee}),"operations"==K?Object(S.jsx)(U,{nbColonnesGrille:Re,nbLignesGrille:Le,carte:Je,position:Ye,mursH:Qe,mursV:tt}):null,"interventions"==K&&null!=ye?Object(S.jsx)(Oe,{budget:Object(j.a)({},je.interventions),cycles:Object(m.a)(ye.interventions),handleBudgetChange:it,type:"interventions",currentCycle:E,currentSequence:M,budgetSim:Object(j.a)({},Ne.interventions),couts:ie,nbCycleParSeq:null!==ne?ne.nbCyclesParSequence.valeur:0,configuration:ne}):null,"equipements"==K&&null!=ye?Object(S.jsx)(Oe,{budget:Object(j.a)({},je.equipements),cycles:Object(m.a)(ye.equipements),handleBudgetChange:it,type:"equipements",currentCycle:E,currentSequence:M,budgetSim:Object(j.a)({},Ne.equipements),couts:ie,nbCycleParSeq:null!==ne?ne.nbCyclesParSequence.valeur:0,configuration:ne}):null,Object(S.jsx)(ce,{numeroPompier:b,tour:q,pomp:h,resultats:be,vue:K,couts:ie,budget:"interventions"===K?je.interventions:je.equipements,validated:Ee,handleClicValidated:ot,equipe:H}),Object(S.jsx)(ge,{handleDisconnect:n,configuration:ne})]}):Object(S.jsxs)("div",{style:{color:"gray",textAlign:"center",fontSize:20},children:[Object(S.jsx)($.a,{children:Ot("attenteLancement")}),Object(S.jsx)($.a,{children:Ot("infoLancement")})]})},ye=(n(127),n(266)),Se="https://www.back.leaders-extreme.fr",Ce={login:function(){var e=Object(g.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,fetch(Se+"/login",n);case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getNbEquipes:function(){var e=Object(g.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:t})},e.next=3,fetch(Se+"/getNbEquipes",n);case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getUsers:function(){var e=Object(g.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:t})},e.next=3,fetch(Se+"/getUsers",n);case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createUsers:function(){var e=Object(g.a)(O.a.mark((function e(t,n,r){var a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:t,nbEquipes:n,users:r})},e.next=3,fetch(Se+"/createUsers",a);case 3:return c=e.sent,e.next=6,c.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},qe=function(e){var t=e.handleLogin,n=e.userConnected,a=e.handleDisconnectApp,c=Object(o.g)(),s=Object(r.useState)(n),i=Object(u.a)(s,2),l=i[0],p=i[1],b=Object(r.useState)(null),d=Object(u.a)(b,2),f=d[0],h=d[1],j=function(){var e=Object(g.a)(O.a.mark((function e(n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,Ce.login(N);case 3:null!=(r=e.sent).id?(h(null),p(r)):(h("erreurConnexion"),t(null));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=Object(r.useState)(null),v=Object(u.a)(m,2),x=v[0],y=v[1];Object(r.useEffect)((function(){null==x&&function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.getTexts("jeuLogin").then((function(e){y(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[x]);Object(r.useEffect)((function(){null!=l&&("disconnected"!==Y.a.load("user")?(null!=Y.a.load("user")&&Y.a.remove("user"),Y.a.save("user",l,{path:"/",maxAge:5400}),t(l),l.role.includes("TACT")?c.push("/tact"):l.role.includes("INTER")?c.push("/inter"):l.role.includes("ADMIN")&&c.push("/admin")):(p(null),Y.a.remove("user",{path:"/"}),a()))}),[l]);var C=Object(r.useState)({identifiant:"",mdp:""}),q=Object(u.a)(C,2),N=q[0],w=q[1],F=function(e){h(null);var t={identifiant:N.identifiant,mdp:N.mdp};t[e.target.name]=e.target.value,w(t)};return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)("div",{className:"body-login",children:[Object(S.jsx)($.a,{variant:"h1",color:"primary",children:"Connexion"}),Object(S.jsxs)("div",{className:"login-image-container",children:[Object(S.jsx)("img",{src:"./assets/Login.png"}),Object(S.jsx)(ye.a,{orientation:"vertical",flexItem:!0}),Object(S.jsxs)("form",{method:"post",className:"login-form",children:[Object(S.jsx)(ve.a,{required:!0,label:"Identifiant",variant:"outlined",name:"identifiant",value:N.identifiant,onChange:F,className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}}}),Object(S.jsx)(ve.a,{required:!0,label:"Mot de passe",variant:"outlined",name:"mdp",value:N.mdp,onChange:F,type:"password",className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}},onKeyUp:function(e){e.ctrlKey||"Enter"!=e.key||j(e)}}),Object(S.jsx)($.a,{color:"primary",children:null!=x&&null!==f?function(e){if(null==x)return e;try{return x[e].contenu}catch(f){return e}}(f):""}),Object(S.jsxs)("div",{className:"login-buttons-container",children:[Object(S.jsx)(E.a,{variant:"contained",onClick:function(){return c.push("/")},className:"login-button retour",color:"default",disabled:!0,children:"Retour"}),Object(S.jsx)(E.a,{variant:"contained",onClick:j,className:"login-button connect",color:"primary",children:"Se connecter"})]})]})]})]})})},Ne=n(132),ke=function(e){Object(Ne.a)(e);var t=Object(o.g)(),n=function(){var e=Object(g.a)(O.a.mark((function e(n){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t.push("/login");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsx)("div",{className:"body-login",children:Object(S.jsx)(E.a,{variant:"contained",onClick:n,className:"login-button connect",color:"primary",children:"Lien de connexion"})})},we=n(134);var Fe=function(e){var t=e.component,n=Object(we.a)(e,["component"]),r=Y.a.load("user");return Object(S.jsx)(o.b,Object(j.a)(Object(j.a)({},n),{},{render:function(e){return void 0!==r?Object(S.jsx)(t,Object(j.a)({},e)):Object(S.jsx)(o.a,{to:{pathname:"/login"}})}}))},Ee=(n(204),function(){var e=Object(o.g)(),t=Y.a.load("user");null!==t&&void 0!==t&&"disconnected"!=t||e.push("/login"),null===t||void 0===t||void 0===t.role||t.role.includes("ADMIN")||(Y.a.save("user","disconnected",{path:"/",maxAge:5400}),e.push("/login"));var n=Object(r.useState)(null!==t&&void 0!==t?t.session:null),a=Object(u.a)(n,2),c=a[0],s=(a[1],Object(r.useState)(null)),i=Object(u.a)(s,2),l=i[0],p=i[1],b=Object(r.useState)(null),d=Object(u.a)(b,2),f=d[0],h=d[1],m=Object(r.useState)(!0),v=Object(u.a)(m,2),x=v[0],C=v[1],q=Object(r.useRef)(!1),N=Object(r.useState)(null),k=Object(u.a)(N,2),w=k[0],F=k[1];Object(r.useEffect)((function(){if(null==w&&null!==l){var e=te()("https://www.back.leaders-extreme.fr");e.on("startStopPartie",(function(e){C(!e.start)})),e.on("connect_error",(function(e){return console.log("error",e)})),e.on("connect_failed",(function(e){return console.log("failed",e)})),F(e)}}));var P=function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==l){e.next=6;break}return e.t0=p,e.next=4,y.getConfiguration(c);case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){I(c),h(l)}),[l]);var I=function(){var e=Object(g.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q.current||null==l){e.next=9;break}return q.current=!0,e.next=4,y.getPlayState(t,null);case 4:void 0!==(n=e.sent)?C(!JSON.parse(n.valeur)):console.log("error"),q.current=!1,e.next=9;break;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){P()}));var T=function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.startStopPartie(w,c,x);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(!0),y.disconnectUsers(w,c);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(e){var t=e.target.name,n=e.target.value;if(parseInt(n)>=0){var r=Object(j.a)({},f);r[t].valeur=parseInt(n),h(r)}},D=Object(r.useState)(null),z=Object(u.a)(D,2),A=z[0],L=z[1],B=function(){var e=Object(g.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ce.getNbEquipes(c);case 2:return t=e.sent.count,L(t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=Object(r.useState)(null),V=Object(u.a)(H,2),R=V[0],G=V[1];Object(r.useEffect)((function(){null==A&&(B(),W())}),[A]),Object(r.useEffect)((function(){B()}),[R]);var U=function(){var e=Object(g.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ce.getUsers(c);case 2:t=e.sent,console.log(t),G(t),Ce.createUsers(c,A,t).then((function(){M(),W(),C(!0)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=G,e.next=3,Ce.getUsers(c);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:M(),y.getGeneralStats(c).then((function(e){y.resetPartie(A,c,e,f.chronoTourInter.valeur).then((function(){C(!0)}))}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(S.jsxs)("div",{className:"body-admin",children:[Object(S.jsx)($.a,{variant:"h1",color:"primary",children:"Espace administrateur"}),Object(S.jsxs)("div",{className:"admin-buttons-container",children:[Object(S.jsx)(E.a,{variant:"contained",className:"admin-button",color:x?"default":"primary",onClick:T,children:x?"Lancer la partie":"Mettre la partie sur pause"}),Object(S.jsx)(ye.a,{}),Object(S.jsx)(E.a,{variant:"contained",className:"admin-button",color:"primary",onClick:M,children:"D\xe9connecter les utilisateurs et mettre sur pause"}),Object(S.jsx)(E.a,{variant:"contained",className:"admin-button",color:"primary",onClick:X,children:"D\xe9connecter les utilisateurs et Relancer la partie"}),Object(S.jsx)(ye.a,{}),null!==f&&void 0!==f&&null!==A?Object(S.jsxs)("form",{method:"post",className:"login-form",children:[Object(S.jsxs)("div",{className:"admin-buttons-config-container",children:[Object(S.jsx)(ve.a,{label:"Chrono Interm\xe9diaire (s)",type:"number",name:"chronoTourInter",value:f.chronoTourInter.valeur,onChange:function(e){return J(e)},className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}}}),Object(S.jsx)(ve.a,{type:"number",label:"Chrono Tactique (s)",name:"chronoTourTact",value:f.chronoTourTact.valeur,onChange:function(e){return J(e)},className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}}})]}),Object(S.jsxs)("div",{className:"admin-buttons-config-container",children:[Object(S.jsx)(ve.a,{label:"Nombre de s\xe9quences",type:"number",name:"nbSequences",value:f.nbSequences.valeur,onChange:function(e){return J(e)},className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}}}),Object(S.jsx)(ve.a,{type:"number",label:"Budget cycle interm\xe9diaire",name:"budgetDefaultInter",value:f.budgetDefaultInter.valeur,onChange:function(e){return J(e)},className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}}})]}),Object(S.jsxs)("div",{className:"admin-buttons-config-container",children:[Object(S.jsx)(ve.a,{type:"number",label:"Nombre de marqueurs max",name:"nbMarqueursMax",value:f.nbMarqueursMax.valeur,onChange:function(e){return J(e)},className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}}}),Object(S.jsx)(ve.a,{type:"number",label:"Nombre de victimes max",name:"nbVictimesMax",value:f.nbVictimesMax.valeur,onChange:function(e){return J(e)},className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}}}),Object(S.jsx)(ve.a,{type:"number",label:"Nombre d'habitants \xe0 sauver",name:"nbHabitantsASauver",value:f.nbHabitantsASauver.valeur,onChange:function(e){return J(e)},className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}}})]}),Object(S.jsx)(E.a,{variant:"contained",className:"admin-button",color:"primary",onClick:function(){console.log("d\xe9part"),C(!0),y.updateConfig(f,c).then((function(){M()}))},children:"Modifier les param\xe8tres"}),Object(S.jsx)(ye.a,{}),Object(S.jsx)(ye.a,{}),Object(S.jsxs)("div",{className:"admin-buttons-config-container",children:[Object(S.jsx)(ve.a,{type:"number",label:"Nombre d'\xe9quipes",name:"nbEquipes",value:A,onChange:function(e){parseInt(e.target.value)>=0&&L(parseInt(e.target.value))},className:"login-field",color:"primary",inputProps:{style:{fontSize:25}},InputLabelProps:{style:{fontSize:20}}}),Object(S.jsx)(E.a,{variant:"contained",disabled:null==R,className:"admin-button",color:"primary",onClick:U,children:"G\xe9n\xe9rer les identifiants"})]})]}):null,Object(S.jsx)("div",{children:null!==R?Object(S.jsx)(le.a,{component:se.a,children:Object(S.jsxs)(ue.a,{sx:{minWidth:700},"aria-label":"customized table",children:[Object(S.jsx)(pe.a,{children:Object(S.jsxs)(be.a,{children:[Object(S.jsx)(oe.a,{align:"center",children:"Equipe"}),Object(S.jsx)(oe.a,{align:"center",children:"Role"}),Object(S.jsx)(oe.a,{align:"center",children:"Identifiant"}),Object(S.jsx)(oe.a,{align:"center",children:"Mot de passe"})]})}),Object(S.jsx)(ie.a,{children:R.map((function(e){return Object(S.jsxs)(be.a,{children:[Object(S.jsx)(oe.a,{align:"center",children:e.equipe}),Object(S.jsx)(oe.a,{align:"center",children:e.role}),Object(S.jsx)(oe.a,{align:"center",children:e.identifiant}),Object(S.jsx)(oe.a,{align:"center",children:e.mdp})]},e.identifiant+" : "+e.equipe+" : "+e.role)}))})]})}):null})]})]})});function Pe(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),n=t[0],a=t[1];return Object(S.jsx)(h.a,{theme:f,children:Object(S.jsx)(i.a,{children:Object(S.jsxs)(o.d,{children:[Object(S.jsx)(Fe,{userConnected:n,path:"/tact",component:ne}),Object(S.jsx)(Fe,{userConnected:n,path:"/inter",component:xe}),Object(S.jsx)(Fe,{path:"/admin",userConnected:n,component:Ee}),Object(S.jsx)(o.b,{path:"/login",children:Object(S.jsx)(qe,{userConnected:n,handleLogin:function(e){a(e)},handleDisconnectApp:function(){a(null)}})}),Object(S.jsx)(o.b,{path:"/",children:Object(S.jsx)(ke,{})})]})})})}s.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(Pe,{})}),document.getElementById("root"))},60:function(e,t,n){},97:function(e,t,n){}},[[205,1,2]]]);
//# sourceMappingURL=main.64579968.chunk.js.map